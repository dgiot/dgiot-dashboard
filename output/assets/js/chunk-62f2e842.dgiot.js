/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2022-01-04 09:54:43
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62f2e842"],{5887:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devproduct"},[a("div",{staticClass:"prosecond"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("product.searchproductname")},model:{value:e.formInline.productname,callback:function(t){e.$set(e.formInline,"productname",t)},expression:"formInline.productname"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.searchProduct(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",{staticStyle:{float:"right","text-align":"right"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=e.projectid,expression:"projectid != ''"}],attrs:{type:"primary"},on:{click:e.addproduct}},[e._v(" "+e._s(e.$translateTitle("product.createproduct"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addgroup.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")])],1)],1),a("div",{staticClass:"protable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.groupData,"header-cell-style":{"text-align":"center"}}},[a("el-table-column",{attrs:{label:"ProductID",prop:"objectId"}}),a("el-table-column",{attrs:{label:e.$translateTitle("product.productname")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.productgrouping")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.devType))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.nodetype")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[1==i.nodeType?a("span",[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")]):e._e(),0==i.nodeType?a("span",[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")]):e._e(),2==i.nodeType?a("span",[e._v(" "+e._s(e.$translateTitle("product.grouping"))+" ")]):e._e()]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.classification")},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.category.name))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.addingtime"),prop:"row.createdAt","show-overflow-tooltip":"",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.utc2beijing(i.createdAt)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"420"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,r=t.$index;return[a("el-button",{attrs:{size:"mini",type:"primary",underline:!1},on:{click:function(t){return e.deviceToDetail(i)}}},[e._v(" "+e._s(e.$translateTitle("product.config"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.goKonva(i.objectId)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.konva"))+" ")]),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){return e.GoTodevices(i)}}},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")]),a("el-popover",{ref:"popover-"+r,staticStyle:{"margin-left":"10px"},attrs:{placement:"top"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.qdsczg"))+e._s(i.name)+e._s(e.$translateTitle("equipment.cpm"))+" ")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){i._self.$refs["popover-"+r].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.makeSure(i)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)]}}])})],1)],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.productCurrentChange,"size-change":e.productSizeChange}})],1)],1),a("div",{staticClass:"prodialog"},[a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,"close-on-click-modal":!1,title:e.$translateTitle("product.createproduct"),top:"5vh",visible:e.dialogFormVisible,width:"50%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"content"},[a("div",{staticClass:"contentone"},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(e._s(e.$translateTitle("product.productinformation")))]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.productgrouping"),prop:"devType"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.devType,callback:function(t){e.$set(e.form,"devType",t)},expression:"form.devType"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[a("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationtype"),rules:[{required:!0,message:"请选择所属应用",trigger:"blur"}]}},[a("el-select",{attrs:{disabled:""},on:{change:e.selectApp},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}},e._l(e.allApps,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title,value:e.title}})})),1)],1)],1)],1),a("div",{staticClass:"contenttwo",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(e._s(e.$translateTitle("product.nodetype")))]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.nodetype"),prop:"nodeType"}},[a("el-radio-group",{on:{change:e.changeNode},model:{value:e.form.nodeType,callback:function(t){e.$set(e.form,"nodeType",t)},expression:"form.nodeType"}},[a("el-radio",{attrs:{label:0}},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")]),a("el-radio",{attrs:{label:1}},[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")]),a("el-radio",{attrs:{label:2}},[e._v(" "+e._s(e.$translateTitle("product.grouping"))+" ")])],1)],1)],1)],1),a("div",{staticClass:"contentthird",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(" "+e._s(e.$translateTitle("product.networkinganddescription"))+" ")]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.networking")+"(共"+e.channel.length+"项)",prop:"netType"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("product.selectgateway")},model:{value:e.form.netType,callback:function(t){e.$set(e.form,"netType",t)},expression:"form.netType"}},e._l(e.channel,(function(e,t){return a("el-option",{key:t,attrs:{label:t+1+":"+e.label,title:"当前第"+(t+1)+"项",value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.productmodel")}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"el-icon-plus avatar-uploader-icon"}),a("form",{ref:"uploadform",staticStyle:{position:"absolute"},attrs:{enctype:"multipart/form-data",method:"POST"}},[a("input",{staticStyle:{position:"relative",top:"-100px","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),e.imageUrl?a("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:e.deleteImgsrc}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]):e._e()],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1),a("div",{staticClass:"add-group"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("developer.newvirtualgroup"),visible:e.groupform,width:"30%"},on:{"update:visible":function(t){e.groupform=t}}},[a("el-form",{ref:"addGroup",staticClass:"demo-ruleForm",attrs:{"label-width":"80px",model:e.addGroup}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.groupname"),prop:"name",rules:[{required:!0,message:e.$translateTitle("developer.cannotbeempty")}]}})],1),a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{autocomplete:"off",type:"text"},model:{value:e.addGroup.name,callback:function(t){e.$set(e.addGroup,"name",t)},expression:"addGroup.name"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addDeviceGroup()}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-button",{on:{click:function(t){return e.resetForm()}}},[e._v(" "+e._s(e.$translateTitle("zetadevices.reset"))+" ")])],1)],1)],1),a("div",{staticClass:"import-dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.importpro"),visible:e.importDialogShow,width:"25%"},on:{"update:visible":function(t){e.importDialogShow=t}}},[a("el-form",{ref:"uploadProForm",attrs:{model:e.formPro}},[a("el-upload",{ref:"fileUpload",staticClass:"upload-demo",attrs:{accept:".xls, .xlsx, .zip",action:e.uploadAction,"auto-upload":!1,data:e.uploadData,"file-list":e.fileList,headers:e.uploadHeaders,"on-change":e.handleChange,"on-error":e.handleUploadError,"on-success":e.handleUploadSuccess,"with-credentials":!0}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfiles"))+" ")])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-left",attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v(" "+e._s(e.$translateTitle("application.upload"))+" ")]),a("el-button",{staticClass:"btn-right",attrs:{size:"small"},on:{click:function(t){e.importDialogShow=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1)],1)])},r=[],o=a("fb07"),n=a("d0d7"),l=a.n(n),s=(a("16b8"),a("04d6"),a("a0e0"),a("3dec"),a("1d17"),a("4c87"),a("b463"),a("a44e"),a("4ccb"),a("3559"),a("d06e"),a("b340"),a("6924"),a("472c"),a("256c"),a("de71"),a("7876"),a("37a7"),a("d2d8"),a("e2e1"),a("2c1e"),a("26c7"),a("ee7e"),a("f05b"),a("6a4d"),a("11de"),a("172c"),a("0c75"),a("69a3"),a("d30f"),a("3b7f"),a("aadd"),a("98da"),a("c4bc"),a("f1e1"),a("7212")),c=a("5da9"),d=a("1285"),u=a("7497"),p=a("e0e9"),m=a("d0fd"),f=a("be65"),v=a.n(f),g=a("5638"),b={data:function(){return{category:[],hashkey:"",addGroup:{name:""},groupform:!1,length:10,total:0,start:0,activeName:"first",formInline:{productname:""},uploadHeaders:{sessionToken:v.a.get("access_token")},uploadAction:"",uploadData:{},fileList:[],productIdentifier:"",groupData:[],formLabelWidth:"80px",dialogFormVisible:!1,importDialogShow:!1,form:{name:"",category:[],nodeType:0,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},formPro:{name:"",url:""},rules:{roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入产品",trigger:"blur"}],devType:[{required:!0,message:"请输入产品标识，用于区分不同设备",trigger:"blur"}],category:[{required:!0,message:"请选择所属分类",trigger:"change"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],netType:[{required:!0,message:"请选择联网方式",trigger:"change"}],relationApp:[{required:!0,message:"请选择产品可见角色",trigger:"change"}]},option:[],ruleoptions:[],channel:[{label:"蜂窝(2G/3G/4G)(直连)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道(直连)",value:"5G"},{label:"WIFI通道(直连)",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"Modbus",value:"Modbus"},{label:"LoRa(WAN)(直连)",value:"LoRaWAN"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接(直连)",value:"网线连接"},{label:"自定义",value:"OTHER"}],imageUrl:"",productid:"",loading:!1,allApps:[],categoryList:[],categoryListOptions:[],fileServer:"",access_token:"",projectid:"",projectName:"",allTableDate:[]}},computed:{},mounted:function(){this.Industry(),this.searchProduct(0)},beforeDestroy:function(){this.projectName=""},methods:{addDeviceGroup:function(){var e=this;this.$refs["addGroup"].validate((function(t){if(!t)return!1;Object(g["addGroup"])(e.addGroup.name).then((function(t){e.$message({message:"新建设备分组成功",type:"success"}),e.searchProduct(),e.groupform=!1})).catch((function(t){e.$message({message:"新建设备分组失败"+t.computed,type:"error"}),e.groupform=!1}))}))},resetForm:function(){this.$refs["addGroup"].resetFields()},changeNode:function(e,t){0!=t&&(this.form.netType=""),this.channel=0==e?[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"LoRa(WAN)",value:"LoRaWAN"},{label:"Modbus",value:"Modbus"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]:[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"LoRaWAN",value:"LoRaWAN"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]},selectApp:function(e){var t=this;e&&Object(c["getRole"])(e).then((function(e){e&&(t.fileServer=e.file,t.access_token=e.access_token)}))},treeData:function(e){var t=JSON.parse(JSON.stringify(e));return t.filter((function(e){var a=t.filter((function(t){return e.id==t.parentid}));return a.length>0&&(e.children=a),0==e.parentid}))},deleteImgsrc:function(){event.stopPropagation(),this.imageUrl=""},upload:function(e){if(this.loading=!0,e){var t=e.target.files[0],a=t.name,i=e.target.files[0].type,r=(t.type.split("/")[0],"image/jpeg"===i||"image/JPEG"===i||"image/png"===i||"image/PNG"===i||"image/bpm"===i||"image/BPM"===i);if(!r)return this.$message({message:"请上传图片",type:"error"}),!1;var o=new FileReader;o.readAsDataURL(t);var n=this;o.onloadend=function(){var e=o.result,t=n.dataURItoBlob(e);n.uploadFile(t,a)}}},dataURItoBlob:function(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([i],{type:a})},uploadFile:function(e,t){var a=this,i=new FormData;i.append("file",e,t),i.append("output","json"),i.append("path",this.form.relationApp),i.append("auth_token",this.access_token);this.$http.post(this.fileServer,i).then((function(e){e&&(a.imageUrl=e.body.url,a.loading=!1)})).catch((function(e){a.loading=!1,a.$message(e.bodyText)}))},submitUpload:function(){var e=this;this.uploadAction="/product",this.$nextTick((function(){e.uploadData.appid=v.a.get("appids"),e.$refs.fileUpload.submit()}))},handleUploadSuccess:function(e,t,a){this.$message({type:"success",message:"产品导入成功"}),this.importDialogShow=!1,this.$refs["uploadProForm"].resetFields(),this.searchProduct()},handleUploadError:function(e,t,a){this.$message({showClose:!0,message:e})},handleChange:function(e,t){t.length>0&&(this.fileList=[t[t.length-1]])},utc2beijing:function(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getDict:function(e,t){return Object(o["a"])(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={limit:1e3,where:{"data.key":"category"}},e.next=3,Object(p["queryDict"])(t);case 3:a=e.sent,a.results;case 5:case"end":return e.stop()}}),e)})))()},searchProduct:function(e){var t=this;return Object(o["a"])(l.a.mark((function a(){var i,r,o,n;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return 0==e&&(t.start=0),i={order:"-updatedAt",skip:t.start,limit:t.length,include:"category",where:{nodeType:"2",name:t.formInline.productname.length?{$regex:t.formInline.productname}:{$ne:null}}},a.next=4,Object(s["queryProduct"])(i);case 4:return r=a.sent,o=r.results,t.groupData=o,t.total=t.groupData.length,a.next=10,Object(c["queryRole"])({limit:100});case 10:n=a.sent,t.allApps=n.results;case 12:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.dialogFormVisible=!1},addproduct:function(){this.dialogFormVisible=!0},addgroup:function(){this.groupform=!0},getParent:function(e,t,a){var i=this;return t.map((function(r){e==r.id?(a.unshift(r.value),i.getParent(r.parentid,t,a)):0==r.parentid&&r.id==e&&a.unshift(r.value)})),this.form.category=a,a},getIndustryParent:function(e,t){var a=this;t.map((function(i){i.value==e&&a.getParent(i.id,t,[])}))},editorProduct:function(e){for(var t in this.form.relationApp="",this.dialogFormVisible=!0,this.productid=e.id,this.getIndustryParent(e.attributes.category,this.categoryList),this.form.desc=e.attributes.desc,this.form.name=e.attributes.name,this.form.nodeType=e.attributes.nodeType,this.form.netType=e.attributes.netType,this.form.devType=e.attributes.devType,this.form.productSecret=e.attributes.productSecret,this.changeNode(e.attributes.nodeType,0),e.attributes.icon&&(this.imageUrl=e.attributes.icon),e.attributes.ACL.permissionsById)this.form.relationApp=t?t.substr(5):"";this.selectApp(this.form.relationApp)},Industry:function(){var e=this;return Object(o["a"])(l.a.mark((function t(){var a,i,r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.categoryList=[],a={limit:1e3,where:{"data.key":"category"}},t.next=4,Object(p["queryDict"])(a);case 4:i=t.sent,r=i.results,r.map((function(t){var a={};a.value=t.type,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.categoryList.push(a)})),e.categoryListOptions=e.treeData(e.categoryList);case 8:case"end":return t.stop()}}),t)})))()},submitForm:function(e){},resetProductForm:function(){this.form={name:"",category:[],nodeType:0,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},this.imageUrl=""},deviceToDetail:function(e){this.$router.push({path:"/roles/detailproduct",query:{id:e.objectId}})},goKonva:function(e){this.$router.push({path:"/Topo?productid",query:{productid:e}})},GoTodevices:function(e){this.$router.push({path:"/roles/thing",query:{productid:e.objectId}})},makeSure:function(e){var t=this,a={count:"objectId",skip:0,limit:1,where:{product:e.objectId}};Object(d["queryDevice"])(a).then((function(a){a.count>0?t.$message("请先删除该产品下设备"):Object(s["getProduct"])(e.objectId).then((function(a){Object(s["delProduct"])(e.objectId).then((function(a){a&&(t.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat($index)].doClose(),t.searchProduct())})).catch((function(e){dgiotlog.log("delProduct ",e.error)}))})).catch((function(e){dgiotlog.log("getProduct ",e.error)}))})).catch((function(e){dgiotlog.log("queryDevice ",e.error)}))},productSizeChange:function(e){this.length=e,this.searchProduct()},productCurrentChange:function(e){this.start=(e-1)*this.length,this.searchProduct()},blackDict:function(e,t){var a=this;return Object(o["a"])(l.a.mark((function i(){var r,o;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return r={data:t,key:e,type:"Product"},i.next=3,Object(p["postDict"])(r);case 3:o=i.sent,o?a.$message({type:"success",message:"备份成功"}):a.$message({type:"error",message:"备份失败"});case 5:case"end":return i.stop()}}),i)})))()},CloneData:function(e){var t=this;return Object(o["a"])(l.a.mark((function a(){var i,r,o,n;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={category:e.attributes.category,devType:e.attributes.devType,name:e.attributes.name,thing:e.attributes.thing},a.next=3,Object(u["getHashClass"])("Product",i);case 3:r=a.sent,o=r.objectId,n=r.code,200==n&&t.blackDict(o,i);case 7:case"end":return a.stop()}}),a)})))()},proudctClone:function(e){var t=this;return Object(o["a"])(l.a.mark((function a(){var i,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.attributes.config.cloneState=!0,i=e,r=Object(s["putProduct"])(e.id,i),r&&t.CloneData(e);case 4:case"end":return a.stop()}}),a)})))()},proudctEdit:function(e){var t=window.location.origin+"/spa",a="production";t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i="".concat(t,"/#?drawProudctid=").concat(e.objectId,"&proudctid=").concat(e.objectId);localStorage.setItem("rowId",e.objectId),window.open(i,"__blank")},proudctView:function(e){var t=window.location.origin+"/spa",a="production";t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i="".concat(t,"/#/views/").concat(e.objectId);window.open(i,"__blank")},exportpro:function(){this.allTableDate?Object(m["export_txt_to_zip"])(JSON.stringify(this.allTableDate),"Dict","Dict"):this.$message({type:"warning",message:"数据为空,无法导出"})}}},h=b,y=(a("9763"),a("a73e"),a("bdd7")),w=Object(y["a"])(h,i,r,!1,null,"0c26d424",null);t["default"]=w.exports},"655c":function(e,t,a){},9763:function(e,t,a){"use strict";a("cce6")},a5cd:function(e,t,a){"use strict";a("655c")},a73e:function(e,t,a){"use strict";a("dfab")},a858:function(e,t,a){"use strict";a.r(t);var i,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"equipment equipment-container"},[a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,top:"5vh",visible:e.popoverVisible,width:"40vh"},on:{"update:visible":function(t){e.popoverVisible=t}}},[a("div",{staticClass:"deviceTree"},[a("p",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(e.$translateTitle("developer.Company"))+" : "+e._s(e.deciceCompany)+" ")]),a("el-tree",{attrs:{data:e.roleTree,"default-expand-all":"","expand-on-click-node":!1,"node-key":"index",props:e.roleProps},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",{class:{selected:r.objectId==e.curDepartmentId},on:{click:function(t){return e.transferAcl(r)}}},[e._v(" "+e._s(i.label)+" ")])])}}])})],1)]),a("el-dialog",{attrs:{"append-to-body":!0,top:"5vh",visible:e.mapDialog,width:"80vh"},on:{"update:visible":function(t){e.mapDialog=t}}},[a("baidu-map",{staticStyle:{height:"80vh"},attrs:{ak:e.secret.baidu.map,center:e.center,"map-click":!1,"scroll-wheel-zoom":!0,zoom:e.zoom},on:{click:e.mapClick,ready:e.handler}},[a("bm-marker",{attrs:{animation:"BMAP_ANIMATION_BOUNCE",dragging:!0,position:e.center}},[a("bm-label",{attrs:{content:e.deviceId,"label-style":{color:"red",fontSize:"12px"},offset:{width:-25,height:30}}})],1),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}})],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.devicedetail.name,top:"5vh",visible:e.InfoDialog,width:"80%"},on:{"update:visible":function(t){e.InfoDialog=t}}},[a("el-tabs",{attrs:{size:"mini",type:"border-card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeparseTbas,callback:function(t){e.activeparseTbas=t},expression:"activeparseTbas"}},e._l(e.parseTbas,(function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.name,name:t.name}},[a("ele-form",e._b({attrs:{"request-fn":e.handleSubmit},on:{"request-success":function(a){return e.handleSuccess(t)}},model:{value:t.config,callback:function(a){e.$set(t,"config",a)},expression:"item.config"}},"ele-form",t.config,!1))],1)})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.InfoDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.InfoDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.CloseState,title:e.stateDialog.name,top:"5vh",visible:e.stateDialog,width:"80%"},on:{"update:visible":function(t){e.stateDialog=t}}},[a("deviceState",{attrs:{devicedetail:e.stateDetail},on:{ParserSave:e.ParserSave}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.stateDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.stateDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1),a("div",{staticClass:"equtabs"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("div",{staticClass:"equdevices"},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"100px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.Products")}},[a("el-select",{attrs:{clearable:"",disabled:!e.productenable},on:{change:e.selectProdChange},model:{value:e.equvalue,callback:function(t){e.equvalue=t},expression:"equvalue"}},e._l(e.proTableData,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("equipment.device status")}},[a("el-select",{staticStyle:{width:"100px"},attrs:{clearable:""},model:{value:e.onlinedevices,callback:function(t){e.onlinedevices=t},expression:"onlinedevices"}},[a("el-option",{attrs:{value:e.$translateTitle("zetadevices.online")}}),a("el-option",{attrs:{value:e.$translateTitle("zetadevices.offline")}})],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("equipment.condition")}},[e.selectdevice==e.$translateTitle("equipment.devicename")?a("el-input",{attrs:{placeholder:e.$translateTitle("equipment.enterproductname")},model:{value:e.deviceinput,callback:function(t){e.deviceinput=t},expression:"deviceinput"}},[a("el-select",{staticStyle:{width:"140px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.selectdevice,callback:function(t){e.selectdevice=t},expression:"selectdevice"}},[a("el-option",{attrs:{value:e.$translateTitle("equipment.devicename")}}),a("el-option",{attrs:{value:e.$translateTitle("equipment.devicenumber")}})],1),a("i",{staticClass:"el-icon-search",staticStyle:{"line-height":"32px",color:"#606266",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function(t){return e.getDevices({start:0})}},slot:"suffix"})],1):a("el-input",{attrs:{placeholder:e.$translateTitle("equipment.enterdevicenumber")},model:{value:e.deviceinput,callback:function(t){e.deviceinput=t},expression:"deviceinput"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.selectdevice,callback:function(t){e.selectdevice=t},expression:"selectdevice"}},[a("el-option",{attrs:{value:e.$translateTitle("equipment.devicename")}}),a("el-option",{attrs:{value:e.$translateTitle("equipment.devicenumber")}})],1),a("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.getDevices({start:0})}},slot:"append"})],1)],1),a("el-form-item",[a("el-button",{staticClass:"el-icon-plus",attrs:{size:"small",title:e.$translateTitle("equipment.adddevice"),type:"primary"},on:{click:e.addDeviceForm}}),a("el-button",{staticClass:"el-icon-delete",attrs:{disabled:!e.selectedList.length,size:"small",title:e.$translateTitle("aintenance.batch deletion"),type:"danger"},on:{click:function(t){return e.handleDelete(e.selectedList,1)}}})],1),a("el-form-item",{staticStyle:{display:"none"}},[a("el-button",{staticClass:"selectdetail",attrs:{disabled:0==e.multipleTable.length,size:"small",type:"primary"},on:{click:e.deleteDevcie}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),a("el-button",{staticClass:"selectdetail",attrs:{disabled:0==e.multipleTable.length,size:"small",type:"primary"},on:{click:function(t){return e.unactiveDevice(!1)}}},[e._v(" "+e._s(e.$translateTitle("developer.prohibit"))+" ")]),a("el-button",{staticClass:"selectdetail",attrs:{disabled:0==e.multipleTable.length,size:"small",type:"primary"},on:{click:function(t){return e.unactiveDevice(!0)}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]),a("el-button",{attrs:{size:"small"}},[e._v(" "+e._s(e.$translateTitle("equipment.batchaddition"))+" ")])],1)],1)],1)],1)],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.list"),name:"first"}},[a("div",{staticClass:"tabstable"},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.isALL,expression:"isALL"},{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"filterTable",staticClass:"tab_wrap_1",staticStyle:{"margin-top":"20px","text-align":"center"},attrs:{border:e.border,data:e.tableData,"row-style":e.rowClass,size:e.lineHeight,stripe:e.stripe},on:{"selection-change":e.changeBox}},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",sortable:"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.devicenumber"),prop:"devaddr","show-overflow-tooltip":"",sortable:"",width:"100"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.name"),prop:"name","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.state"),prop:"status","show-overflow-tooltip":"",sortable:"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["ONLINE"==i.status?a("span",{class:i.status},[e._v(" "+e._s(e.$translateTitle("product.online"))+" ")]):e._e(),"ONLINE"==i.status?a("el-tooltip",{attrs:{content:e.$translateTitle("equipment.thedeviceisonline"),placement:"top"}},[a("i",{staticClass:"el-icon-question"})]):e._e(),"OFFLINE"==i.status?a("span",{class:i.status},[e._v(" "+e._s(e.$translateTitle("product.offline"))+" ")]):e._e(),"OFFLINE"==i.status?a("el-tooltip",{attrs:{content:e.$translateTitle("equipment.thedeviceisoffline"),placement:"top"}},[a("i",{staticClass:"el-icon-question"})]):e._e(),"OFFLINE"!=i.status&&"ONLINE"!=i.status?a("span",{class:i.status},[e._v(" "+e._s(e.$translateTitle("product.unregistered"))+" ")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.product"),prop:"product.name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.Company"),prop:"Company","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.enable")+"/"+e.$translateTitle("developer.prohibit"),prop:"isEnable","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,r=t.$index;return[a("el-switch",{attrs:{"active-color":"#5eb058","inactive-color":"#cccccc"},on:{change:function(t){return e.handelUpdate(t,i,r)}},model:{value:i.isEnable,callback:function(t){e.$set(i,"isEnable",t)},expression:"row.isEnable"}})]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.createdAt"),prop:"createdAt","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.utc2beijing(i.createdAt)))])]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),"min-width":"220",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.deviceToDetail(i)}}},[e._v(" "+e._s(e.$translateTitle("product.details"))+" ")]),a("el-button",{staticStyle:{"text-align":"center"},attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.showInfo(i)}}},[e._v(" "+e._s(e.$translateTitle("product.parser"))+" ")]),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){return e.konvaDevice(i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.konva"))+" ")]),a("el-dropdown",{staticStyle:{margin:"0 10px"}},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){e.isFullscreen=!e.isFullscreen}}},[e._v(" "+e._s(e.$translateTitle("concentrator.more"))+" ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-link",{attrs:{size:"info",type:"success"},on:{click:function(t){return e.editorDevice(i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")])],1),a("el-dropdown-item",[a("el-link",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showTree(i.objectId,i.Company)}}},[e._v(" "+e._s(e.$translateTitle("equipment.move"))+" ")])],1),a("el-dropdown-item",[a("el-link",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.goLink("video",i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.video"))+" ")])],1),a("el-dropdown-item",[a("el-link",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(i,2)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)],1)],1)]}}])})],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:!e.isALL,expression:"!isALL"},{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"filterTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-style":e.rowClass},on:{"selection-change":e.changeBox}},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",sortable:"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.devicenumber"),prop:"devaddr","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.name"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.state"),"show-overflow-tooltip":"",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["ONLINE"==i.status?a("span",{class:i.status},[e._v(" "+e._s(e.$translateTitle("product.online"))+" ")]):e._e(),"ONLINE"==i.status?a("el-tooltip",{attrs:{content:e.$translateTitle("equipment.thedeviceisonline"),placement:"top"}},[a("i",{staticClass:"el-icon-question"})]):e._e(),"OFFLINE"==i.status?a("span",{class:i.status},[e._v(" "+e._s(e.$translateTitle("product.offline"))+" ")]):e._e(),"OFFLINE"==i.status?a("el-tooltip",{attrs:{content:e.$translateTitle("equipment.thedeviceisoffline"),placement:"top"}},[a("i",{staticClass:"el-icon-question"})]):e._e(),"OFFLINE"!=i.status&&"ONLINE"!=i.status?a("span",{class:i.status},[e._v(" "+e._s(e.$translateTitle("product.unregistered"))+" ")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.product"),"show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.product&&i.product.name?a("span",[e._v(" "+e._s(i.product.name)+" ")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.Company"),"show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(" "+e._s(i.Company)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.enable")+"/"+e.$translateTitle("developer.prohibit"),"show-overflow-tooltip":"",sortable:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,r=t.$index;return[a("el-switch",{attrs:{"active-color":"#5eb058","inactive-color":"#cccccc"},on:{change:function(t){return e.handelUpdate(t,i,r)}},model:{value:i.isEnable,callback:function(t){e.$set(i,"isEnable",t)},expression:"row.isEnable"}})]}}])}),e._l(e.dialogtempconfig,(function(t,i){return["bool"==t.type&&t.isshow?a("el-table-column",{key:i,attrs:{align:"center",label:t.name,prop:t.identifier},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.row;return[r[t.default]?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])]}}],null,!0)}):"enum"==t.type&&t.isshow?a("el-table-column",{key:i,attrs:{align:"center",label:t.name},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.row;return[a("span",[e._v(" "+e._s(t.struct[r[t.identifier]])+" ")])]}}],null,!0)}):t.isshow?a("el-table-column",{key:i,attrs:{align:"center",label:t.name,prop:t.identifier},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.row;return[a("span",[e._v(e._s(r[t.identifier])+" "+e._s(t.unit))])]}}],null,!0)}):e._e()]})),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.createdAt"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(e.utc2beijing(i.createdAt)))])]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.deviceToDetail(i)}}},[e._v(" "+e._s(e.$translateTitle("product.details"))+" ")]),a("el-button",{staticStyle:{"text-align":"center"},attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.showInfo(i)}}},[e._v(" "+e._s(e.$translateTitle("product.parser"))+" ")]),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){return e.konvaDevice(i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.konva"))+" ")]),a("el-dropdown",{staticStyle:{margin:"0 10px"}},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){e.isFullscreen=!e.isFullscreen}}},[e._v(" "+e._s(e.$translateTitle("concentrator.more"))+" ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-link",{attrs:{size:"info",type:"success"},on:{click:function(t){return e.editorDevice(i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")])],1),a("el-dropdown-item",[a("el-link",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showTree(i.objectId,i.Company)}}},[e._v(" "+e._s(e.$translateTitle("equipment.move"))+" ")])],1),a("el-dropdown-item",[a("el-link",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.goLink("video",i)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.video"))+" ")])],1),a("el-dropdown-item",[a("el-link",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(i,2)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)],1)],1)]}}])})],2),a("div",{staticClass:"elpagination"},[a("vab-parser-pagination",{key:e.devicetotal.length+"forensics",ref:"devicePagination",attrs:{pagination:e.paginations,"query-payload":e.queryPayload},on:{pagination:e.getDevices,paginationQuery:e.paginationQuery}})],1)],1)]),a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.map"),name:"second"}},[a("baidu-map",{staticClass:"map",staticStyle:{height:"67vh"},attrs:{ak:e.secret.baidu.map,center:{lng:116.404,lat:39.915},"scroll-wheel-zoom":!0,zoom:e.sizeZoom}},[a("bm-control",[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=19}}},[e._v(" 缩放至最大 ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=10}}},[e._v("还原")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sizeZoom=3}}},[e._v(" 缩放至最小 ")]),a("bm-panorama",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT",offset:{width:460,height:0}}}),a("bm-overview-map",{attrs:{"is-open":!0}}),a("bm-scale",{attrs:{offset:{width:200,height:0}}}),a("bm-city-list",{attrs:{offset:{width:280,height:0}}}),a("bm-map-type",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT","map-types":["BMAP_HYBRID_MAP","BMAP_NORMAL_MAP"],offset:{width:360,height:0}}})],1),e._l(e.tableData,(function(t){return a("bm-marker",{key:t.objectId,attrs:{animation:"BMAP_ANIMATION_BOUNCE",content:t.name,dragging:!0,position:{lng:t.location.longitude,lat:t.location.latitude}}},[a("bm-label",{attrs:{content:t.name,"label-style":{color:"red",fontSize:"24px"},offset:{width:-35,height:30}},on:{click:function(a){return e.deviceToDetail(t)}}})],1)})),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),a("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0}})],2)],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,"close-on-click-modal":!1,title:e.$translateTitle("product.edit")+e.equipmentEditor,visible:e.devicedialogVisible,width:"70%"},on:{"update:visible":function(t){e.devicedialogVisible=t}}},[a("div",{staticClass:"header-title",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"title-name"},[e._v(" "+e._s("设备"+e.equipmentEditor)+" "),a("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{content:e.$translateTitle("equipment.text"),placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("div",{staticClass:"devicecontent"},[a("el-tabs",{model:{value:e.imeideviceName,callback:function(t){e.imeideviceName=t},expression:"imeideviceName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.commdevice"),name:"first"}},[a("el-form",{ref:"deviceform",attrs:{"label-width":"150px",model:e.deviceform,rules:e.rules}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.devicename"),prop:"name"}},[a("el-input",{model:{value:e.deviceform.name,callback:function(t){e.$set(e.deviceform,"name",t)},expression:"deviceform.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.devicenumber"),prop:"devaddr"}},[a("el-input",{attrs:{disabled:"编辑"==e.equipmentEditor},model:{value:e.deviceform.devaddr,callback:function(t){e.$set(e.deviceform,"devaddr",t)},expression:"deviceform.devaddr"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"productName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"编辑"==e.equipmentEditor,placeholder:e.$translateTitle("equipment.entername")},on:{change:e.selectChange},model:{value:e.deviceform.productName,callback:function(t){e.$set(e.deviceform,"productName",t)},expression:"deviceform.productName"}},e._l(e.proTableData1,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.assetnumber")}},[a("el-input",{model:{value:e.deviceform.assetNum,callback:function(t){e.$set(e.deviceform,"assetNum",t)},expression:"deviceform.assetNum"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.equipmenttype")}},[a("el-input",{model:{value:e.deviceform.devModel,callback:function(t){e.$set(e.deviceform,"devModel",t)},expression:"deviceform.devModel"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.equipmentbrand")}},[a("el-input",{model:{value:e.deviceform.brand,callback:function(t){e.$set(e.deviceform,"brand",t)},expression:"deviceform.brand"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.installationlocation")}},[a("el-input",{on:{focus:e.updateLocation},model:{value:e.deviceform.address,callback:function(t){e.$set(e.deviceform,"address",t)},expression:"deviceform.address"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.videoSrc")}},[a("el-input",{model:{value:e.deviceform.videoSrc,callback:function(t){e.$set(e.deviceform,"videoSrc",t)},expression:"deviceform.videoSrc"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.videoType")}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.deviceform.videoType,callback:function(t){e.$set(e.deviceform,"videoType",t)},expression:"deviceform.videoType"}},e._l(e.videoOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),e._l(e.arrlist,(function(t,i){return a("el-col",{key:i,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.name,prop:t.identifier,required:t.required}},["bool"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"100%"},attrs:{disabled:t.readonly},model:{value:e.deviceform[t.identifier],callback:function(a){e.$set(e.deviceform,t.identifier,a)},expression:"deviceform[item.identifier]"}},[a("el-option",{attrs:{label:e.$translateTitle("product.yes"),value:!0}}),a("el-option",{attrs:{label:e.$translateTitle("product.no"),value:!1}})],1):"enum"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"100%"},attrs:{disabled:t.readonly},model:{value:e.deviceform[t.identifier],callback:function(a){e.$set(e.deviceform,t.identifier,a)},expression:"deviceform[item.identifier]"}},e._l(t.specs,(function(e,t){return a("el-option",{key:t,attrs:{label:e.attributevalue,value:e.attribute?e.attribute:""}})})),1):"switch"==t.type?a("el-switch",{attrs:{"active-color":"#13ce66","active-value":t.activevalue,"inactive-color":"#ff4949","inactive-value":t.inactivevalue},model:{value:e.deviceform[t.identifier],callback:function(a){e.$set(e.deviceform,t.identifier,a)},expression:"deviceform[item.identifier]"}}):t.readonly?a("el-input",{attrs:{disabled:t.readonly,value:e.deviceform[t.identifier]?e.deviceform[t.identifier]:""}},[a("el-button",{attrs:{slot:"append"},slot:"append"},[e._v(" "+e._s(t.unit?t.unit:"")+" ")])],1):a("el-input",{attrs:{disabled:t.readonly},model:{value:e.deviceform[t.identifier],callback:function(a){e.$set(e.deviceform,t.identifier,a)},expression:"deviceform[item.identifier]"}},[a("el-button",{attrs:{slot:"append"},slot:"append"},[e._v(" "+e._s(t.unit?t.unit:"")+" ")])],1)],1)],1)})),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{autosize:{minRows:4,maxRows:4},type:"textarea"},model:{value:e.deviceform.desc,callback:function(t){e.$set(e.deviceform,"desc",t)},expression:"deviceform.desc"}})],1)],1)],2)],1),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("deviceform")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1),"编辑"!=e.equipmentEditor?a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.imeidevice"),name:"second"}},[a("el-form",{ref:"imeiform",attrs:{"label-width":"150px",model:e.imeiform,rules:e.rules}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"IMEI",prop:"devimei"}},[a("el-input",{model:{value:e.imeiform.devimei,callback:function(t){e.$set(e.imeiform,"devimei",t)},expression:"imeiform.devimei"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"productName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("equipment.entername")},on:{change:e.selectChange},model:{value:e.imeiform.productName,callback:function(t){e.$set(e.imeiform,"productName",t)},expression:"imeiform.productName"}},e._l(e.proTableData1,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.installationlocation")}},[a("el-input",{on:{focus:e.updateLocation},model:{value:e.imeiform.address,callback:function(t){e.$set(e.imeiform,"address",t)},expression:"imeiform.address"}})],1)],1)],1)],1),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitimeiForm("imeiform")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1):e._e()],1)],1)]),a("el-dialog",{directives:[{name:"drag-dialog",rawName:"v-drag-dialog"}],attrs:{"append-to-body":!0,"before-close":e.handleClosebmap,"close-on-click-modal":!1,title:e.$translateTitle("developer.equipmentinstallationaddress"),visible:e.bmapdialogVisible,width:"50%"},on:{"update:visible":function(t){e.bmapdialogVisible=t}}},[a("div",[a("el-form",{attrs:{inline:!0,model:e.bmapform,size:"small"}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.addressname")}},[a("el-input",{model:{value:e.bmapform.keyword,callback:function(t){e.$set(e.bmapform,"keyword",t)},expression:"bmapform.keyword"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.selectaddress")}},[a("el-input",{attrs:{readonly:""},model:{value:e.bmapform.address,callback:function(t){e.$set(e.bmapform,"address",t)},expression:"bmapform.address"}})],1)],1),a("baidu-map",{staticStyle:{height:"300px"},attrs:{ak:e.secret.baidu.map,center:e.center,"map-click":!1,"scroll-wheel-zoom":!0,zoom:e.zoom},on:{click:e.mapClick,ready:e.handler}},[a("bm-local-search",{staticStyle:{display:"none"},attrs:{"auto-viewport":!0,keyword:e.bmapform.keyword,location:e.bmapform.location,zoom:"12.8"}}),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),a("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","auto-location":!0,"show-address-bar":!0}}),a("bm-city-list",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addressSure.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")]),a("el-button",{on:{click:function(t){e.bmapdialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1)])},o=[],n=a("71bc"),l=a("4490"),s=a("fb07"),c=a("e97b"),d=a("d0d7"),u=a.n(d),p=(a("1d17"),a("37c6"),a("3dec"),a("9c6a"),a("f1e1"),a("04d6"),a("a0e0"),a("16b8"),a("d6a4"),a("c4bc"),a("f764"),a("5662"),a("df0e"),a("5ac5"),a("98da"),a("3de5"),a("2db0")),m=a("5880"),f=(a("ce31"),a("dcc6")),v=a("adc7"),g=a("7212"),b=a("cb88"),h=a("926a"),y=a("1285"),w=a("bc35"),T=a("14ba"),k={components:{BmScale:b["BmScale"],BmMapType:b["BmMapType"],BmOverviewMap:b["BmOverviewMap"],BmPanorama:b["BmPanorama"],BmControl:b["BmControl"],BmLabel:b["BmLabel"],BaiduMap:b["BaiduMap"],BmLocalSearch:b["BmLocalSearch"],BmNavigation:b["BmNavigation"],BmGeolocation:b["BmGeolocation"],BmCityList:b["BmCityList"],BmMarker:b["BmMarker"],deviceState:p["default"]},data:function(){var e=/^[0-9]{15}$/,t=function(t,a,i){if(!e.test(a))return i(new Error("请输入15位IMEI"));i()};this.chartSettings={radius:[5,40],offsetY:70},this.chartExtend={yAxisType:["percent"],tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"}};var a=function(e,t,a){var i=/[0-9A-Za-z]$/;""==t?a(new Error("设备地址不能为空")):i.test(t)?a():a(new Error("设备地址必须为大小写字母数字"))};return{paginations:{layout:"total, sizes, prev, pager, next, jumper"},queryPayload:{excludeKeys:"data",include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},secret:T["secret"],productDetail:{},addACL:{},videoOptions:["m3u8","mp4","flv","mp3"],queryInfo:{},isFullscreen:!1,border:!0,stripe:!0,lineHeight:"medium",aclObj:{},editRow:{},selectedList:[],formData:{},topicData:[],InfoDialog:!1,devicedetail:{},stateDialog:!1,stateDetail:{},chartOnlone:{columns:["状态","数量"],rows:[{"状态":"在线","数量":0},{"状态":"离线","数量":0}]},chartwaring:{},parseTbas:[],activeparseTbas:"",chartProduct:{},queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,statusFlag:!1,status:"",number:"",product:"",type:"",limit:20,skip:0,order:"-createdAt",keys:"count(*)"},treeDataValue:"",isALL:!0,sizeZoom:10,activeName:"first",imeideviceName:"first",mapDialog:!1,dialogtempconfig:[],arrlist:[],deviceId:"",deciceCompany:"",gutter:24,leftRow:3,rightRow:21,popoverVisible:!1,vabicon:"ancient-gate-fill",Company:sessionStorage.getItem("title")||"",curDepartmentId:"",roleProps:{children:"children",label:"name"},listLoading:!1,productimg:"",bmapdialogVisible:!1,onlineall:0,activeall:0,userId:"",batchid:"",pcdialogVisible:!0,devicedialogVisible:!1,equvalue:"",cities:[],selectdevice:"",onlinedevices:"",deviceinput:"",devicenumber:"",multipleTable:[],selectRow:[],devicelength:10,devicestart:0,devicetotal:0,visible2:!1,imeiform:{devimei:"",productName:"",address:""},deviceform:{videoSrc:"",videoType:"m3u8",name:"",devaddr:"",batchId:"",desc:"",nodeType:0,devType:"",netType:"",assetNum:"",devModel:"",address:"",productName:"",status:"",isEnable:"",brand:""},rules:{name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],devaddr:[{required:!0,message:"请输入设备编号",trigger:"blur"},{validator:a}],devimei:[{required:!0,message:"请输入设备IMEI",trigger:"blur"},{validator:t}],batchId:[{required:!0,message:"请输入设备批次",trigger:"blur"}],nodeType:[{required:!0,message:"请输入设备类型",trigger:"blur"}],netType:[{required:!0,message:"请选择网络格式",trigger:"change"}],devType:[{required:!0,message:"请选择设备类型",trigger:"change"}],productName:[{required:!0,message:"请选择产品名称",trigger:"change"}]},pcformrule:{pcname:[{required:!0,message:"请输入批次名称",trigger:"blur"}],createdtime:[{type:"date",required:!0,message:"请选择创建时间",trigger:"change"}]},pcformInline:{pcnumber:"",pcname:"",createdtime:""},pctableData:[],equipmentEditor:"添加",tableData:[],options:[],proTableData:[],proTableData1:[],activelength:[],onlinelength:[],center:{lng:0,lat:0},zoom:13,bmapform:{keyword:"",location:"",address:""},deviceid:"",map:null,addresspointer:"",productenable:!0,changeproduct:!0,tagsid:"",productroleslist:[]}},computed:Object(c["a"])({},Object(m["mapGetters"])({_tableDict:"global/_tableDict",token:"user/token",roleTree:"user/roleTree",language:"settings/language",_product:"user/_Product",_role:"acl/role"})),watch:{multipleTable:function(e){var t=this;this.selectRow=[],e.length>0&&e.forEach((function(e,a){t.selectRow.push(t.tableData.indexOf(e))}))}},mounted:function(){this.onlinedevices="dev_online"==this.$route.query.deciceType?"在线":"dev_unline"==this.$route.query.deciceType?"离线":"",this.selectdevice="zh"==this.language?"设备名称":"devicename",this.queryProduct(),this.getDevices(),this.aclObj=this.$aclObj(this._role),dgiotlog.log("this.aclObj",this.aclObj)},methods:Object(c["a"])(Object(c["a"])({paginationQuery:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.queryPayload=e;case 1:case"end":return a.stop()}}),a)})))()},goLink:function(e,t){var a,i=t.basedata;if(null===i||void 0===i||null===(a=i.videoSrc)||void 0===a||!a.length)return this.$message.info(this.$translateTitle("equipment.The device is not bound to the video address yet")),!1;this.$router.push({path:"/Tools/player",query:{type:i.videoType||"m3u8",url:i.videoSrc}})},handleTabClick:function(e,t){dgiotlog.log(this.activeparseTbas),dgiotlog.log(this.parseTbas)},updateParse:function(e,t,a,i){var r=arguments,o=this;return Object(s["a"])(u.a.mark((function n(){var l,s,c,d,p,m,f;return u.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:for(d in l=r.length>4&&void 0!==r[4]?r[4]:{},console.clear(),dgiotlog.log("字段",t),l["".concat(t)]={},s=[],c=[],dgiotlog.log(o.queryInfo),dgiotlog.log("frender ",i),i.config)o.queryInfo["".concat(d)]?(dgiotlog.log(i.config["".concat(d)],d),l["".concat(t)]["".concat(d)]=i.config["".concat(d)]):(dgiotlog.log(i.config["".concat(d)],"字段不存在"),c.push[i.config["".concat(d)]]);return dgiotlog.log("isField",s),dgiotlog.log("noField",c),dgiotlog.log("params",l.field),p={},p["".concat(t)]=o.queryInfo,m=_.merge(p,l),dgiotlog.log(m,"合并后的數據"),dgiotlog.log({field:m["".concat(t)]}),n.prev=17,n.next=20,o.$update_object(e,a,m);case 20:f=n.sent,dgiotlog.log(f),o.$message.success(o.$translateTitle("user.update completed")),n.next=29;break;case 25:n.prev=25,n.t0=n["catch"](17),dgiotlog.log(n.t0),o.$message.error("".concat(n.t0));case 29:case"end":return n.stop()}}),n,null,[[17,25]])})))()}},Object(m["mapMutations"])({set_tableDict:"global/set_tableDict",set_tableParser:"global/set_tableParser"})),{},{handleSubmit:function(e){return dgiotlog.log("data",e),v["Promise"].resolve()},handleSuccess:function(e){var t=this;e.table&&e.field&&e.config.order?this.$get_object(e.table,this.deviceId).then((function(a){dgiotlog.log(a),t.queryInfo=a["".concat(e.field)],t.queryInfo?t.updateParse(e.table,e.field,t.deviceId,e):t.$message.error("".concat(e.table," no field ").concat(e.field))})):this.$message.error("".concat(e.table," no field ").concat(e.field))},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)})),dgiotlog.log(this.selectedList)},handleDelete:function(e,t){var a=this,i=[];2==t?i.push({method:"DELETE",path:"/classes/Device/".concat(e.objectId),body:{}}):e.forEach((function(e){i.push({method:"DELETE",path:"/classes/Device/".concat(e.objectId),body:{}})})),dgiotlog.log(i,"batchParams"),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(s["a"])(u.a.mark((function e(){return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(f["batch"])(i);case 2:e.sent,a.$baseMessage(a.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){a.getDevices({start:0})}),1500);case 5:case"end":return e.stop()}}),e)}))))},ParserSave:function(e){dgiotlog.log("如果监听到有修改,则更新vuex 并 存入到数据库 ".concat(JSON.stringify(e)))},queryProduct:function(){var e=this;return Object(s["a"])(u.a.mark((function t(){var a,i,r;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.proTableData=[],e.proTableData1=[],t.next=4,Object(g["queryProduct"])({count:"objectId",order:"-updatedAt",where:{}});case 4:a=t.sent,i=a.results,r=void 0===i?[]:i,e.proTableData=r,dgiotlog.log(e.proTableData,"  this.proTableData"),e.$route.query.product&&e.proTableData.forEach((function(t,a){t.objectId==e.$route.query.product&&(e.equvalue=e.proTableData[a].objectId,e.productenable=!0,e.queryForm.access_token=e.token,e.$nextTick((function(){e.selectProdChange(e.$route.query.product)})))})),e.proTableData1=r.filter((function(e){return"0"!=e.objectId})),e.$route.query.productid&&(e.equvalue=e.$route.query.productid,e.productenable=!1),dgiotlog.log("this.equvalue",e.equvalue);case 13:case"end":return t.stop()}}),t)})))()},change:function(e){dgiotlog.log(e),e&&$(".el-tree").css({height:"120px",display:"block"})},selectProdChange:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){var i,r,o,n,l,s;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:if(t.listLoading=!0,"0"!=e){a.next=7;break}t.isALL=!0,a.next=30;break;case 7:return a.next=9,Object(g["getProduct"])(e).then((function(e){t.listLoading=!1;var a=e.config,i=void 0===a?{basedate:{}}:a,r=i.basedate,o=void 0===r?{params:[]}:r;dgiotlog.log(e,o),t.dialogtempconfig=[],"undefined"!=o.params&&(t.dialogtempconfig=o.params,dgiotlog.log("this.dialogtempconfig",t.dialogtempconfig))}));case 9:return t.isALL=!1,t.tableData=[],i={limit:t.devicelength,skip:t.devicestart,order:"-createdAt",count:"objectId",include:"product,name",where:{product:{$ne:null},name:{$ne:null,$exists:!0}}},""!=t.deviceinput&&("设备名称"==t.selectdevice?i.where.name=t.deviceinput:i.where.devaddr=t.deviceinput),""!=t.onlinedevices&&("在线"==t.onlinedevices?i.where.status="ONLINE":i.where.status="OFFLINE"),""!=t.devicenumber&&(i.where.devaddr=t.devicenumber),i.where.product=e,t.devicestart=0,a.next=19,Object(y["querycompanyDevice"])(i,t.queryForm.access_token);case 19:r=a.sent,o=r.results,n=void 0===o?[]:o,l=r.count,s=void 0===l?0:l,n.forEach((function(e){if(e.ACL)for(var t in e.ACL)e.Company=t.substr(5);else e.Company="";if(e.profile)for(var t in e.profile)e[t]=e.profile[t]})),dgiotlog.log(n),t.tableData=n,t.devicetotal=s,t.chartOnlone.rows[1]["数量"]=t.devicetotal,dgiotlog.log("tableData",t.tableData);case 30:t.listLoading=!1;case 31:case"end":return a.stop()}}),a)})))()},showTree:function(e,t){this.deviceId=e,this.deciceCompany=t,this.popoverVisible=!this.popoverVisible},CloseState:function(){this.stateDialog=!1},showInfo:function(e){var t=this;this.deviceId=e.objectId;var a,i,r={isArr:[],obj:[]},o=[];(dgiotlog.log(e),this.devicedetail=e,e.product.config.parser)&&(a=o).push.apply(a,Object(l["a"])(e.product.config.parser));e.product.config.profile&&(i=o).push.apply(i,Object(l["a"])(e.product.config.profile));this.devicedetail={},o=o.filter((function(e){return e.visible})),dgiotlog.log(this.parseTbas),this.devicedetail&&o.length?(o.forEach((function(t){if(dgiotlog.log(t.class),dgiotlog.info("%c%s","color: #fff; background: #20B2AA; font-size: 16px;","原始关联".concat(t.table,"表中").concat(t.class,"字段的值为")),dgiotlog.info("%c%s","color: #fff; background: #20B2AA; font-size: 16px;","".concat(JSON.stringify(t.config))),e["".concat(t.class)]){for(var a in e["".concat(t.class)])for(var i in t.config)if(a==i)"object"==Object(n["a"])(t.config.formDesc["".concat(a)])?(dgiotlog.log(a,i,"f ==== v object",t.config.formDesc["".concat(a)].label,t.config.formDesc["".concat(a)].default,"data[`${from.class}`][`${v}`] 为 "+e["".concat(t.class)]["".concat(i)]),r.obj.push(a),t.config.formDesc["".concat(a)]["default"]=e["".concat(t.class)]["".concat(i)],dgiotlog.log(t.config.formDesc["".concat(a)].label,e["".concat(t.class)],t.config.formDesc["".concat(a)].default)):(r.isArr.push(i),t.config["".concat(a)]=e["".concat(t.class)]["".concat(i)]);else for(var o in t.config.formDesc)a==o&&(r.obj.push(a),t.config.formDesc["".concat(o)]["default"]=e["".concat(t.class)]["".concat(a)]);dgiotlog.log("对象数据".concat(r.obj)),dgiotlog.log("数组数据".concat(r.isArr)),dgiotlog.info("%c%s","color: #fff; background: #20B2AA; font-size: 16px;","修改后".concat(t.table,"表中").concat(t.class,"字段的值为")),dgiotlog.info("%c%s","color: #fff; background: #20B2AA; font-size: 16px;","".concat(JSON.stringify(t.config)))}})),this.parseTbas=o,this.$nextTick((function(){t.activeparseTbas=t.parseTbas[0].name,t.InfoDialog=!0}))):this.$baseMessage(this.$translateTitle("product.No device template configured yet"),"error","vab-hey-message-error")},showMap:function(e,t){this.deviceId=t;var a=e.latitude,i=void 0===a?0:a,r=e.longitude,o=void 0===r?0:r;Number(i)&&Number(o)?(this.mapDialog=!0,this.center.lng=o,this.center.lat=i):this.$message.error("位置信息获取失败")},transferAcl:function(e){var t=this,a="role:"+e.name,i={};i[a]={read:!0,write:!0};var r={ACL:i,detail:{factory:e.depname}};this.$confirm(this.$translateTitle("确定要将设备迁移到"+e.name+"吗"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(u.a.mark((function e(){return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["putDevice"])(t.deviceId,r).then((function(e){e.updatedAt?(t.popoverVisible=!1,t.$message({type:"success",message:t.$translateTitle("迁移成功")})):t.$message({type:"success",message:t.$translateTitle("迁移成功")})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){dgiotlog.log(e)})),dgiotlog.log(e.name)},handleNodeClick:function(e,t){var a=this;return Object(s["a"])(u.a.mark((function i(){var r,o,n,l,s;return u.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(r=a._role.map((function(e){return e.name})),$(".el-tree").css({height:"0px",display:"none","overflow-x":"auto"}),$(".el-select-dropdown").css({display:"none"}),a.queryForm.workGroupName=e.label,e.name,o=e.objectId,a.curDepartmentId=o,!r.includes(e.name)){i.next=10;break}a.queryForm.access_token=a.token,i.next=20;break;case 10:if(1==t.level){i.next=19;break}return i.next=13,Object(w["getToken"])(e.name);case 13:n=i.sent,l=n.access_token,s=void 0===l?"":l,a.queryForm.access_token=s,i.next=20;break;case 19:a.queryForm.access_token=a.token;case 20:a.getDevices({start:0});case 21:case"end":return i.stop()}}),i)})))()},rolesSelect:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){var i;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.productroleslist=[],a.next=3,t.$get_object("Product",e);case 3:i=a.sent,i.results;case 5:case"end":return a.stop()}}),a)})))()},goEdit:function(e){var t=window.location.origin+"/spa",a="production";t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var i="".concat(t,"/#?devaddr=").concat(e.devaddr,"&proudctid=").concat(e.productid);window.open(i,"__blank"),localStorage.setItem("topoData",JSON.stringify(e.config))},addressSure:function(){var e=new BMap.LocalSearch(this.map);e.enableAutoViewport();""==this.bmapform.address&&(this.deviceform.address=this.bmapform.keyword,this.imeiform.address=this.bmapform.keyword),e.search(this.bmapform.keyword),this.bmapdialogVisible=!1},handler:function(e){e.BMap;var t=e.map;this.center.lng=120.2,this.center.lat=30.26667,this.zoom=this.zoom,this.map=t},mapClick:function(e){var t=this;this.center.lng=e.point.lng,this.center.lat=e.point.lat,this.addresspointer=e.point.lng.toFixed(6)+","+e.point.lat.toFixed(6);var a=new BMap.Geocoder;a.getLocation(e.point,(function(e){t.bmapform.address=e.address,t.deviceform.address=e.address,t.imeiform.address=e.address}))},updateLocation:function(){this.bmapdialogVisible=!0},handleClosebmap:function(){this.bmapdialogVisible=!1},getOnlineDevices:function(){var e=this;return Object(s["a"])(u.a.mark((function t(){var a,i,r,o;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.chartOnlone={columns:["状态","数量"],rows:[{"状态":"在线","数量":0},{"状态":"离线","数量":0}]},a={limit:1,count:"objectId",include:"product,name",keys:"name",where:{status:"ONLINE",product:{$ne:null},name:{$ne:null,$exists:!0}}},""!=e.deviceinput&&("设备名称"==e.selectdevice?a.where.name={$regex:e.deviceinput}:a.where.devaddr={$regex:e.deviceinput}),""!=e.devicenumber&&(a.where.devaddr=e.devicenumber),0!=e.equvalue&&e.selectProdChange(e.equvalue),t.prev=5,t.next=8,Object(y["querycompanyDevice"])(a,e.queryForm.access_token);case 8:i=t.sent,r=i.count,o=void 0===r?0:r,e.chartOnlone.rows[1]["数量"]=e.devicetotal-o,e.chartOnlone.rows[0]["数量"]=o,t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](5),dgiotlog.log(t.t0),e.$message.error("".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[5,15]])})))()},getDevices:function(){var e=arguments,t=this;return Object(s["a"])(u.a.mark((function a(){var i,r,o,n,l,s,c;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=e.length>0&&void 0!==e[0]?e[0]:{},t.listLoading=!0,r=t.$baseColorfullLoading(3),t.tableData=[],t.queryPayload.include="product,name",t.queryPayload.where={product:{$ne:null},name:"设备名称"===t.selectdevice&&t.deviceinput?{$regex:t.deviceinput}:{$ne:null,$exists:!0},devaddr:"设备编号"===t.selectdevice&&t.deviceinput?{$regex:t.deviceinput}:{$ne:null},status:"在线"==t.onlinedevices?"ONLINE":"离线"==t.onlinedevices?"OFFLINE":{$ne:null}},0!=t.equvalue&&t.selectProdChange(t.equvalue),0==i.start&&(t.devicestart=0),a.prev=8,a.next=11,Object(y["querycompanyDevice"])(t.queryPayload,t.queryForm.access_token);case 11:if(o=a.sent,n=o.results,l=void 0===n?[]:n,s=o.count,c=void 0===s?0:s,t.listLoading=!1,r.close(),null!==l&&void 0!==l&&l.length){a.next=20;break}return a.abrupt("return");case 20:l.forEach((function(e){if(e.location||(e.location={longitude:0,latitude:0}),e.ACL)for(var t in e.ACL)e.Company=t.substr(5);else e.Company=""})),t.tableData=l,t.devicetotal=c,t.$refs["devicePagination"].ination.total=c,a.next=34;break;case 26:a.prev=26,a.t0=a["catch"](8),dgiotlog.log(a.t0),t.listLoading=!1,r.close(),t.tableData=[],t.devicetotal=0,t.$message.error("".concat(a.t0));case 34:case"end":return a.stop()}}),a,null,[[8,26]])})))()},handelUpdate:function(e,t,a){var i=this;return Object(s["a"])(u.a.mark((function r(){var o,n;return u.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(n in o={},i,t)o[n]=t[n];o.isEnable=1!=o.isEnable,i.tableData[a]=o,i.$confirm("是否修改此设备状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(u.a.mark((function a(){var r;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("row",t),a.next=3,i.$update_object("Device",t.objectId,{isEnable:e});case 3:r=a.sent,void 0!=r?(i.$message({type:"success",message:"状态修改成功"}),i.getDevices()):(dgiotlog.log("Device error",error),Object(h["returnLogin"])(error));case 5:case"end":return a.stop()}}),a)})))).catch(Object(s["a"])(u.a.mark((function e(){var r;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i.$message({type:"info",message:"已取消修改"}),r=t,r.isEnable=1!=r.isEnable,i.tableData[a]=r;case 4:case"end":return e.stop()}}),e)}))));case 6:case"end":return r.stop()}}),r)})))()},timestampToTime:function(e){var t=new Date(1200*e),a=t.getFullYear()+"-",i=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",r=(t.getDate()+1<=10?"0"+t.getDate():t.getDate())+" ",o=(t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":",n=(t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":",l=t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds();return a+i+r+o+n+l},utc2beijing:function(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},filterTag:function(e,t){return t.tag===e},deleteDevcie:function(e){var t=this;return Object(s["a"])(u.a.mark((function e(){return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.multipleTable.map(function(){var e=Object(s["a"])(u.a.mark((function e(a){return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$del_object("Device",a.objectId);case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.$message({message:"删除成功",type:"success"}),t.getDevices();case 3:case"end":return e.stop()}}),e)})))()},editDevice:function(){var e=this;return Object(s["a"])(u.a.mark((function t(){var a;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$update_object("Device",item.objectId,params);case 2:a=t.sent,a.updatedAt?e.initQuery("设备修改成功","success"):e.$message({type:"error",message:a.error});case 4:case"end":return t.stop()}}),t)})))()},unactiveDevice:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){var i,r,o,n;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=[],r=[],t.multipleTable.map((function(e){i.push(e.objectId)})),o={isEnable:e},a.next=6,Object(f["Batchdelete"])("PUT","Device",i,o);case 6:n=a.sent,n&&(n.forEach((function(e,t){e.objectId=i[t],e.sortIndex=t+1,"success"==Object.keys(n[t])[0]?(e.msg="edit success",e.dangerouslyUseHTMLString=!1):(e.msg="<ol>\n            edit error <br>\n            message: ".concat(e.error.error," <br>\n            code: ").concat(e.error.code," <ol>"),e.dangerouslyUseHTMLString=!0),r.push({type:Object.keys(n[t])[0],message:e.msg,dangerouslyUseHTMLString:e.dangerouslyUseHTMLString})})),r.forEach((function(e,a){t.$baseNotify(e.message,"".concat(i[a]),e.type,"top-right",5e3*e.sortIndex,e.dangerouslyUseHTMLString)})),t.getDevices());case 8:case"end":return a.stop()}}),a)})))()},rowClass:function(e){e.row;var t=e.rowIndex;if(this.selectRow.includes(t))return{"background-color":"rgba(185, 221, 249, 0.3)"}},deviceSizeChange:function(e){this.devicelength=e,this.getDevices()},deviceCurrentChange:function(e){this.devicestart=(e-1)*this.devicelength,this.getDevices()},handleClose:function(){this.deviceid="",this.deviceform={name:"",devaddr:"",batchId:"",desc:"",nodeType:0,devType:"",netType:"",assetNum:"",devModel:"",address:"",videoSrc:"",productName:"",status:"",isEnable:"",brand:"",auth:"",yysId:""},this.$refs["deviceform"].resetFields(),this.devicedialogVisible=!1,this.equipmentEditor="添加"},addDeviceForm:function(){this.devicedialogVisible=!0,this.arrlist=[],this.equipmentEditor="添加",this.$route.query.productid?this.deviceform.productName=this.$route.query.productid:0!=this.equvalue?(this.changeproduct=!1,this.deviceform.productName=this.equvalue,this.selectChange(this.equvalue,"add")):this.deviceform.productName=""},handleClose1:function(){this.pcdialogVisible=!1,this.batchid="",this.pcformInline={pcname:"",createdtime:""}},makeSure:function(e,t){var a=this;return Object(s["a"])(u.a.mark((function i(){var r;return u.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,a.$del_object("Device",row.objectId);case 2:r=i.sent,r.error?a.$message({type:"error",message:"删除失败"}):(a.$message({type:"success",message:"删除成功"}),a.getDevices()),e._self.$refs["popover-".concat(t)].doClose();case 5:case"end":return i.stop()}}),i)})))()},editorDevice:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){var i;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(i in t.editRow={},t.selectChange(e.product.objectId,"edit"),t.deviceform={},dgiotlog.log("row",e),t.editRow=e,t.deviceid=e.objectId,t.devicedialogVisible=!0,t.imeideviceName="first",t.deviceform={devaddr:e.devaddr,name:e.name,assetNum:e.detail.assetNum,devModel:e.detail.devModel,desc:e.detail.desc,productid:e.product.objectId,brand:e.detail.brand,productName:e.product.objectId,status:e.status,isEnable:e.isEnable,videoType:e.detail.videoType,videoSrc:e.detail.videoSrc,address:e.detail.address},dgiotlog.log("this.deviceform12131",t.deviceform),dgiotlog.log("row.basedata",e.basedata),e.basedata)t.$set(t.deviceform,i,e.basedata[i]);dgiotlog.log("this.deviceform",t.deviceform),t.bmapform={address:e.detail.address},t.center={lat:location.latitude,lng:location.longitude},t.addresspointer=void 0==e.detail||void 0==location||location.latitude+e.detail==void 0?"":location.longitude,t.equipmentEditor="编辑";case 17:case"end":return a.stop()}}),a)})))()},getBatch:function(){return new v["Promise"]((function(e,t){i.length>0?e(i):t(!1)}))},initQuery:function(e,t){this.$message({type:t||"info",message:e}),this.dialogFormVisible=!1,this.getDevices({start:0})},updateDevice:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){var i;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$update_object("Device",t.deviceid,e);case 2:i=a.sent,i.updatedAt||i.devaddr?t.initQuery("设备更新成功","success"):t.$message({type:"error",message:i.error});case 4:case"end":return a.stop()}}),a)})))()},createDevice:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){var i;return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$create_object("Device",e);case 2:i=a.sent,i.objectId?(t.deviceform={},t.handleClose(),t.initQuery("设备创建成功","success")):t.$message({type:"error",message:i});case 4:case"end":return a.stop()}}),a)})))()},selectChange:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add";this.arrlist=[],Object(g["getProduct"])(e).then((function(e){var i=e.config,r=void 0===i?{basedate:{}}:i,o=e.ACL;t.productDetail=e,t.addACL=o,r.basedate&&r.basedate.params.length>0&&(t.arrlist=r.basedate.params,"add"==a&&t.arrlist.map((function(e){var a;if("bool"==e.type)t.$set(t.deviceform,e.identifier?e.identifier:"",null!==(a=e.default)&&void 0!==a&&a.length?e.default:"");else if("enum"==e.type){var i,r,o;t.$set(t.deviceform,e.identifier?e.identifier:"",null!==(i=e.specs)&&void 0!==i&&null!==(r=i[0])&&void 0!==r&&null!==(o=r.attribute)&&void 0!==o&&o.length?e.specs[0].attribute:"")}else{var n;t.$set(t.deviceform,e.identifier?e.identifier:"",null!==(n=e.default)&&void 0!==n&&n.length?e.default:"")}e.required&&("bool"==e.type?t.rules[e.identifier]=[{required:!0,message:"请选择"+e.name,trigger:"change"}]:t.rules[e.identifier]=[{required:!0,message:"请输入"+e.name,trigger:"blur"}])})),dgiotlog.log("afd",t.arrlist),dgiotlog.log("deviceform",t.deviceform),dgiotlog.log("rules",t.rules))}))},submitForm:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$refs[e].validate(function(){var e=Object(s["a"])(u.a.mark((function e(a){var i,r,o,n,l,s;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=23;break}for(n in i={__type:"GeoPoint",latitude:t.center.lat?t.center.lat:0,longitude:t.center.lng?t.center.lng:0},r={assetNum:t.deviceform.assetNum,devModel:t.deviceform.devModel,brand:t.deviceform.brand,address:t.bmapform.address,desc:t.deviceform.desc,videoType:t.deviceform.videoType,videoSrc:t.deviceform.videoSrc},o={},t.deviceform)o[n]=t.deviceform[n];t.$delete(o,"address"),t.$delete(o,"assetNum"),t.$delete(o,"batchId"),t.$delete(o,"brand"),t.$delete(o,"desc"),t.$delete(o,"devModel"),t.$delete(o,"devType"),t.$delete(o,"devaddr"),t.$delete(o,"isEnable"),t.$delete(o,"name"),t.$delete(o,"netType"),t.$delete(o,"nodeType"),t.$delete(o,"productName"),t.$delete(o,"status"),t.$delete(o,"productid"),""!=t.deviceid?(l={name:t.deviceform.name,devaddr:t.deviceform.devaddr,product:{__type:"Pointer",className:"Product",objectId:t.editRow.product.objectId},detail:r,location:i,basedata:o,profile:o},t.updateDevice(l),t.handleClose(),t.getDevices({start:0})):(s={count:"objectId",where:{name:{$in:[t.deviceform.name]},devaddr:{$in:[t.deviceform.devaddr]}}},t.$query_object("Device",s).then((function(e){if(e.count>0)t.$message("此设备已被创建");else{var a={product:{__type:"Pointer",className:"Product",objectId:t.deviceform.productName},status:"OFFLINE",isEnable:!1,ACL:t.addACL,name:t.deviceform.name,devaddr:t.deviceform.devaddr,objectId:t.deviceform.devaddr,lastOnlineTime:0,detail:r,location:i,basedata:o};a.detail.devType=t.productDetail.devType,a.detail.category=t.productDetail.category.objectId,console.log("createDevice params\n ",a),t.createDevice(a)}}))),e.next=25;break;case 23:return t.$message({type:"error",message:"请按照要求填写参数"}),e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return a.stop()}}),a)})))()},submitimeiForm:function(e){var t=this;return Object(s["a"])(u.a.mark((function a(){return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$refs[e].validate(function(){var e=Object(s["a"])(u.a.mark((function e(a){var i;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=5;break}i={productid:t.imeiform.productName,devaddr:t.imeiform.devimei,latitude:t.center.lat?t.center.lat:0,longitude:t.center.lng?t.center.lng:0},Object(y["addimeidevice"])(i).then((function(e){e.objectId?(t.deviceform={},t.handleClose(),t.initQuery("设备创建成功","success")):t.$message({type:"error",message:e})})),e.next=7;break;case 5:return t.$message({type:"error",message:"请按照要求填写参数"}),e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return a.stop()}}),a)})))()},deviceToDetail:function(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.objectId,nodeType:e.nodeType,productid:e.product.objectId,ischildren:"false"}})},konvaDevice:function(e){this.$router.push({path:"/Topo",query:{productid:e.product.objectId,devaddr:e.devaddr,deviceid:e.objectId,type:"device"}})}})},x=k,D=(a("a5cd"),a("bdd7")),I=Object(D["a"])(x,r,o,!1,null,"33259557",null);t["default"]=I.exports},cce6:function(e,t,a){},dfab:function(e,t,a){}}]);