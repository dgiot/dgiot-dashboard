/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2021-12-31 11:56:24
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef27f27a"],{"0085":function(e,t,a){},"0213":function(e,t,a){"use strict";a("07ca")},"042f7":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":"",title:e.title,visible:e.dialogFormVisible,width:"100vh"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(" "+e._s(e.$translateTitle("button.determine"))+" ")])]},proxy:!0}])},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"表名",prop:"class"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.class,callback:function(t){e.$set(e.form,"class",t)},expression:"form.class"}})],1),a("el-form-item",{attrs:{label:"key",prop:"key"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}})],1),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("rule.Type")},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.dicttype,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.title"),prop:"title"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"","default-first-option":"",filterable:"",placeholder:"请选择",size:"mini"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}},e._l(e.titleOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("task.data"),prop:"data"}},[a("div",{staticStyle:{height:"30vh",overflow:"auto"}},[a("vab-monaco-plus",{ref:"monacoCode",attrs:{codes:e.codes,language:"json","read-only":!1,theme:"vs-dark"}})],1)])],1)],1)},r=[],i=a("fb07"),l=a("d0d7"),s=a.n(l),o=(a("04d6"),a("e0e9")),c={name:"DictEdit",data:function(){return{activeName:"first",amisKey:moment(new Date).format("X"),type:"",codes:"",dictId:"",form:{title:"",author:""},dicttype:["dict","word","rule"],titleOption:["worddict","ruledict"],rules:{title:[{required:!0,trigger:"blur",message:"请输入标题"}],author:[{required:!0,trigger:"blur",message:"请输入作者"}]},title:"",dialogFormVisible:!1}},computed:{},watch:{"form.data":{handler:function(e){this.codes=JSON.stringify(e,null,4)},immediate:!0,deep:!0}},created:function(){},methods:{showEdit:function(e){e?(this.title="编辑",this.form=e):this.title="添加",this.dialogFormVisible=!0},close:function(){this.dialogFormVisible=!1},save:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(i["a"])(s.a.mark((function t(a){var n,r,i,l,c,d;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=17;break}if(n=e.form,r=n.title,i=n.type,l=n.key,c={data:JSON.parse(e.$refs.monacoCode.monacoEditor.getValue()),class:e.form.class,title:r,type:i,key:l},"add"!=e.type){t.next=10;break}return t.next=6,Object(o["postDict"])(c);case 6:t.sent,e.$message.success("".concat(e.$translateTitle("user.Save the template successfully"))),t.next=15;break;case 10:return t.next=12,Object(o["putDict"])(e.dictId,c);case 12:d=t.sent,d.msg,e.$message.success("".concat(e.$translateTitle("user.Save the template successfully")));case 15:e.$emit("fetch-data"),e.close();case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=c,u=a("bdd7"),p=Object(u["a"])(d,n,r,!1,null,null,null);t["default"]=p.exports},"07ca":function(e,t,a){},"0b72":function(e,t,a){var n={"./mqttLog.vue":"4351"};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id="0b72"},"0e2a":function(t,a,n){"use strict";n.r(a),n.d(a,"Websocket",(function(){return w})),n.d(a,"sendInfo",(function(){return v})),n.d(a,"TOPIC_EMPTY",(function(){return s})),n.d(a,"MSG_EMPTY",(function(){return o})),n.d(a,"DISCONNECT_MSG",(function(){return c})),n.d(a,"getsession",(function(){return h})),n.d(a,"_scokethost",(function(){return y}));n("1d17"),n("37c6"),n("98da"),n("e472"),n("1ec3"),n("9f39"),n("4656"),n("4c87"),n("d6a4"),n("3dec"),n("c4bc");var r=n("f121"),i=n("926a"),l=n("1b5c"),s="topic为空！",o="消息内容为空！",c="当前尚未连接",d="konva",u=["tcloudbaseapp.com","gitee.io","github.io","netlify.app","vercel.app","surge.sh"];var p=Object(l["getToken"])(r["tokenTableName"],r["storage"]),m={topic:"web/"+p,qos:2},f=window.location.hostname;function h(e){p=e,m={topic:"web/"+p,qos:2}}function g(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in a)if(new RegExp("(".concat(n,")")).test(t)){var r=a[n]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?r:b(r))}return t}function b(e){return("00"+e).substr(e.length)}var v={topic:"/test",text:"Hello world!",qos:0,retained:!0},y=Object(i["globalUrl"])(f,u).split("//")[1]||location.hostname;dgiotlog.info("%_scokethost is : ".concat(y),"color: green;");var w={modName:"websocket",client:null,connState:!1,cInfo:{host:y,port:"https:"===window.location.protocol?8084:8083,clientId:"C_"+(new Date).getTime(),userName:d,isSSL:"https:"===window.location.protocol,password:"test123",keepAlive:null,keepAliveInterval:10,cleanSession:!1},sendInfo:"{}",hooks:[],tablelist:[],subInfo:m,originrecivedata:[],send:function(){var e=this,t=JSON.parse(e.sendInfo);dgiotlog.log(t),e.sendMessage(t)},log:function(t){try{t=JSON.parse(t)}catch(e){}},newClient:function(){var e=this;e.client=new Paho.MQTT.Client(e.cInfo.host,Number(e.cInfo.port),e.cInfo.clientId)},sslPort:function(){var e=this;e.cInfo.useSSL?e.cInfo.port=8084:e.cInfo.port=8083},recive:function(e){dgiotlog.log(e)},add_hook:function(e,t){var a=this;if(a.hooks.length>0)for(var n=0;n<a.hooks.length;n++)if(a.hooks[n].re.toString()==e.toString())return a.hooks[n].re=e,void(a.hooks[n].callback=t);a.hooks.push({re:e,callback:t})},dispatch:function(e){dgiotlog.log("message",e);var t=this,a=e.destinationName,n=t.hooks;n.map((function(t){t.re.test(a)&&t.callback(e.payloadString)}))},connect:function(){var t=this;if(!t.client||!t.client.isConnected()){t.newClient(),t.client.onConnectionLost=function(e){0!==e.errorCode?(dgiotlog.log("onConnectionLost: "+e.errorMessage),setTimeout((function(){t.connect()}),1e3)):window.clearTimeout()},t.client.onMessageArrived=function(a){try{a.msgString=a.payloadString}catch(e){a.msgString="Binary message("+a.payloadBytes.length+")"}t.dispatch(a)};var a={onFailure:function(e){t.connState=!1,dgiotlog.log("连接失败 "+e.errorMessage),setTimeout((function(){t.connect()}),5e3)},onSuccess:function(){t.connState=!0,t.subscribe(t.subInfo,(function(e){e.result&&(dgiotlog.log(t.subInfo),dgiotlog.log("订阅成功"))}))}},n=t.cInfo.userName,r=t.cInfo.password,i=t.cInfo.keepAlive,l=t.cInfo.cleanSession,s="https:"===window.location.protocol;n&&(a.userName=n),r&&(a.password=r),i&&(a.keepAliveInterval=Number(i)),a.cleanSession=l,"https:"===window.location.protocol&&(a.useSSL=s),t.client.connect(a)}},disconnect:function(){var e=this;e.client&&this.client.isConnected()&&(e.client.disconnect(),e.client=null),dgiotlog.log("已经断开连接！"),e.connState=!1,setTimeout((function(){e.connect()}),5e3)},subscribe:function(e,t){var a=this;if(!a.client||!a.client.isConnected())return dgiotlog.log(c),void a.connect();e.topic?a.client.subscribe(e.topic,{qos:Number(e.qos),onSuccess:function(a){e.msg=a,dgiotlog.log(e.msg),e.result=!0,t&&t(e)},onFailure:function(a){128===a.errorCode[0]&&dgiotlog.log("The topic cannot SUBSCRIBE for ACL Deny"),e.msg=a,dgiotlog.log(a),e.result=!1,t&&t(e)}}):dgiotlog.log(s)},unsubscribe:function(e,t){var a=this;return a.client&&a.client.isConnected()?e.topic?void a.client.unsubscribe(e.topic,{onSuccess:function(a){e.msg=a,dgiotlog.log(e),e.result=!0,t&&t(e)},onFailure:function(a){e.msg=a,dgiotlog.log(a),e.result=!0,t&&t(e)}}):(a.tablelist.push({date:g(new Date,"yyyy-MM-dd hh:mm"),content:s}),void dgiotlog.log(s)):(a.tablelist.push({date:g(new Date,"yyyy-MM-dd hh:mm"),content:c}),dgiotlog.log(c),void a.connect())},sendMessage:function(e){var t=this,a=e.text;if(!t.client||!t.client.isConnected())return dgiotlog.log(c),void t.connect();if(e.topic)if(a){var n=new Paho.MQTT.Message(a);n.destinationName=e.topic,n.qos=Number(e.qos),n.retained=e.retained,t.client.send(n),dgiotlog.log(e)}else dgiotlog.log(o);else dgiotlog.log(s)}}},"0e8e":function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resourcechannel"},[a("h3",[e._v("通道管理")]),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"通道管理("+e.total+")",name:"first"}},[a("div",{staticClass:"firsttable"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.channelformsearch,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("resource.name")},model:{value:e.channelformsearch.name,callback:function(t){e.$set(e.channelformsearch,"name",t)},expression:"channelformsearch.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.Get_Re_Channel(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addchanneltype.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.selectchannel"))+" ")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.getChannelEnable}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[1==n.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):2==n.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")]):a("span",[e._v("任务通道")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.cType))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelstatus")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["ONLINE"==n.status?a("span",{staticStyle:{color:"green"}},[e._v(" 在线 ")]):a("span",{staticStyle:{color:"red"}},[e._v("离线")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s("channel/"+n.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.desc))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("el-button",{attrs:{slot:"reference",size:"mini",type:"primary"},on:{click:function(t){return e.editorChannel(n)}},slot:"reference"},[e._v(" 编辑 ")]),0==n.isEnable?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.qyChannel(n,"enable")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.qyChannel(n,"disable")}}},[e._v(" "+e._s(e.$translateTitle("developer.prohibit"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.updateChannel(n)}}},[e._v(" 详情 ")]),a("el-popover",{ref:"popover-"+r,attrs:{placement:"top",width:"300"}},[a("p",[e._v("确定删除这个"+e._s(n.name)+"通道吗？")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){n._self.$refs["popover-"+r].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.deleteChannel(n,r)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1),a("el-tooltip",{staticClass:"item",attrs:{content:"请先启用通道",disabled:"OFFLINE"!=n.status,effect:"dark",placement:"top"}},[a("el-button",{staticStyle:{position:"absolute",width:"100px",height:"10px",opacity:"0"},attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.subProTopic(n)}}})],1),a("el-button",{attrs:{disabled:"OFFLINE"==n.status,size:"mini",type:"primary"},on:{click:function(t){return e.subProTopic(n)}}},[e._v(" 订阅日志 ")])]}}])})],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.channelCurrentChange,"size-change":e.channelSizeChange}})],1)],1)]),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,"close-on-click-modal":!1,title:e.channelupdated+"通道",top:"0",visible:e.channelForm,width:"50%"},on:{"update:visible":function(t){e.channelForm=t}}},[a("el-form",{ref:"addchannel",attrs:{"label-width":"120px",model:e.addchannel,rules:e.addrules}},[a("el-form-item",{attrs:{label:"通道类型",prop:"region"}},[a("el-select",{attrs:{disabled:"",placeholder:"通道类型"},on:{change:e.removeauto},model:{value:e.addchannel.region,callback:function(t){e.$set(e.addchannel,"region",t)},expression:"addchannel.region"}},e._l(e.channelregion,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title.zh,value:e.cType}})})),1),a("el-row",{staticStyle:{width:"100%",height:"500px","overflow-x":"hidden","overflow-y":"scroll","line-height":"30px","text-align":"center"},attrs:{gutter:24}},e._l(e.channelregion,(function(t,n){return a("el-col",{key:n,staticStyle:{margin:"20px 0",cursor:"pointer"},attrs:{span:8}},[a("el-card",{staticClass:"box-card",style:{color:e.addchannel.region==t.cType?"#00bad0":"#c0c4cc"},attrs:{shadow:e.addchannel.region==t.cType?"always":"hover",size:"mini"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.title.zh))]),a("el-button",{staticStyle:{float:"right"},attrs:{disabled:""!=e.resourceid,size:"mini",type:e.addchannel.region==t.cType?"success":"primary"},on:{click:function(a){return e.setCard(t.cType)}}},[e._v(" "+e._s(e.addchannel.region==t.cType?"已选择":"选择")+" ")])],1),a("div",{staticClass:"text item"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("img",{staticClass:"image",staticStyle:{width:"50px",height:"50px"},attrs:{src:"https://imgs.iotku.com/2020/2/21/23efecea9bfdbbf8a132089e251fc6e7.png"}})]),a("el-col",{attrs:{span:12}},[a("el-tag",[e._v(e._s(t.cType))])],1)],1)],1)])],1)})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:e.$translateTitle("developer.channelname")},model:{value:e.addchannel.name,callback:function(t){e.$set(e.addchannel,"name",t)},expression:"addchannel.name"}})],1),a("el-form-item",{attrs:{label:"所属应用",rules:[{required:!0,message:"请选择所属应用",trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"请选择所属应用"},model:{value:e.addchannel.applicationtText,callback:function(t){e.$set(e.addchannel,"applicationtText",t)},expression:"addchannel.applicationtText"}},[a("template",{slot:"append"},[a("i",{class:[e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{cursor:"pointer"},on:{click:function(t){e.showTree=!e.showTree}}})])],2),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.title.zh,prop:t.showname,required:t.required}},["string"==t.type?a("el-input",{model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}}):"integer"==t.type?a("el-input",{model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}}):"boolean"==t.type?a("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1):e._e()],1)],1)})),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{autocomplete:"off",placeholder:e.$translateTitle("developer.describe"),rows:3,type:"textarea"},on:{change:e.inputChange},model:{value:e.addchannel.desc,callback:function(t){e.$set(e.addchannel,"desc",t)},expression:"addchannel.desc"}})],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addchannelForm("addchannel")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:"通道详情",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[e._v("ID:")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(e.resourceid)+" ")])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Resource Type:")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(e.resoucetype)+" ")])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Description:")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(e.description)+" ")])],1),e._l(e.detailchannel,(function(t,n){return a("el-row",{key:t},[a("el-col",{attrs:{span:12}},[e._v(" "+e._s(n)+" ")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(t)+" ")])],1)}))],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.dialogVisible=!1}}},[e._v(" 确 定 ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleCloseSubdialog,title:e.channelname+"日志",visible:e.subdialog,width:"85%"},on:{"update:visible":function(t){e.subdialog=t}}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("pre",{staticClass:"ace_editor",staticStyle:{width:"100%","min-height":"300px"},attrs:{id:"subdialog"}},[e._v("                    "),a("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}}),e._v("        ")])]),a("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[a("el-switch",{staticStyle:{display:"inline-block","margin-right":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"自动刷新"},on:{change:e.stopsub},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}})],1)])],1)],1)},i=[],l=a("fb07"),s=a("e97b"),o=a("d0d7"),c=a.n(o),d=(a("1d17"),a("37c6"),a("16b8"),a("c4bc"),a("80ab"),a("a98c"),a("fc3d"),a("e472"),a("1ec3"),a("9f39"),a("4656"),a("04d6"),a("89e8")),u=a("5880"),p=a("bb22"),m=a("5da9"),f=a("1b07"),h=a("926a"),g=a("0e2a"),b={inject:["reload"],data:function(){return{dialogVisible:!1,isopen:"suo",pwdType:"password",tableData:[],channelForm:!1,channelupdated:"新增",activeName:"first",channelId:"",channelformsearch:{name:""},channelregion:[],addchannel:{region:"",desc:"",applicationtText:""},applicationList:[],addrules:{roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]},length:10,start:0,total:0,selectregion:{},resourceid:"",resoucetype:"",description:"",detailchannel:"",subdialog:!1,value4:"",subdialogid:"",subdialogtimer:null,channelname:"",arrlist:[],channelrow:[],showTree:!1,allApps:[],defaultProps:{children:"children",label:"label"}}},computed:Object(s["a"])({},Object(u["mapGetters"])({roleTree:"user/roleTree"})),mounted:function(){this.Get_Re_Channel(0),this.dialogType(),this.getApplication()},methods:{setCard:function(e){this.removeauto(e)},inputChange:function(e){console.log(e)},validUrl:function(e,t,a){var n=/^[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/;n.test(t)?a():a(new Error("需要输入正确的url"))},validPort:function(e,t,a){var n=/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;n.test(t)?a():a(new Error("需要输入正确的端口号"))},Get_Re_Channel:function(e){var t=this;0==e&&(this.start=0);var a={count:"objectId",order:"-createdAt",limit:this.length,skip:this.start,where:{}};""!=this.channelformsearch.name&&(a.where.name=this.channelformsearch.name),this.$query_object("Channel",a).then((function(e){e&&(t.total=e.count,t.tableData=e.results)})).catch((function(e){"209"==e.code?(t.$message({type:"warning",message:"登陆权限过期，请重新登录"}),t.$router.push({path:"/login"})):119==e.code&&t.$message({type:"error",message:"没有操作权限"})}))},getApplication:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a,n,r;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={limit:100},t.next=3,Object(m["queryRole"])(a);case 3:n=t.sent,r=n.results,r.map((function(t){var a={};a.id=t.id,a.name=t.desc,e.applicationList.push(a)}));case 6:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.addchannel.applicationtText=e.name},dialogType:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(f["resourceTypes"])();case 3:a=t.sent,e.channelregion=a;case 5:case"end":return t.stop()}}),t)})))()},qyChannel:function(e,t){var a=this;Object(p["subupadte"])(e.objectId,t).then((function(e){e&&a.$message({type:"success",message:"".concat("enable"==t?"启用成功":"禁用成功")}),a.Get_Re_Channel(0)})).catch((function(e){a.$message(e.error)}))},updateChannel:function(e){console.log(e),this.dialogVisible=!0,this.resourceid=e.objectId,this.detailchannel=e.config,this.resoucetype=e.cType,this.description=e.desc},addchannelForm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={};for(var n in t.addchannel)a[n]=t.addchannel[n];delete a.region,delete a.desc,delete a.type,delete a.isEnable,delete a.name,console.log("addchannelForm",t.addchannel);var r="role:"+t.addchannel.applicationtText,i={};i[r]={read:!0,write:!0};var l={ACL:i,config:a,name:t.addchannel.name,cType:t.addchannel.region,desc:t.addchannel.desc};t.addchannelaxios(l)}}),(function(e){Object(h["returnLogin"])(e)}))},addchannelaxios:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["postChannel"])(e).then((function(e){e&&(t.$message({type:"success",message:"编辑"==t.channelupdated?"编辑成功":"创建成功"}),t.$refs["addchannel"].resetFields(),t.addchannel={},t.channelForm=!1,t.resourceid="",t.Get_Re_Channel(0))}));case 2:case"end":return a.stop()}}),a)})))()},deleteChannel:function(e,t){var a=this;Object(d["delChannel"])(row.objectId).then((function(n){a.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(t)].doClose(),a.Get_Re_Channel(0)})).catch((function(e){console.log(e.error)}))},addchanneltype:function(){this.channelForm=!0,this.channelupdated="新增"},handleClose:function(){this.addchannel={},this.channelForm=!1,this.$refs["addchannel"].resetFields(),this.resourceid=""},getChannelEnable:function(e,t){return 1==e.row.isEnable?"green_active":"red_active"},channelSizeChange:function(e){this.length=e,this.Get_Re_Channel()},channelCurrentChange:function(e){this.start=(e-1)*this.length,this.Get_Re_Channel()},arrSort:function(e,t){var a=e.order,n=t.order;return a<n?-1:a>n?1:0},orderObject:function(e){var t=[];for(var a in e)e[a].showname=a,t.push(e[a]);return t.sort(this.arrSort)},removeauto:function(e){var t=this;console.log(e),console.log(this.channelregion,this.allApps);var a={},n={name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]};if(""==this.resourceid?this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(e){e.default?a[e.showname]=e.default:a[e.showname]="",e.required&&("string"==e.type||"integer"==e.type?n[e.showname]=[{required:!0,trigger:"blur"}]:n[e.showname]=[{required:!0,trigger:"change"}])})),a.region=e,a.desc="",a.name="",a.type=t.selectregion.type,a.isEnable=!1)})):this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(r){for(var i in t.channelrow.config)r.showname==i&&(a[r.showname]=t.channelrow.config[i]),r.required&&("string"==r.type||"integer"==r.type?n[r.showname]=[{required:!0,trigger:"blur"}]:n[r.showname]=[{required:!0,trigger:"change"}]),a.region=e,a.desc=t.channelrow.desc,a.name=t.channelrow.name,a.type=t.selectregion.type,a.isEnable=t.channelrow.isEnable})))})),console.log("this.channelrow",this.channelrow),this.channelrow.length>0)for(var r in this.channelrow.ACL.permissionsById)a.applicationtText=r?r.substr(5):"";this.addchannel=a,this.addchannel.region=e,this.addrules=n},editorChannel:function(e){this.channelrow=e,this.resourceid=e.objectId,this.channelForm=!0,this.channelupdated="编辑",this.removeauto(e.cType)},nowtime:function(){var e=Date.parse(new Date),t=new Date(e),a=(t.getFullYear(),t.getMonth()+1<=10?t.getMonth():t.getMonth(),t.getDate()+1<=10?t.getDate():t.getDate(),(t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":"),n=(t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":",r=t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds();return a+n+r+" "},subProTopic:function(e){this.subdialog=!0,this.subdialogid=e.objectId,this.channelname=e.objectId,setTimeout((function(){n=ace.edit("subdialog"),n.session.setMode("ace/mode/text"),n.setTheme("ace/theme/gob"),n.setReadOnly(!0),n.setOptions({enableBasicAutocompletion:!1,enableSnippets:!0,enableLiveAutocompletion:!0})}));var t={topic:"log/channel/"+e.objectId,qos:2},a=new RegExp("log/channel/"+e.objectId),r="",i=this;g["Websocket"].add_hook(a,(function(e){n.session.getLength()>=1e3?r="":r+=i.nowtime()+e+"\n",n.setValue(r),n.gotoLine(n.session.getLength())}));var l=JSON.stringify({action:"start_logger"});g["Websocket"].subscribe(t,(function(a){if(a.result){console.log(t),console.log("订阅成功");var n={topic:"channel/"+e.objectId,text:l,retained:!0,qos:2};g["Websocket"].sendMessage(n),i.subdialogtimer=window.setInterval((function(){g["Websocket"].sendMessage(n)}),6e5)}}))},stopsub:function(e){var t;t=0==e?JSON.stringify({action:"stop_logger"}):JSON.stringify({action:"start_logger"});var a={topic:"channel/"+this.subdialogid,text:t,retained:!0,qos:2};g["Websocket"].sendMessage(a)},handleCloseSubdialog:function(){var e=JSON.stringify({action:"stop_logger"}),t={topic:"channel/"+this.subdialogid,text:e,retained:!0,qos:2};g["Websocket"].sendMessage(t),this.subdialog=!1,window.clearInterval(this.subdialogtimer),this.subdialogtimer=null}}},v=b,y=(a("c025"),a("bdd7")),w=Object(y["a"])(v,r,i,!1,null,"31d6aa5f",null);t["default"]=w.exports},1262:function(e,t,a){},"14f5":function(e,t,a){"use strict";a("e9e9")},"19f2":function(e,t,a){},"2a28":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rulesengine dgiot-container"},[a("div",{staticClass:"engintable"},[a("div",{staticClass:"engineheader"},[a("el-button",{staticStyle:{float:"right"},attrs:{disabled:e.alarmsRuleId.length>0&&e.engineData.length>0,icon:"el-icon-plus",size:"small",type:"primary"},on:{click:e.addEngine}},[e._v(" "+e._s(e.$translateTitle("developer.add"))+" ")])],1),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{"cell-class-name":e.getRowindex,data:e.engineData}},[a("el-table-column",{attrs:{align:"center",label:"ID","show-overflow-tooltip":"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{on:{click:function(t){return e.detailRules(n.id)}}},[e._v(e._s(n.id))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("leftbar.topics"),"show-overflow-tooltip":"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.for.join(",")))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"SQL",prop:"rawsql","show-overflow-tooltip":"",width:"200"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("rule.ResponseAction")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return e._l(n.actions,(function(t,n){return a("p",{key:n},[e._v(" "+e._s(t.name)+" ")])}))}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.hit")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e.matched(n.metrics)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.state")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.changeRule(n.id,n.enabled)}},model:{value:n.enabled,callback:function(t){e.$set(n,"enabled",t)},expression:"row.enabled"}})]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.detailRules(n.id)}}},[e._v(" "+e._s(e.$translateTitle("equipment.see"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editRule(n.id)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteRule(n.id)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("div",{staticClass:"block",staticStyle:{display:"none"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.pagesize,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),a("vab-parser-pagination",{key:e.engineData.length+"forensics",ref:"forensics",attrs:{pagination:e.paginations,"query-payload":e.queryPayload},on:{pagination:e.featchData,paginationQuery:e.paginationQuery}})],1)],1)])},r=[],i=a("fb07"),l=(a("f1e1"),a("c4bc"),a("16b8"),a("1c6f"),a("d0d7")),s=a.n(l),o=a("1b07"),c={data:function(){return{paginations:{layout:"total, sizes, prev, pager, next, jumper"},queryPayload:{excludeKeys:"data",include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},height:this.$baseTableHeight(0),engineData:[],pagesize:10,start:0,total:0,productid:this.$route.query.productid||"",ruleType:this.$route.query.type||"",uid:this.$route.query.uuid||"",alarmsRuleId:""}},mounted:function(){this.featchData()},methods:{paginationQuery:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.queryPayload=e;case 1:case"end":return a.stop()}}),a)})))()},featchData:function(){this.productid&&this.uid&&this.ruleType?(this.alarmsRuleId="rule:".concat(this.ruleType,"_").concat(this.productid,"_").concat(this.uid),this.getalarmsRule(this.alarmsRuleId)):this.orginRule()},getalarmsRule:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){var n,r;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["getRuleDetail"])(e);case 2:n=a.sent,console.log(n,"response"),r=[],r.push(n.data),t.engineData=r,console.log(t.engineData,"  this.engineData"),t.total=t.engineData.length;case 9:case"end":return a.stop()}}),a)})))()},orginRule:function(){var e=this;return Object(i["a"])(s.a.mark((function t(){var a,n,r,i;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$baseColorfullLoading(),t.next=4,Object(o["getRule"])({});case 4:n=t.sent,r=n.data,i=void 0===r?[]:r,e.engineData=i,e.total=e.engineData.length,e.$baseMessage(e.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),a.close(),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),console.log(t.t0),e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(t.t0),"error","vab-hey-message-error");case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},handleSizeChange:function(e){},handleCurrentChange:function(e){},addEngine:function(){var e={title:"新增"};this.productid.length&&(e["productid"]=this.productid),this.uid.length&&(e["uid"]=this.uid),this.ruleType.length&&(e["type"]=this.ruleType),this.$router.push({path:"/rules_engine/addengine",query:e})},matched:function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a].matched;return t},changeRule:function(e,t){var a=this;return Object(i["a"])(s.a.mark((function n(){var r,i;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={enabled:t},n.next=3,Object(o["put_rule_id"])(e,r);case 3:i=n.sent,console.log(i),a.$message("状态修改成功");case 6:case"end":return n.stop()}}),n)})))()},actions:function(e){return e.map((function(e){return e.name})),string.join(",")},getRowindex:function(e,t,a){if(0==e.columnIndex)return"firstcolumn"},detailRules:function(e){this.$router.push({path:"/rules_engine/checkengine",query:{id:e}})},editRule:function(e){this.$router.push({path:"/rules_engine/addengine",query:{id:e,title:"编辑"}})},deleteRule:function(e){var t=this;Object(o["ruleDelete"])(e).then((function(e){e&&(t.$message("删除成功"),t.orginRule())})).catch((function(e){t.$message(e.error)}))}}},d=c,u=(a("3e7d"),a("bdd7")),p=Object(u["a"])(d,n,r,!1,null,"1a853e03",null);t["default"]=p.exports},"2d9a":function(e,t,a){"use strict";a("fc1a")},"34ef":function(e,t,a){},"3e7d":function(e,t,a){"use strict";a("855a")},"41da":function(e,t,a){"use strict";a("6257")},"42fb":function(e,t,a){"use strict";a("34ef")},4351:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"log log-container"},[n("div",[n("a-tabs",{attrs:{"default-active-key":"editor"},on:{change:e.stopchannel}},[n("a-tab-pane",{key:"editor"},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("dgiot-icon",{attrs:{icon:"aspect-ratio-fill"}}),e._v(" "+e._s(e.$translateTitle("Logs.console"))+" ")],1),n("vab-editor",{key:e.refreshFlag,attrs:{lang:"text","max-lines":(e.isFullscreen,1e3/12),"min-lines":(e.isFullscreen,1e3/12),theme:"gob",value:e.msg}})],1),n("a-tab-pane",{key:"table"},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("dgiot-icon",{attrs:{icon:"table-2"}}),e._v(" "+e._s(e.$translateTitle("Logs.table"))+" ")],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list.slice((e.queryForm.pageNo-1)*e.queryForm.pageSize,e.queryForm.pageNo*e.queryForm.pageSize)},scopedSlots:e._u([{key:"empty",fn:function(){return[n("a-empty",{staticClass:"vab-data-empty",attrs:{description:!1}})]},proxy:!0}])},[n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("home.updatedAt"),prop:"timestamp","show-overflow-tooltip":"",sortable:"",width:"230px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(" "+e._s(e.$moment(Number(a.timestamp)).format("YYYY-MM-DD HH:mm:ss.SSS"))+" ")])]}}])}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.log"),prop:"msg","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-input",{model:{value:a.msg,callback:function(t){e.$set(a,"msg",t)},expression:"row.msg"}},[n("el-button",{directives:[{name:"copyText",rawName:"v-copyText",value:a.msg,expression:"row.msg"}],attrs:{slot:"prepend",icon:"el-icon-copy-document"},slot:"prepend"})],1)]}}])})],1),n("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,layout:e.layout,"page-size":e.queryForm.pageSize,total:e.list.length},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),n("a-tab-pane",{key:"device",attrs:{disabled:!e.product.length}},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("dgiot-icon",{attrs:{icon:"traffic-light-line"}}),e._v(" "+e._s(e.$translateTitle("system.Accurate log"))+" ")],1),n("el-row",{attrs:{gutter:24}},[n("vab-query-form",[n("vab-query-form-top-panel",[n("el-form",{attrs:{inline:!0,"label-width":"120px",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",[n("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$translateTitle("alert.productname"))+" "),n("el-badge",{staticClass:"item",attrs:{value:e.product.length}})],1),n("el-select",{on:{change:function(t){return e.queryDevice()}},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e.product,(function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.objectId}})})),1)],1)],1)],1)],1)],1),n("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.Device},scopedSlots:e._u([{key:"empty",fn:function(){return[n("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.devicename"),prop:"name","show-overflow-tooltip":"",sortable:""}}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.devicenumber"),prop:"devaddr","show-overflow-tooltip":"",sortable:""}}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.log")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"text"},on:{click:function(t){return e.subscriptionlog(a.devaddr)}}},[e._v(" "+e._s(e.$translateTitle("product.subscriptionlog"))+" ")])]}}])})],1)],1)],1),n("el-dialog",{attrs:{"append-to-body":"",top:"1vh",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("vab-editor",{key:e.editorKey,attrs:{lang:"text","max-lines":(e.isFullscreen,1e3/12),"min-lines":(e.isFullscreen,1e3/12),theme:"gob",value:e.deviceLog}})],1)],1)])},r=[],i=a("fb07"),l=a("d0d7"),s=a.n(l),o=a("1285"),c={name:"MqttLog",components:{},props:{channelId:{type:String,default:"",required:!1},msg:{type:String,default:"",required:!1},list:{type:Array,default:function(){return[]},required:!1},product:{type:Array,default:function(){return[]},required:!1},refreshFlag:{type:String,default:"",required:!1}},data:function(){return{router:"",pubtopic:"",topicKey:"",dialogVisible:!1,editorKey:moment().format("x"),deviceLog:"",loading:!1,Device:[],height:this.$baseTableHeight(0)+60,clickItem:"",isFullscreen:!1,listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{product:"",device:"",account:"",searchDate:"",pageNo:1,pageSize:20}}},watch:{product:function(e){null!==e&&void 0!==e&&e.length&&(this.queryForm.product=e[0].objectId,this.queryDevice())},topicKey:{handler:function(e,t){var a=this;console.log("newVal topicKey",e),console.log("oldval topicKey",t);var n=this;e&&(this.$dgiotBus.$off(e),this.$dgiotBus.$on(e,(function(e){console.error(e);var t=e.payload;a.mqttMsg(t)}))),t&&(n.submessage="",n.msgList=[],n.logKey="99")},deep:!0,limit:!0}},mounted:function(){},methods:{stopchannel:function(e){"device"==e&&this.$dgiotBus.$emit("MqttUnbscribe",this.$dgiotBus.router(this.$route.fullPath),"log/channel/"+this.channelId+"/#")},mqttMsg:function(e){this.editorKey=moment().format("x"),this.deviceLog+=e+"\n"},subscriptionlog:function(e){this.editorKey=moment().format("x"),this.deviceLog="Log is true\n",this.pubtopic="channel/"+this.channelId+"/"+this.queryForm.product+"/"+e,this.subtopic="log/"+this.pubtopic,this.router=this.$dgiotBus.router(location.href),this.topicKey=this.$dgiotBus.topicKey(this.router,this.subtopic);var t={router:this.router,topic:this.subtopic,qos:2,ttl:108e5};this.$dgiotBus.$emit("MqttSubscribe",t),this.dialogVisible=!this.dialogVisible},queryDevice:function(){var e=this;return Object(i["a"])(s.a.mark((function t(){var a,n,r,i;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$baseColorfullLoading(),n={order:"-createdAt",keys:"objectId,name,devaddr",where:{product:e.queryForm.product?e.queryForm.product:{$ne:null,$exists:!0}}},t.next=5,Object(o["queryDevice"])(n);case 5:r=t.sent,i=r.results,a.close(),e.Device=i,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0),e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(t.t0),"error","vab-hey-message-error");case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()},handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageNo=e,this.fetchData()},fetchData:function(){return Object(i["a"])(s.a.mark((function e(){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}}},d=c,u=a("bdd7"),p=Object(u["a"])(d,n,r,!1,null,null,null);t["default"]=p.exports},4463:function(e,t,a){"use strict";a("0085")},"462f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dgiotKonva-container"},[a("div",{staticClass:"dgiotKonva-content"},[e._v(" "+e._s(e.infoData)+" ")])])},r=[],i={name:"DgiotRule",components:{},props:{objectId:{default:"",required:!0,type:String},code:{default:function(){},required:!0,type:Object}},data:function(){return{infoData:"dgiotKonva"}},computed:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{}},l=i,s=(a("4463"),a("bdd7")),o=Object(s["a"])(l,n,r,!1,null,"0a7ad87f",null);t["default"]=o.exports},"4e4c":function(e,t,a){},"5eec":function(e,t,a){"use strict";a("d1ce")},"5f98":function(e,t,a){(function(e){a("1c6f");var t=a("80b9"),n=a("cad9"),r=a("197e"),i=r.proxy,l=a("f526"),s=n.join(e,"../../../swagger.json");l.get("".concat(i[0].target,"/swagger.json"),(function(e){var a="";e.on("data",(function(e){a+=e})),e.on("end",(function(){t.writeFile(s,a,(function(e){if(e)return dgiotlog.log("Failed to crawl"+e);dgiotlog.log("File created swagger successfully, address："+s)}))}))})).on("error",(function(e){dgiotlog.log("Error: "+e.message)}))}).call(this,"/")},6124:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"data",attrs:{"label-width":"100px",model:e.data}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"small",type:"primary"},nativeOn:{click:function(t){return e.addparam.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.data.params}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.serialnumber"),prop:"order"}}),a("el-table-column",{attrs:{label:e.$translateTitle("deviceLog.identifier"),prop:"identifier"}}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.name"),prop:"name"}}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.Type"),prop:"type"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("el-button",{attrs:{plain:"",size:"mini",title:e.$translateTitle("task.Edit"),type:"info"},nativeOn:{click:function(t){return e.editRow(r,n)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),a("el-button",{attrs:{plain:"",size:"mini",title:e.$translateTitle("task.Delete"),type:"danger"},nativeOn:{click:function(t){return e.delRow(r)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitdata.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("application.submit"))+" ")]),a("el-button",{on:{click:function(t){e.dict_temp_dialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1),a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],ref:"param",attrs:{"append-to-body":"",size:"30%",title:e.title_param_dialog,visible:e.edit_param_dialog},on:{"update:visible":function(t){e.edit_param_dialog=t}}},[a("div",[a("el-form",{ref:"param",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:e.param,rules:e.rules,size:"mini","status-icon":""}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.serialnumber"),prop:"order"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:e.param.order,callback:function(t){e.$set(e.param,"order",t)},expression:"param.order"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[a("el-input",{model:{value:e.param.identifier,callback:function(t){e.$set(e.param,"identifier",t)},expression:"param.identifier"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.name"),prop:"name"}},[a("el-input",{model:{value:e.param.name,callback:function(t){e.$set(e.param,"name",t)},expression:"param.name"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("rule.Type"),prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.param.type,callback:function(t){e.$set(e.param,"type",t)},expression:"param.type"}},e._l(e.dictOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitparam("param")}}},[e._v(" "+e._s(e.$translateTitle("button.determine"))+" ")])],1)],1)],1)])],1)},r=[],i=a("fb07"),l=a("d0d7"),s=a.n(l),o=(a("e170"),{name:"DgiotDict",components:{},props:{objectId:{default:"",required:!0,type:String}},data:function(){return{data:{params:[]},param:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],identifier:[{required:!0,message:"请输入标识符",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]},title_param_dialog:"",edit_param_dialog:!1,height:this.$baseTableHeight(0)-50,activeName:"字典管理",infoData:"DgiotDict",dictOptions:["text","table","dynamicTable","image","string","boolean","number"],editIndexId:""}},computed:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{opendialog:function(e){var t=this;this.$nextTick((function(){t.$refs[e].clearValidate()}))},delRow:function(e){this.data.params.splice(e,1),this.saveDict()},editRow:function(e,t){this.editIndexId=e,this.title_param_dialog="修改字典数据",this.edit_param_dialog=!0,this.param=t},addparam:function(){this.editIndexId=void 0,this.title_param_dialog="新增字典数据",this.edit_param_dialog=!0,this.param={order:this.data.params.length+1,identifier:"",name:"",type:""}},submitparam:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(s.a.mark((function e(a){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a&&(void 0!=t.editIndexId?(t.data.params[t.editIndexId]=t.param,t.$message.success("编辑成功")):(t.data.params.push(t.param),t.$message.success("新增成功")),console.log("this.data",t.data),t.saveDict());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},saveDict:function(){this.$dgiotBus.$emit("saveDict",{id:this.objectId,data:{data:this.data}})}}}),c=o,d=(a("786f"),a("bdd7")),u=Object(d["a"])(c,n,r,!1,null,"3c673c98",null);t["default"]=u.exports},"61c81":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dgiot-doc"},[a("div",{staticClass:"dialog"},[a("doc-dialog",{ref:"DocDialog"})],1),a("a-row",[a("a-col",{attrs:{span:4}},[a("div",{staticClass:"dgiot-doc-tree"},[a("a-tree",{attrs:{"auto-expand-parent":!0,"block-node":!0,"default-expand-all":!0,"default-expanded-keys":e.selectedKeys,"default-selected-keys":e.selectedKeys,"show-icon":!0,"show-line":!0,"tree-data":e.docDetails},on:{click:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.objectId,r=t.name;return[a("a-dropdown",{attrs:{trigger:["contextmenu"]},scopedSlots:e._u([{key:"overlay",fn:function(){return[a("a-menu",{on:{click:function(t){var a=t.key;return e.onContextMenuClick(n,a)}}},[a("a-menu-item",{key:"child"},[e._v(" "+e._s(e.$translateTitle("article.New category"))+" ")]),a("a-menu-item",{key:"edit"},[e._v(" "+e._s(e.$translateTitle("article.edit category"))+" ")]),a("a-menu-item",{key:"delete"},[e._v(" "+e._s(e.$translateTitle("button.delete"))+" ")])],1)]},proxy:!0}],null,!0)},[a("span",[e._v(e._s(r))])])]}}])})],1)]),a("a-col",{attrs:{span:20}},[a("div",{staticClass:"text"},[a("vab-vditor",{ref:"vditor",attrs:{value:e.productDetail.data}})],1)])],1)],1)},r=[],i=a("fb07"),l=a("e97b"),s=a("d0d7"),o=a.n(s),c=(a("f1e1"),a("1d17"),a("98da"),a("a0e0"),a("3dec"),a("16b8"),a("d44d")),d=a("5880"),u=a("bb22"),p=a("ec86"),m={name:"DgiotDoc",components:Object(l["a"])({},Object(c["default"])(a("965e"))),data:function(){return{editId:"",collapsed:!1,productDetail:{},setKey:moment(new Date).valueOf()}},computed:{selectedKeys:{get:function(){return this.$store.state.global.selectedKeys},set:function(e){return this.setSelectedKeys(e)}},detailsId:function(){return this.$route.query.details},docDetails:{get:function(){return this.$store.state.global.docDetails||{}},set:function(e){return this.set_docDetails(e)}},articleId:function(){return this.$route.query.article}},mounted:function(){console.log(this.detailsId,this.articleId,this.selectedKeys,this.docDetails,"vuex "),this.getTree(this.$route.query),this.articleId&&this.getArticle(this.$route.query)},created:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){this.set_docDetails([]),this.setSelectedKeys([])},activated:function(){},methods:Object(l["a"])(Object(l["a"])({},Object(d["mapMutations"])({delVisitedRoute:"tabs/delVisitedRoute",setSelectedKeys:"global/setSelectedKeys",set_docDetails:"global/set_docDetails"})),{},{onContextMenuClick:function(e,t){switch(console.log(e,t),t){case"child":this.newCategory(t,e);break;case"edit":this.editId=e,this.editCategory(e);break;case"delete":this.deletDoc(e);break}console.log("treeKey: ".concat(e,", menuKey: ").concat(t))},editCategory:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(p["getArticle"])(e);case 2:n=a.sent,t.$refs.DocDialog.dialogFormVisible=!0,t.$refs.DocDialog.form=n,t.$refs.DocDialog.form.type="edit";case 6:case"end":return a.stop()}}),a)})))()},deletDoc:function(e){var t=this;this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(o.a.mark((function a(){var n;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.$baseColorfullLoading(),a.next=3,Object(p["delArticle"])(e);case 3:a.sent,t.$baseMessage(t.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){n.close(),t.getTree(t.$route.query)}),800);case 6:case"end":return a.stop()}}),a)}))))},init:function(){this.$refs.DocDialog.$refs.form.resetFields(),this.$refs.DocDialog.dialogFormVisible=!1,this.getTree(this.$route.query)},getTree:function(e){var t=this;return Object(i["a"])(o.a.mark((function e(){var a,n,r,i,l;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a='{"keys":["parent","name","data","projectId","order","category","data","Icon","desc"],"where":{"projectId":"LYjcKG3ysu"}}'.replace("LYjcKG3ysu",t.$route.query.details),n={class:"Article",filter:a,parent:"parent"},console.log(n.filter,"params"),e.next=5,Object(u["post_tree"])(n);case 5:r=e.sent,i=r.results,l=void 0===i?[]:i,t.docDetails=l;case 9:case"end":return e.stop()}}),e)})))()},getArticle:function(e){var t=this;return Object(i["a"])(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.$baseColorfullLoading(),e.next=4,Object(p["getArticle"])(t.articleId);case 4:n=e.sent,t.productDetail=n,console.log("productDetail",t.productDetail),t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),a.close(),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(e.t0),"error","vab-hey-message-error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},getSetting:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,l;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e,"params"),a.prev=1,n=t.$baseColorfullLoading(),a.next=5,Object(p["queryArticle"])({where:{parent:e.details}});case 5:r=a.sent,i=r.results,void 0===i?[]:i,l=_.merge(docDetails,t.docDetails),t.docDetails=l,t.setKey=moment(new Date).valueOf(),n.close(),t.init(),a.next=19;break;case 15:a.prev=15,a.t0=a["catch"](1),console.log(a.t0),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 19:case"end":return a.stop()}}),a,null,[[1,15]])})))()},onSelect:function(e,t){var a=this;console.log("da_title",t.dataRef),this.$nextTick((function(){a.$refs.DocDialog.form.category=t.category,a.$refs.DocDialog.form.type="add",a.$refs.DocDialog.form.projectId=a.detailsId,a.$refs.DocDialog.form.parent.objectId=t.dataRef.objectId}));var n=[];t.dataRef.children;n.push(t.eventKey),console.log(n,"keys"),this.setSelectedKeys(n),console.log(e,t,t.eventKey,this.productDetail);var r=this.$route.path,i={details:this.detailsId,article:t.dataRef.objectId};this.delVisitedRoute(r),console.log(r,i),this.$router.push({path:"/doc/details",query:i})},newCategory:function(e,t){var a=this;return Object(i["a"])(o.a.mark((function n(){var r,i;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.$refs.DocDialog.form={type:"",name:"",parent:{objectId:"article",__type:"Pointer",className:"Article"},data:"",order:0,category:"",Icon:"",desc:""},console.log(e,t),n.prev=2,r=a.$baseColorfullLoading(),n.next=6,Object(p["getArticle"])(t);case 6:i=n.sent,a.$refs.DocDialog.form.projectId=a.detailsId,a.$refs.DocDialog.key=moment(new Date).valueOf(),a.$refs.DocDialog.form.parent.objectId=i.objectId,a.$refs.DocDialog.form.category=i.category,a.$refs.DocDialog.form.type="add",console.log(a.$refs.DocDialog.form,"this.$refs.DocDialog.form"),a.$refs.DocDialog.dialogFormVisible=!0,r.close(),n.next=20;break;case 17:n.prev=17,n.t0=n["catch"](2),console.error(n.t0);case 20:case"end":return n.stop()}}),n,null,[[2,17]])})))()},createDoc:function(e,t){var a=this;"edit"==t.type&&this.putDoc(t),delete t.type,this.$refs.DocDialog.$refs["".concat(e)].validate(function(){var e=Object(i["a"])(o.a.mark((function e(n){var r,i,l,s,c;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=12;break}return r=a.$baseColorfullLoading(),i=t,e.next=5,Object(p["createArticle"])(i);case 5:l=e.sent,s=l.createdAt,c=void 0===s?"":s,r.close(),c.length&&a.init(),e.next=14;break;case 12:return console.log("error submit!!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},editDoc:function(e,t){var a=this;return Object(i["a"])(o.a.mark((function n(){return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a.$refs.DocDialog.$refs["".concat(e)].validate(function(){var e=Object(i["a"])(o.a.mark((function e(n){var r,i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=10;break}return r=a.$baseColorfullLoading(),i={category:t.category,ico:t.ico,name:t.name,order:t.order},e.next=5,Object(p["putArticle"])(t.objectId,i);case 5:e.sent,r.close(),setTimeout((function(){a.getTree(a.$route.query),a.init()}),800),e.next=12;break;case 10:return console.log("error submit!!"),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()},putDoc:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return delete e.createdAt,delete e.updatedAt,delete e.parent,delete e.objectId,delete e.createdAt,a.prev=5,n=t.$baseColorfullLoading(),a.next=9,Object(p["putArticle"])(t.editId,e);case 9:a.sent,t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),n.close(),a.next=18;break;case 14:a.prev=14,a.t0=a["catch"](5),console.log(a.t0),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 18:case"end":return a.stop()}}),a,null,[[5,14]])})))()}})},f=m,h=(a("e2e9"),a("bdd7")),g=Object(h["a"])(f,n,r,!1,null,"209484ab",null);t["default"]=g.exports},6257:function(e,t,a){},"67da":function(e,t,a){"use strict";a("dcc8")},"6c81":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"CloudFunction-container"},[a("div",{staticClass:"CloudFunction-content"},[e._v(" "+e._s(e.infoData)+" ")])])},r=[],i={name:"CloudFunction",components:{},data:function(){return{infoData:"CloudFunction"}},computed:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{}},l=i,s=(a("d141"),a("bdd7")),o=Object(s["a"])(l,n,r,!1,null,"1fd785ce",null);t["default"]=o.exports},"786f":function(e,t,a){"use strict";a("1262")},"7b37":function(t,a,n){"use strict";n.r(a);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resourcechannel resourcechannel-container"},[a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],attrs:{"append-to-body":"",size:"80%",visible:e.amisFlag},on:{"update:visible":function(t){e.amisFlag=t}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.amisFlag,expression:"amisFlag"}],staticClass:"wrapper"},[a("el-button",{attrs:{size:"mini",title:e.$translateTitle("konva.save"),type:"success"},nativeOn:{click:function(t){return e.saveAmis()}}},[e._v(" "+e._s(e.$translateTitle("konva.save"))+" ")]),a("el-button",{attrs:{size:"mini",type:"warning"},nativeOn:{click:function(t){e.isPreview=!e.isPreview}}},[e._v(" "+e._s(e.isPreview?e.$translateTitle("task.Edit"):e.$translateTitle("application.preview"))+" ")])],1),a("vab-amis",{directives:[{name:"show",rawName:"v-show",value:e.isPreview,expression:"isPreview"}],key:e.channelid,attrs:{schema:e.renderSchema,"show-help":!1}}),a("vab-amis-editor",{directives:[{name:"show",rawName:"v-show",value:!e.isPreview,expression:"!isPreview"}],ref:"vabAmis",attrs:{"amis-key":e.channelid,theme:"antd",value:e.amisJson},on:{onChange:e.onChange}})],1),a("vab-input",{ref:"uploadFinish",on:{fileInfo:e.fileInfo}}),a("div",{staticClass:"firsttable"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.channelformsearch,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("resource.name")},model:{value:e.channelformsearch.name,callback:function(t){e.$set(e.channelformsearch,"name",t)},expression:"channelformsearch.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.Get_Re_Channel(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addchanneltype.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.selectchannel"))+" ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.tableData,"header-cell-style":{"text-align":"center"},"row-class-name":e.getChannelEnable,"row-key":"objectId"}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber"),prop:"objectId","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype"),prop:"type","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[1==n.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):2==n.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("developer.missionchannel"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("websocket.port"),prop:"cType","show-overflow-tooltip":"",sortable:"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.config.port))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype"),prop:"cType","show-overflow-tooltip":"",sortable:"",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.cType))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelstatus"),prop:"status","show-overflow-tooltip":"",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["ONLINE"==n.status?a("span",{staticStyle:{color:"green"}},[e._v(" "+e._s(e.$translateTitle("product.online"))+" ")]):a("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.$translateTitle("product.offline"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.enable")+"/"+e.$translateTitle("developer.disable"),prop:"isEnable","show-overflow-tooltip":"",sortable:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{attrs:{content:n.isEnable?e.$translateTitle("developer.enable"):e.$translateTitle("developer.disable"),placement:"top"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.switchEnable(n.objectId,n.isEnable)}},model:{value:n.isEnable,callback:function(t){e.$set(n,"isEnable",t)},expression:"row.isEnable"}})],1)]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.describe"),prop:"objectId","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("product.view")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{on:{click:function(t){return e.viewDesign(n.data,n.objectId)}}},[e._v(" "+e._s(e.$translateTitle("product.view"))+" ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("el-button",{attrs:{disabled:"OFFLINE"==n.status,size:"mini",title:"ONLINE"==n.status?"":"请先启用通道",type:"success"},on:{click:function(t){return e.subProTopic(n)}}},[e._v(" "+e._s(e.$translateTitle("product.log"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editorChannel(n)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),a("el-popover",{ref:"popover-"+r,staticStyle:{"margin-left":"10px"},attrs:{placement:"top",width:"300"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.qdsczg"))+e._s(n.name)+e._s(e.$translateTitle("equipment.channel"))+" ")]),a("div",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){n._self.$refs["popover-"+r].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.deleteChannel(n,r)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)]}}])})],1),a("div",{staticClass:"elpagination"},[a("el-pagination",{key:e.length+"key"+e.total,attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[5,10,20,30,50],total:e.total},on:{"current-change":e.channelCurrentChange,"size-change":e.channelSizeChange}})],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,title:e.channelupdated+"通道",top:"10vh",visible:e.channelForm,width:"50%"},on:{"update:visible":function(t){e.channelForm=t}}},[a("el-form",{ref:"addchannel",attrs:{"label-width":"auto",model:e.addchannel,rules:e.addrules}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.channeltype"),prop:"region"}},[a("el-select",{attrs:{disabled:"",placeholder:e.$translateTitle("developer.channeltype")},on:{change:e.removeauto},model:{value:e.addchannel.region,callback:function(t){e.$set(e.addchannel,"region",t)},expression:"addchannel.region"}},e._l(e.channelregion,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title.zh,value:e.cType}})})),1),a("el-row",{staticStyle:{width:"100%","min-height":"0","max-height":"100px","margin-top":"20px","text-align":"center"},attrs:{gutter:24}},e._l(e.channelregion,(function(t,n){return a("el-col",{key:n,staticStyle:{cursor:"pointer"},attrs:{span:24}},[t.params.ico&&t.params.ico.default?a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.addchannel.region==t.cType,expression:"addchannel.region == item.cType"}],staticClass:"box-card",style:{display:e.addchannel.region==t.cType?"block":"none",color:e.addchannel.region==t.cType?"#00bad0":"#c0c4cc"},attrs:{shadow:e.addchannel.region==t.cType?"always":"hover",size:"mini"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.title.zh))]),a("el-button",{staticStyle:{float:"right"},attrs:{disabled:""!=e.resourceid,size:"mini",type:"success"},on:{click:function(a){return e.setCard(t.cType)}}},[e._v(" "+e._s(e.$translateTitle("product.selected"))+" ")])],1),a("div",{staticClass:"text item"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("img",{staticClass:"image",staticStyle:{width:"50px",height:"50px"},attrs:{src:t.params.ico.default?t.params.ico.default:""}})]),a("el-col",{attrs:{span:12}},[a("el-tag",[e._v(e._s(t.cType))])],1)],1)],1)]):e._e()],1)})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:e.$translateTitle("developer.channelname")},model:{value:e.addchannel.name,callback:function(t){e.$set(e.addchannel,"name",t)},expression:"addchannel.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationtype"),prop:"applicationtText"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.pleaseselectyourapp"),readonly:""},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.addchannel.applicationtText,callback:function(t){e.$set(e.addchannel,"applicationtText",t)},expression:"addchannel.applicationtText"}}),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.title.zh,prop:t.showname,required:t.required}},[a("el-tooltip",{attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(t.description.zh)+" ")]),a("i",{staticClass:"el-icon-question",staticStyle:{float:"left"}})]),"string"==t.type?a("el-input",{directives:[{name:"show",rawName:"v-show",value:"通道ICO"!==t.title.zh,expression:"item.title.zh !== '通道ICO'"}],staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}}):e._e(),"通道ICO"==t.title.zh?a("el-input",{directives:[{name:"show",rawName:"v-show",value:"通道ICO"==t.title.zh,expression:"item.title.zh == '通道ICO'"}],staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-upload"},on:{click:function(a){return e.uploadCkick(e.addchannel[t.showname],n,"arrlist")}},slot:"append"})],1):"integer"==t.type?a("el-input",{staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}}):"boolean"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},[a("el-option",{attrs:{label:e.$translateTitle("product.yes"),value:!0}}),a("el-option",{attrs:{label:e.$translateTitle("product.no"),value:!1}})],1):"enum"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},e._l(t.enum,(function(e,n){return a("el-option",{key:n,attrs:{label:t.enum[n],value:t.enum[n]}})})),1):e._e()],1)],1)})),a("div",{staticClass:"row-bg"},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{autocomplete:"off",placeholder:e.$translateTitle("developer.describe"),rows:3,type:"textarea"},on:{change:e.inputChange},model:{value:e.addchannel.desc,callback:function(t){e.$set(e.addchannel,"desc",t)},expression:"addchannel.desc"}})],1)],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-right":"20px"},on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addchannelForm("addchannel")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("equipment.channeldetails"),visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[e._v("ID:")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(e.resourceid)+" ")])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Resource Type:")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(e.resoucetype)+" ")])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Description:")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(e.description)+" ")])],1),e._l(e.detailchannel,(function(t,n){return a("el-row",{key:t},[a("el-col",{attrs:{span:12}},[e._v(" "+e._s(n)+" ")]),a("el-col",{attrs:{span:12}},[e._v(" "+e._s(t)+" ")])],1)}))],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),a("a-drawer",{attrs:{"append-to-body":!0,placement:"right",title:e.channelname+"日志",visible:e.subdialog,width:"80%"},on:{close:function(t){return e.handleCloseSubdialog(e.pubtopic)}}},[a("mqtt-log",{attrs:{"channel-id":e.channelname,list:e.msgList,msg:e.submessage,product:e.channelInfo,"refresh-key":e.refreshFlag}})],1),a("el-dialog",{attrs:{"custom-class":"dgiot_dialog","show-close":!1,visible:e.channelDialog,width:"50%"},on:{"update:visible":function(t){e.channelDialog=t}}},[a("vab-query-form",[a("vab-query-form-left-panel",{attrs:{span:12}},[a("el-button",{attrs:{disabled:!e.selectedData.length,type:"danger"},on:{click:function(t){return e.handleDelete(e.channelInfo)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.batch deletion"))+" ")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.channelInfo,height:"60vh",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"index"}}),a("el-table-column",{attrs:{type:"selection",width:"50"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.channelname"),prop:"name","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.servicetype"),prop:"devType","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe"),prop:"desc","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),prop:"objectId","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteRelation(e.channelInfo,n.objectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.remove"))+" ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,layout:e.pagination.layout,"page-size":e.pagination.size,"page-sizes":e.pagination.sizes,total:e.pagination.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)},i=[],l=n("fb07"),s=n("e97b"),o=(n("3dec"),n("9c6a"),n("e170"),n("79da"),n("16b8"),n("4656"),n("1d17"),n("37c6"),n("c4bc"),n("80ab"),n("a98c"),n("fc3d"),n("04d6"),n("4c87"),n("d0d7")),c=n.n(o),d=n("d44d"),u=n("89e8"),p=n("7212"),m=n("5da9"),f=n("bb22"),h=n("1b07"),g=n("5880"),b=n("67aa"),v=n.n(b),y=n("8b42"),w=(n("8ba7"),Object(s["a"])(Object(s["a"])({components:Object(s["a"])({VabInput:y["default"]},Object(d["default"])(n("0b72"))),data:function(){return{amisFlag:!1,isPreview:!0,renderSchema:{},amisJson:{},selectedData:[],pagination:{currentPage:4,sizes:[10,20,30,50,100],size:10,layout:"total, sizes, prev, pager, next, jumper",total:0,pageNo:1,pageSize:20,searchDate:[],limit:10,skip:0,order:"-createdAt",keys:"count(*)"},channelid:"",channelInfo:[],channelDialog:!1,router:"",topotopic:"",refreshFlag:"99",msgList:[],submessage:"",subtopic:"",pubtopic:"",channeindex:0,channeType:"",listLoading:!1,dialogVisible:!1,isopen:"suo",pwdType:"password",tableData:[],channelForm:!1,channelupdated:"新增",activeName:"first",channelformsearch:{name:""},channelregion:[],addchannel:{region:"",desc:"",applicationtText:""},applicationList:[],addrules:{applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]},length:10,start:0,total:0,selectregion:{},resourceid:"",resoucetype:"",description:"",detailchannel:"",subdialog:!1,value4:"",subdialogid:"",subdialogtimer:null,channelname:"",arrlist:[],channelId:"",channelrow:[],showTree:!1,topicKey:"",allApps:[],defaultProps:{children:"children",label:"label"}}}},Object(g["mapGetters"])({roleTree:"user/roleTree"})),{},{watch:{topicKey:{handler:function(e,t){var a=this;console.log("newVal topicKey",e),console.log("oldval topicKey",t);var n=this;e&&(this.$dgiotBus.$off(e),this.$dgiotBus.$on(e,(function(e){console.error(e);var t=e.payload;a.mqttMsg(t)}))),t&&(n.submessage="",n.msgList=[],n.logKey="99")},deep:!0,limit:!0}},mounted:function(){this.router=this.$dgiotBus.router(this.$route.fullPath),this.Get_Re_Channel(0),this.dialogType(),this.getApplication()},methods:{saveAmis:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a,n;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$baseColorfullLoading(),n={data:e.$refs["vabAmis"].getSchema()},t.next=5,Object(u["putChannel"])(e.channelid,n);case 5:t.sent,e.$baseMessage(e.$translateTitle("user.update completed"),"success","vab-hey-message-success"),a.close(),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0),e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(t.t0),"error","vab-hey-message-error");case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},viewDesign:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;this.renderSchema=t,this.amisFlag=!0,console.log(this.renderSchema,e),this.$refs["vabAmis"].setSchema(t),this.channelid=a},onChange:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$refs["vabAmis"].setSchema(e),t.renderSchema=e,t.amisJson=e,console.log(t.renderSchema,e);case 4:case"end":return a.stop()}}),a)})))()},handleSelectionChange:function(e){this.selectedData=e},handleDelete:function(e){var t=this;this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(l["a"])(c.a.mark((function a(){var n;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=t.selectedData,n&&n.forEach((function(t,a){e.forEach((function(a,n){t===a&&e.splice(n,1)}))}));case 2:case"end":return a.stop()}}),a)}))))},deleteRelation:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function e(){var n,r,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n={product:{__op:"RemoveRelation",objects:[{__type:"Pointer",className:"Product",objectId:t}]}},r=a.$baseColorfullLoading(),e.next=5,Object(u["saveChanne"])(a.channelid,n);case 5:i=e.sent,console.log(i),a.$baseMessage(a.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),r.close(),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0),a.$baseMessage(a.$translateTitle("alert.Data request error")+"".concat(e.t0),"error","vab-hey-message-error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},handleSizeChange:function(){return Object(l["a"])(c.a.mark((function e(){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},handleCurrentChange:function(){return Object(l["a"])(c.a.mark((function e(){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},productinformation:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){var n,r,i,l,s,o,d;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.channelid=e,n=t.$baseLoading(3),a.prev=2,r={limit:t.pagination.limit,order:t.pagination.order,skip:t.pagination.skip,keys:t.pagination.keys,where:{$relatedTo:{object:{__type:"Pointer",className:"Channel",objectId:e},key:"product"}}},a.next=6,Object(p["queryProduct"])(r);case 6:i=a.sent,l=i.results,s=void 0===l?[]:l,o=i.count,d=void 0===o?0:o,n.close(),t.pagination.total=d,t.channelInfo=s,a.next=21;break;case 16:a.prev=16,a.t0=a["catch"](2),console.log(a.t0),n.close(),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 21:case"end":return a.stop()}}),a,null,[[2,16]])})))()},uploadCkick:function(e,t,a){console.log(e,t),this.channeindex=t,this.channeType=a,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click"))},fileInfo:function(e){console.log("uploadFinish",e),"arrlist"==this.channeType?(this.arrlist[this.channeindex].default=e.url,console.log(this.arrlist[this.channeindex])):this.channelregion[this.channeindex].params.ico.default=e.url},addchannelForm:function(e){var t=this;this.resourceid?this.editChannel(this.resourceid,e):this.$refs[e].validate((function(e){if(e&&t.addchannel.applicationtText){var a={};for(var n in t.addchannel)a[n]=t.addchannel[n];delete a.region,delete a.desc,delete a.type,delete a.isEnable,delete a.name;var r="role:"+t.addchannel.applicationtText,i={};i[r]={read:!0,write:!0};var l={ACL:i,config:a,name:t.addchannel.name,cType:t.addchannel.region,desc:t.addchannel.desc,isEnable:!1,status:"OFFLINE",type:t.addchannel.type.toString()};t.addchannelaxios(l)}else t.$message("有必填项未填")}))},addchannelaxios:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(u["postChannel"])(e).then((function(e){e&&(t.$message({type:"success",message:"编辑"==t.channelupdated?"编辑成功":"创建成功"}),t.$refs["addchannel"].resetFields(),t.addchannel={},t.channelForm=!1,t.resourceid="")}));case 2:case"end":return a.stop()}}),a)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.$set(this.addchannel,"applicationtText",e.name)},inputChange:function(e){console.log(e)},validUrl:function(e,t,a){var n=/^[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/;n.test(t)?a():a(new Error("需要输入正确的url"))},validPort:function(e,t,a){var n=/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;n.test(t)?a():a(new Error("需要输入正确的端口号"))},Get_Re_Channel:function(){var e=arguments,t=this;return Object(l["a"])(c.a.mark((function a(){var n,r,i,l,s;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:0,t.listLoading=!0,t.tableData=[],0==n&&(t.start=0),r={count:"objectId",skip:t.start,limit:t.length,order:"-createdAt",keys:"count(*)",where:{name:t.channelformsearch.name.length?{$regex:t.channelformsearch.name}:{$ne:null}}},a.next=7,Object(u["queryChannel"])(r);case 7:i=a.sent,l=i.count,s=i.results,t.total=l,t.tableData=s,t.listLoading=!1;case 13:case"end":return a.stop()}}),a)})))()},getApplication:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a,n,r;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={limit:100},t.next=3,Object(m["queryRole"])(a);case 3:n=t.sent,r=n.results,r.map((function(t){var a={};a.id=t.id,a.name=t.desc,e.applicationList.push(a)}));case 6:case"end":return t.stop()}}),t)})))()},dialogType:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(h["resourceTypes"])();case 3:a=t.sent,a.forEach((function(e){e.params.ico||(e.params.ico={title:{en:"channel ICO",zh:"通道ICO"},description:{en:"channel ICO",zh:"通道ICO"},default:v.a})})),e.channelregion=a;case 6:case"end":return t.stop()}}),t)})))()},switchEnable:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function n(){var r,i;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=t?"enable":"disable",n.prev=1,n.next=4,Object(f["subupadte"])(e,t);case 4:r=n.sent,i=r.updatedAt,console.log(i),i&&(a.$message.success(a.$translateTitle("developer.".concat(t))+""+a.$translateTitle("node.success")),a.Get_Re_Channel(a.start)),n.next=14;break;case 10:n.prev=10,n.t0=n["catch"](1),console.log(n.t0),a.$message.error("".concat(n.t0));case 14:case"end":return n.stop()}}),n,null,[[1,10]])})))()},updateChannel:function(e){this.dialogVisible=!0,this.resourceid=e.objectId,this.detailchannel=e.config,this.resoucetype=e.cType,this.description=e.desc},editChannel:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function t(){var n,r,i,l;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r in n={},a.addchannel)n[r]=a.addchannel[r];return delete n.region,delete n.desc,delete n.type,delete n.isEnable,delete n.name,i={config:n,name:a.addchannel.name,cType:a.addchannel.region,desc:a.addchannel.desc},t.next=10,Object(u["putChannel"])(e,i);case 10:l=t.sent,l.updatedAt&&(a.$message({type:"success",message:"编辑成功"}),a.$refs["addchannel"].resetFields(),a.addchannel={},a.channelForm=!1,a.resourceid="",a.Get_Re_Channel(a.start));case 12:case"end":return t.stop()}}),t)})))()},deleteChannel:function(e,t){this.delchannelaxios(e,t)},delchannelaxios:function(e,t){var a=this;Object(u["delChannel"])(e.objectId).then((function(n){a.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(t)].doClose(),a.Get_Re_Channel(a.start)})).catch((function(e){console.log(e.error),a.Get_Re_Channel(a.start)}))},addchanneltype:function(){this.$router.push({path:"/Createchannel",query:{type:"create"}})},handleClose:function(){this.addchannel={},this.channelForm=!1,this.$refs["addchannel"].resetFields(),this.resourceid=""},getChannelEnable:function(e,t){return 1==e.row.isEnable?"green_active":"red_active"},channelSizeChange:function(e){this.length=e,this.Get_Re_Channel(1)},channelCurrentChange:function(e){e<=1&&(this.total=0),console.log(e),this.start=(e-1)*this.length,this.Get_Re_Channel(1)},arrSort:function(e,t){var a=e.order,n=t.order;return a<n?-1:a>n?1:0},orderObject:function(e){var t=[];for(var a in e)e[a].showname=a,t.push(e[a]);return t.sort(this.arrSort)},setCard:function(e){this.removeauto(e)},removeauto:function(e){var t=this,a={},n={applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]};if(""==this.resourceid?this.channelregion.map((function(r){r.cType==e&&(t.$forceUpdate(),t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(e){e.default?a[e.showname]=e.default:a[e.showname]="",e.required&&("string"==e.type||"integer"==e.type?n[e.showname]=[{required:!0,trigger:"blur"}]:n[e.showname]=[{required:!0,trigger:"change"}])})),a.region=e,a.desc="",a.name="",a.type=t.selectregion.type,a.isEnable=!1)})):this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.$forceUpdate(),t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(r){for(var i in t.channelrow.config)r.showname==i&&(a[r.showname]=t.channelrow.config[i]),r.required&&("string"==r.type||"integer"==r.type?n[r.showname]=[{required:!0,trigger:"blur"}]:n[r.showname]=[{required:!0,trigger:"change"}]),a.region=e,a.desc=t.channelrow.desc,a.name=t.channelrow.name,a.type=t.selectregion.type,a.isEnable=t.channelrow.isEnable})))})),this.channelrow)for(var r in this.channelrow.ACL)a.applicationtText=r?r.substr(5):"";this.addchannel=a,this.addchannel.region=e,this.addrules=n},editorChannel:function(e){console.log(e),this.channelrow=e,this.resourceid=e.objectId,this.channelForm=!0,this.channelupdated="编辑",this.removeauto(e.cType)},nowtime:function(){var e=Date.parse(new Date),t=new Date(e),a=(t.getFullYear(),t.getMonth()+1<=10?t.getMonth():t.getMonth(),t.getDate()+1<=10?t.getDate():t.getDate(),(t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":"),n=(t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":",r=t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds();return a+n+r+" "},mqttMsg:function(e){this.msgList.push({timestamp:moment().format("x"),msg:e}),this.refreshFlag=moment().format("x"),this.submessage+=e+"\n"},subProTopic:function(e){var t=this;this.productinformation(e.objectId),this.subdialog=!0,this.subdialogid=e.objectId,this.channelname=e.objectId,this.subtopic="log/channel/"+e.objectId+"/#",this.submessage="",this.msgList=[];var a={router:this.router,topic:this.subtopic,qos:2,ttl:108e5};this.$dgiotBus.$emit("MqttSubscribe",a),this.topicKey=this.$dgiotBus.topicKey(this.router,this.subtopic),this.pubtopic="channel/"+e.objectId,setTimeout((function(){t.$dgiotBus.$emit("MqttPublish",t.pubtopic,JSON.stringify({action:"start_logger"}),0,!1),t.refreshFlag=t.subtopic.split("log")[1]}),500)},handleCloseSubdialog:function(e){this.$dgiotBus.$emit("MqttPublish",e,JSON.stringify({action:"stop_logger"}),0,!1),this.refreshFlag=moment().format("x"),this.submessage="",this.msgList=[],this.subdialog=!this.subdialog}}})),_=w,$=(n("67da"),n("14f5"),n("cee0"),n("bdd7")),k=Object($["a"])(_,r,i,!1,null,"0310e600",null);a["default"]=k.exports},8489:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dgiot-doc custom-table-container"},[a("div",{staticClass:"dialog"},[a("doc-dialog",{ref:"DocDialog"})],1),a("div",{staticClass:"dgiot-doc-header"},[a("vab-query-form",[a("vab-query-form-left-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("product.title")},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:e.queryDoc}},[e._v(" "+e._s(e.$translateTitle("concentrator.search"))+" ")]),a("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.newCategory("add")}}},[e._v(" "+e._s(e.$translateTitle("article.New category"))+" ")])],1)],1)],1)],1)],1),a("div",{staticClass:"dgiot-doc-center"},[a("a-row",{staticClass:"dgiot-doc-center-row",attrs:{gutter:24}},e._l(e.HomePageForDetails,(function(t){return a("a-col",{key:t.objectId,staticClass:"dgiot-doc-center-row-antdcol",attrs:{lg:8,md:8,sm:12,span:6,xl:6,xs:24,xxl:4.5}},[a("a-card",{staticClass:"dgiot-doc-center-row-antdcol-card ant-card-bordered",attrs:{bordered:!1,hoverable:"",title:t.name}},[a("el-image",{attrs:{slot:"cover",alt:t.ico,src:t.ico},slot:"cover"},[a("div",{staticClass:"block image-slot",attrs:{slot:"error"},slot:"error"},[a("vab-empty",{attrs:{height:"100px",width:"100"}})],1)]),a("template",{staticClass:"ant-card-actions",slot:"actions"},[a("a-icon",{key:"edit",attrs:{type:"edit"},on:{click:function(a){return e.newCategory("edit",t)}}}),a("a-icon",{key:"delete",attrs:{type:"delete"},on:{click:function(a){return e.deletDoc(t)}}})],1),a("el-button",{attrs:{type:"success"},nativeOn:{click:function(a){return e.goChild(t)}}},[e._v(" "+e._s(e.$translateTitle("article.view"))+" ")])],2)],1)})),1),a("el-empty",{directives:[{name:"show",rawName:"v-show",value:0==e.HomePageForDetails.length,expression:"HomePageForDetails.length == 0"}],attrs:{"image-size":200}})],1)])},r=[],i=a("fb07"),l=a("e97b"),s=(a("16b8"),a("f764"),a("5662"),a("d0d7")),o=a.n(s),c=a("ed08"),d=a("d44d"),u=a("ec86"),p={name:"DgiotDoc",components:Object(l["a"])({},Object(d["default"])(a("965e"))),data:function(){return{iconStyle:{width:"22px",height:"22px"},queryForm:{name:""},HomePageForDetails:{},settingDetails:{}}},computed:{},mounted:function(){},created:function(){this.queryDoc()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{init:function(){this.$refs.DocDialog.$refs.form.resetFields(),this.$refs.DocDialog.dialogFormVisible=!1,this.queryDoc()},newCategory:function(e,t){this.$refs.DocDialog.dialogFormVisible=!0,t&&(this.$refs.DocDialog.form=t),this.$refs.DocDialog.form.type=e},deletDoc:function(e){var t=this;this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(o.a.mark((function a(){var n;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.$baseColorfullLoading(),a.next=3,Object(u["delArticle"])(e.objectId);case 3:a.sent,n.close(),t.$baseMessage(t.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){t.queryDoc()}),1200);case 7:case"end":return a.stop()}}),a)}))))},queryDoc:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a,n,r,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.HomePageForDetails=[],t.prev=1,a=e.$baseColorfullLoading(),t.next=5,Object(u["queryArticle"])({where:{parent:"article",name:e.queryForm.name.length?{$regex:e.queryForm.name}:{$ne:null}}});case 5:n=t.sent,r=n.results,i=void 0===r?[]:r,e.HomePageForDetails=i,a.close(),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),console.log(t.t0),e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(t.t0),"error","vab-hey-message-error");case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()},createDoc:function(e,t){var a=this;delete t.type,t.parent.objectId.includes("article")&&(t.projectId="pid_".concat(Object(c["uuid"])(6))),this.$refs.DocDialog.$refs["".concat(e)].validate(function(){var e=Object(i["a"])(o.a.mark((function e(n){var r,i,l,s,c;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=12;break}return r=a.$baseColorfullLoading(),i=t,e.next=5,Object(u["createArticle"])(i);case 5:l=e.sent,s=l.createdAt,c=void 0===s?"":s,r.close(),c.length&&a.init(),e.next=14;break;case 12:return console.log("error submit!!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},editDoc:function(e,t){var a=this;return Object(i["a"])(o.a.mark((function n(){return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a.$refs.DocDialog.$refs["".concat(e)].validate(function(){var e=Object(i["a"])(o.a.mark((function e(n){var r,i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=10;break}return r=a.$baseColorfullLoading(),i={category:t.category,ico:t.ico,name:t.name,order:t.order},e.next=5,Object(u["putArticle"])(t.objectId,i);case 5:e.sent,r.close(),setTimeout((function(){a.init()}),800),e.next=12;break;case 10:return console.log("error submit!!"),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()},goChild:function(e){console.log(e),this.$router.push({path:"/doc/details",query:{details:e.projectId}})}}},m=p,f=(a("b012"),a("bdd7")),h=Object(f["a"])(m,n,r,!1,null,"3c171294",null);t["default"]=h.exports},"855a":function(e,t,a){},9140:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index-container"},[a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],ref:"dgiotDict",attrs:{"append-to-body":"",size:"50%",title:"字典",visible:e.dictFlag},on:{"update:visible":function(t){e.dictFlag=t}}},[a("dgiot-dict",{attrs:{"object-id":e.dictId}})],1),a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],ref:"dgiotWord",attrs:{"append-to-body":"",size:"50%",visible:e.wordFlag},on:{"update:visible":function(t){e.wordFlag=t}}},[a("dgiot-word",{attrs:{data:e.data,"object-id":e.dictId}})],1)],1)},r=[],i=a("fb07"),l=a("e97b"),s=a("d0d7"),o=a.n(s),c=(a("f764"),a("6124")),d=a("462f"),u=a("ce0f"),p=a("5880"),m={name:"Index",components:{dgiotDict:c["default"],dgiotRule:d["default"],dgiotWord:u["default"]},data:function(){return{data:{},dictId:"",infoData:"index",dictFlag:!1,wordFlag:!1,ruleFlag:!1}},mounted:function(){var e=this;this.$dgiotBus.$off("dictDesign"),this.$dgiotBus.$on("dictDesign",(function(t){var a=["dict","word","rule"],n=t.type,r=t.data,i=t.objectId;a.includes(n)?e.designDict(n,i,r):e.$message.error("暂不支持该类型低代码设计")}))},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:Object(l["a"])(Object(l["a"])({},Object(p["mapMutations"])({set_dictJson:"dict/set_dictJson"})),{},{designDict:function(e,t,a){var n=this;return Object(i["a"])(o.a.mark((function r(){return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n.dictId=t,n.data=a,console.log("data",a),console.log("objectId",t),console.log("type",e),r.t0=e,r.next="word"===r.t0?8:"dict"===r.t0?12:"rule"===r.t0?16:20;break;case 8:return n.wordFlag=!0,n.dictFlag=!1,n.ruleFlag=!1,r.abrupt("break",20);case 12:return n.dictFlag=!0,n.wordFlag=!1,n.ruleFlag=!1,r.abrupt("break",20);case 16:return n.ruleFlag=!0,n.dictFlag=!1,n.wordFlag=!1,r.abrupt("break",20);case 20:case"end":return r.stop()}}),r)})))()}})},f=m,h=(a("42fb"),a("bdd7")),g=Object(h["a"])(f,n,r,!1,null,"4cff2234",null);t["default"]=g.exports},"928c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dict dict-container"},[a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.title_dict_dialog,visible:e.add_dict_dialog,width:"40%"},on:{"update:visible":function(t){e.add_dict_dialog=t},open:function(t){return e.opendialog("dictForm")}}},[a("el-form",{ref:"dictForm",staticClass:"dict_type",attrs:{"label-width":"135px",model:e.addDictForm,rules:e.rules1,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionarytype"),prop:"templateId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:""!=e.editDictId,placeholder:e.$translateTitle("task.Select")},on:{change:e.selectChange},model:{value:e.addDictForm.templateId,callback:function(t){e.$set(e.addDictForm,"templateId",t)},expression:"addDictForm.templateId"}},e._l(e.dictRecord,(function(e){return a("el-option",{key:e.objectId,attrs:{disabled:"ALL"==e.data.name,label:e.data.name,value:e.objectId}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionaryname"),prop:"key",title:e.$translateTitle("developer.dictionaryuniqueID")}},[a("el-input",{attrs:{disabled:""!=e.editDictId},model:{value:e.addDictForm.key,callback:function(t){e.$set(e.addDictForm,"key",t)},expression:"addDictForm.key"}})],1)],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.title.zh,prop:t.name,required:t.required}},["Boolean"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"100%"},attrs:{readonly:""},model:{value:e.addDictForm[t.name],callback:function(a){e.$set(e.addDictForm,t.name,a)},expression:"addDictForm[item.name]"}},[a("el-option",{attrs:{label:e.$translateTitle("product.yes"),value:!0}}),a("el-option",{attrs:{label:e.$translateTitle("product.no"),value:!1}})],1):a("el-input",{model:{value:e.addDictForm[t.name],callback:function(a){e.$set(e.addDictForm,t.name,a)},expression:"addDictForm[item.name]"}})],1)],1)})),a("el-col",{staticStyle:{"z-index":"99999"},attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationtype"),rules1:[{required:!0,message:e.$translateTitle("product.pleaseselectyourapp"),trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.pleaseselectyourapp"),readonly:""},model:{value:e.addDictForm.applicationtText,callback:function(t){e.$set(e.addDictForm,"applicationtText",t)},expression:"addDictForm.applicationtText"}},[a("template",{slot:"append"},[a("i",{class:[e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{cursor:"pointer"},on:{click:function(t){e.showTree=!e.showTree}}})])],2),e.showTree?a("div",{staticClass:"device-tree"},[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1)],1),a("el-col",{staticStyle:{height:"47px"},attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.state"),prop:"enable"}},[a("el-radio",{attrs:{border:"",label:"1"},model:{value:e.addDictForm.enable,callback:function(t){e.$set(e.addDictForm,"enable",t)},expression:"addDictForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]),a("el-radio",{attrs:{border:"",label:"2"},model:{value:e.addDictForm.enable,callback:function(t){e.$set(e.addDictForm,"enable",t)},expression:"addDictForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.scrap"))+" ")])],1)],1)],2),a("el-form-item",{attrs:{label:e.$translateTitle("user.Remarks")}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},placeholder:e.$translateTitle("concentrator.input"),type:"textarea"},model:{value:e.addDictForm.description,callback:function(t){e.$set(e.addDictForm,"description",t)},expression:"addDictForm.description"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{"label-width":"0px",size:"mini"}},[e.editDictId?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("dictForm")}}},[e._v(" "+e._s(e.$translateTitle("product.modify"))+" ")]):a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.onSubmit("dictForm")}}},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")]),a("el-button",{on:{click:function(t){e.add_dict_dialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1)],1),a("a-drawer",{attrs:{"close-on-click-modal":!1,title:e.title_temp_dialog,visible:e.dict_temp_dialog,width:"60%"},on:{close:function(t){e.dict_temp_dialog=!e.dict_temp_dialog},open:function(t){return e.opendialog("dictTempForm")}}},[a("el-form",{ref:"dictTempForm",attrs:{model:e.dictTempForm,rules:e.rules,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionarytemplatename"),"label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.name,callback:function(t){e.$set(e.dictTempForm,"name",t)},expression:"dictTempForm.name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionarytemplatetype"),"label-width":e.formLabelWidth,prop:"cType"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.cType,callback:function(t){e.$set(e.dictTempForm,"cType",t)},expression:"dictTempForm.cType"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionarytemplatestatus"),"label-width":e.formLabelWidth,prop:"enable"}},[a("el-radio",{attrs:{border:"",label:"1"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]),a("el-radio",{attrs:{border:"",label:"0"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")])],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionarytemplatedata"),"label-width":e.formLabelWidth}},[a("el-tabs",{model:{value:e.elactiveName,callback:function(t){e.elactiveName=t},expression:"elactiveName"}},[a("el-tab-pane",{attrs:{label:"Table",name:"Table"}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"small",type:"primary"},nativeOn:{click:function(t){return e.addRow(e.dictTempForm.params)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.dictTempForm.params}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.name"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.Type"),prop:"type","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.serialnumber"),prop:"order","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.defaultvalue"),prop:"default","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[1==n.default&&"Boolean"==n.type?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):0==n.default&&"Boolean"==n.type?a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")]):"Number"==n.type?a("span",[e._v(" "+e._s(n.default)+" ")]):a("span",[e._v(e._s(n.default))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.isitrequired"),prop:"required","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.required?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.chinesetitle"),prop:"description","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.title.zh)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.englishtitle"),prop:"description","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.title.en)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.chinesedescription"),prop:"description","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.description.zh)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.englishdescription"),prop:"description","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.description.en)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("task.Operation"),"min-width":"220",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;var n=t.$index;return[a("el-button",{attrs:{plain:"",size:"mini",title:e.$translateTitle("task.Delete"),type:"danger"},nativeOn:{click:function(t){return e.delRow(n,e.dictTempForm.params)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")]),a("el-button",{attrs:{plain:"",size:"mini",title:e.$translateTitle("task.Edit"),type:"info"},nativeOn:{click:function(t){return e.editRow(n,e.dictTempForm.params)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"Json",name:"Json"}},[a("vab-json-editor",{attrs:{lang:"zh",mode:"code"},on:{"has-error":e.onError,"json-change":e.onJsonChange},model:{value:e.dictTempForm.params,callback:function(t){e.$set(e.dictTempForm,"params",t)},expression:"dictTempForm.params"}})],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),"label-width":e.formLabelWidth}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},placeholder:e.$translateTitle("developer.Pleaseenteradescription"),type:"textarea"},model:{value:e.dictTempForm.description,callback:function(t){e.$set(e.dictTempForm,"description",t)},expression:"dictTempForm.description"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.onJsonSave("dictTempForm")}}},[e._v(" "+e._s(e.$translateTitle("application.submit"))+" ")]),a("el-button",{on:{click:function(t){e.dict_temp_dialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,size:"mini",title:e.title_dict_edit_dialog,visible:e.edit_dict_temp_dialog},on:{"update:visible":function(t){e.edit_dict_temp_dialog=t},open:function(t){return e.opendialog("tempparams")}}},[a("el-form",{ref:"tempparams",staticClass:"demo-ruleForm",attrs:{"label-width":"70px",model:e.tempparams,size:"mini","status-icon":""}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.name"),"label-width":"50px",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.name,callback:function(t){e.$set(e.tempparams,"name",t)},expression:"tempparams.name"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:e.$translateTitle("rule.Type"),"label-width":"50px",prop:"type"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.tempTypeChange},model:{value:e.tempparams.type,callback:function(t){e.$set(e.tempparams,"type",t)},expression:"tempparams.type"}},e._l(e.dictOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.serialnumber"),"label-width":"50px",prop:"order"}},[a("el-input",{model:{value:e.tempparams.order,callback:function(t){e.$set(e.tempparams,"order",e._n(t))},expression:"tempparams.order"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.mustfill"),"label-width":"50px"}},[a("el-radio",{attrs:{border:"",label:!0},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]),a("el-radio",{attrs:{border:"",label:!1},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.chinesetitle"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.title.zh,callback:function(t){e.$set(e.tempparams.title,"zh",t)},expression:"tempparams.title.zh"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.englishtitle"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.title.en,callback:function(t){e.$set(e.tempparams.title,"en",t)},expression:"tempparams.title.en"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("equipment.defaultvalue"),prop:"default"}},["Boolean"==e.tempparams.type?a("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}},[a("el-option",{attrs:{label:e.$translateTitle("product.yes"),value:!0}}),a("el-option",{attrs:{label:e.$translateTitle("product.no"),value:!1}})],1):"Number"==e.tempparams.type?a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",e._n(t))},expression:"tempparams.default"}}):a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.chinesedescription"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.description.zh,callback:function(t){e.$set(e.tempparams.description,"zh",t)},expression:"tempparams.description.zh"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.englishdescription"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.description.en,callback:function(t){e.$set(e.tempparams.description,"en",t)},expression:"tempparams.description.en"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitFormTempDict()}}},[e._v(" "+e._s(e.$translateTitle("application.submit"))+" ")])],1)],1)],1)],1),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("developer.dictionarytemplatemanagement"),name:"字典模板管理"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$translateTitle("developer.pleaseenterdictionarytemplatename"),size:"mini"},model:{value:e.search_dict,callback:function(t){e.search_dict=t},expression:"search_dict"}}),a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:function(t){return e.searchDict(e.search_dict)}}},[e._v(" "+e._s(e.$translateTitle("task.Search"))+" ")]),a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:e.createDictTemp}},[e._v(" "+e._s(e.$translateTitle("developer.createdictionarytemplate"))+" ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.dictRecord,"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.indexes"),type:"index",width:"auto"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatenumber"),"show-overflow-tooltip":"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.objectId)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatename"),"show-overflow-tooltip":"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.name)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatetype"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.cType)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatestatus"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["1"==n.data.enable?a("el-tag",{attrs:{type:"success"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-tag",{attrs:{type:"warning"}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.description)+" ")]}}])}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("task.Operation"),"min-width":"200",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",type:"success"},on:{click:function(t){return e.editDictTemp(n)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),"0"==n.data.enable?a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(t){return e.disabledAllDict(n,"1")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(t){return e.disabledAllDict(n,"0")}}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")]),a("el-button",{attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(t){return e.deleteDict(n,"字典模板")}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px","text-align":"center"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length1,"page-sizes":[10,20,30,50],total:e.total1},on:{"current-change":e.channelCurrentChange1,"size-change":e.channelSizeChange1}})],1)],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("developer.dictionarymanagement"),name:"字典管理"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:e.$translateTitle("task.Select"),size:"mini"},on:{change:e.selectDictChange},model:{value:e.dictType,callback:function(t){e.dictType=t},expression:"dictType"}},e._l(e.dictRecordOpt,(function(e){return a("el-option",{key:e.data.name,attrs:{label:e.data.name,value:e.objectId}})})),1),a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:e.showDictDialog}},[e._v(" "+e._s(e.$translateTitle("developer.createdictionary"))+" ")]),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.isALL,expression:"isALL"},{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{border:"","cell-style":{"text-align":"center"},data:e.dictData,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.loadingdesperately"),"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName,stripe:""}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.indexes"),type:"index",width:"50"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionaryname"),prop:"key"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.key)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarynumber"),prop:"type"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.objectId)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytype"),prop:"type"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.templateName)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("concentrator.status")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["1"==n.data.enable?a("el-tag",{attrs:{type:"success"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-tag",{attrs:{type:"warning"}},[e._v(" "+e._s(e.$translateTitle("developer.scrap"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("user.Remarks")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.description)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.commandoperation"),width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",type:"success"},on:{click:function(t){return e.editAllDict(n)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),"0"==n.data.enable?a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(t){return e.disabledAllDict(n,"1")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(t){return e.disabledAllDict(n,"0")}}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")]),a("el-button",{attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(t){return e.deleteDict(n,"字典")}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:!e.isALL,expression:"!isALL"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"filterObj",staticClass:"filter_obj",staticStyle:{width:"100%"},attrs:{border:"","cell-style":{"text-align":"center"},data:e.dictList,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.loadingdesperately"),"header-cell-style":{"text-align":"center"},"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytype"),prop:"templateName",width:"150"}}),e._l(e.dialogtempconfig,(function(t,n){return["Boolean"==t.type?a("el-table-column",{key:n,attrs:{label:t.title.zh,prop:t.name},scopedSlots:e._u([{key:"default",fn:function(n){var r=n.row;return[r[t.name]?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])]}}],null,!0)}):a("el-table-column",{key:n,attrs:{label:t.title.zh,prop:t.name}})]})),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("product.commandoperation"),width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",type:"success"},on:{click:function(t){return e.editDict(n)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),"0"==n.enable?a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(t){return e.disabledDict(n,"1")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(t){return e.disabledDict(n,"0")}}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")]),a("el-button",{attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(t){return e.deleteDict(n,"字典")}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],2),e.isALL?a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px","text-align":"center"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.channelCurrentChange,"size-change":e.channelSizeChange}})],1):e._e()],1)],1)],1)},r=[],i=a("4490"),l=a("fb07"),s=a("e97b"),o=a("d0d7"),c=a.n(o),d=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("c4bc"),a("16b8"),a("e170"),a("04d6"),a("f1e1"),a("e0e9")),u=a("5880"),p=a("1b07"),m={name:"Dict",components:{},data:function(){return{height:this.$baseTableHeight(0)-50,queryid:this.$route.query.dictid,arrlist:[],addDictForm:{templateId:"",key:""},rules:{},rules1:{},loading:!1,defaultProps:{children:"children",label:"label"},count:0,start:0,total:0,length:10,count1:0,start1:0,total1:0,length1:10,isALL:!0,filterObj:[],tempObjectId:"",dictType:"ALL",allApps:[],showTree:!1,editIndexId:void 0,editDictId:"",editDictTempId:"",infoData:new Date,elactiveName:"Table",activeName:"字典模板管理",title_dict_edit_dialog:"新增字典数据",title_temp_dialog:"新增字典模板",title_dict_dialog:"新增字典",search_dict:"",add_dict_dialog:!1,dict_temp_dialog:!1,edit_dict_temp_dialog:!1,dialogtempconfigVisible:!1,dialogtempconfig:[],dictData:[],dictRecord:[],listLoading:!1,dictRecordOpt:[],dictOptions:["String","Boolean","Number"],dictForm:{type:"",name:"",nameEncrypt:"",needReply:"",enable:"",description:"",tempconfig:[]},tempparams:{name:"",type:"",order:0,title:{en:"",zh:""},default:5,required:!1,description:{en:"",zh:""}},dictList:[],dictTempForm:{name:"",cType:"",enable:"1",description:"",params:[]},formLabelWidth:"120px"}},computed:Object(s["a"])(Object(s["a"])({},Object(u["mapGetters"])({roleTree:"user/roleTree"})),{},{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.columns.filter((function(t){return e.checkList.includes(t.label)}))}}),mounted:function(){this.getDictData(),this.getDictRecord(),this.dialogType()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{opendialog:function(e){var t=this;this.$nextTick((function(){t.$refs[e].clearValidate()}))},selectDictChange:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){var n,r,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("0"!=e){a.next=6;break}t.listLoading=!0,t.getDictRecord(),t.isALL=!0,a.next=19;break;case 6:return Object(d["getDict"])(e).then((function(e){t.dialogtempconfig=e.data.params})),t.listLoading=!0,n={order:"-createdAt",limit:100,skip:0,where:{type:e}},a.next=11,Object(d["queryDict"])(n);case 11:r=a.sent,i=r.results,t.isALL=!1,t.filterObj=i,t.listLoading=!1,t.dictList=[],t.filterObj.map((function(e){var a={objectId:e.objectId};for(var n in e.data)a[n]=e.data[n];t.dictList.push(a)})),console.log(t.dictList);case 19:case"end":return a.stop()}}),a)})))()},dialogType:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(p["resourceTypes"])();case 3:a=t.sent,e.channelregion=a;case 5:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.addDictForm.applicationtText=e.name},editAllDict:function(e){this.editDictId=e.objectId,this.selectChange(e.type),this.addDictForm=e.data,this.addDictForm.type=e.type,this.add_dict_dialog=!0,this.title_dict_dialog="编辑字典"},editDict:function(e){this.editDictId=e.objectId,this.selectChange(e.templateId),this.addDictForm=e,this.add_dict_dialog=!0,this.title_dict_dialog="编辑字典"},tempTypeChange:function(e){this.tempparams.default="Boolean"==e||("Number"==e?0:void 0)},selectChange:function(e){var t=this,a={};Object(d["getDict"])(e).then((function(n){t.listLoading=!0,t.arrlist=n.data.params;var r={key:[{required:!0,message:"请输入字典名称",trigger:"blur"}],templateId:[{required:!0,message:"请选择字典类型",trigger:"blur"}],rolesObj:[{required:!0,message:"请选择所属应用",trigger:"change"}]};t.arrlist.map((function(e){e.default?a[e.name]=e.default:a[e.name]="",e.required&&("Boolean"==e.type?r[e.name]=[{required:!0,message:"请选择"+e.title.zh,trigger:"change"}]:r[e.name]=[{required:!0,message:"请输入"+e.title.zh,trigger:"blur"}])})),t.rules1=r,t.editDictId||(t.addDictForm=a,console.log(a)),t.addDictForm.templateId=e,t.addDictForm.templateName=n.data.name,t.listLoading=!1}))},submitFormTempDict:function(){this.edit_dict_temp_dialog=!1,void 0!=this.editIndexId?(this.dictTempForm.params[this.editIndexId]=this.tempparams,this.$message("编辑成功")):(this.dictTempForm.params.push(this.tempparams),this.$message("新增成功"))},addRow:function(e){this.editIndexId=void 0,this.title_dict_edit_dialog="新增字典数据",this.edit_dict_temp_dialog=!0,this.tempparams={name:"",type:"",order:0,title:{en:"",zh:""},default:0,required:!1,description:{en:"",zh:""}}},delRow:function(e,t){t.splice(e,1)},editRow:function(e,t,a){this.editIndexId=t,this.title_dict_edit_dialog="修改字典数据",this.edit_dict_temp_dialog=!0,this.tempparams=e},clearFormValidate:function(e){void 0!==this.$refs[e]&&this.$refs[e].resetFields()},onError:function(){this.$message("非Json数据类型")},onJsonChange:function(){},onJsonSave:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.editDictTempId?t.put_Dict_temp(t.editDictTempId,t.dictTempForm):t.addDict_temp(t.dictTempForm)}))},tableRowClassName:function(e){e.row;var t=e.rowIndex;return 1===t?"warning-row":3===t?"success-row":""},searchDict:function(e){this.queryid="",this.getDictData()},createDictTemp:function(){this.dict_temp_dialog=!0,this.editDictTempId="",this.title_temp_dialog="创建字典模板",this.dictTempForm={name:"",cType:"",enable:"1",description:"",params:[]},this.rules={name:[{required:!0,message:"请输入字典模板名称",trigger:"blur"}],cType:[{required:!0,message:"请输入字典模板类型",trigger:"blur"}],enable:[{required:!0,message:"请选择状态",trigger:"change"}]}},detailsTemp:function(e){alert(JSON.stringify(e))},showDictDialog:function(){this.add_dict_dialog=!0,this.title_dict_dialog="新增字典",this.editDictId="",this.addDictForm={},this.arrlist=[],this.rules1={key:[{required:!0,message:"请输入字典名称",trigger:"blur"}],templateId:[{required:!0,message:"请选择字典类型",trigger:"blur"}],rolesObj:[{required:!0,message:"请选择所属应用",trigger:"change"}]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){t.addDictForm.applicationtText?e&&(t.editDictId?t.put_Dict(t.editDictId,t.addDictForm):t.addDict(t.addDictForm)):t.$message("请选择所属应用")}))},addDict_temp:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){var n,r;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={data:e,ACL:t.$aclObj,key:e.name,type:"dict_template"},a.next=3,Object(d["postDict"])(n);case 3:r=a.sent,void 0!=r.createdAt?(t.$message("创建成功"),t.dict_temp_dialog=!1,t.getDictData()):137==r.code?t.$message("字典名称重复"):t.$message("创建失败");case 5:case"end":return a.stop()}}),a)})))()},addDict:function(e){var t=this;return Object(l["a"])(c.a.mark((function a(){var n,r,i,l,s,o;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(r in n={},e.templateTypekey="dict_template",e)n[r]=e[r];return i="role:"+e.applicationtText,l={},l[i]={read:!0,write:!0},s={data:n,ACL:l,key:e.key,type:e.templateId},a.next=9,Object(d["postDict"])(s);case 9:o=a.sent,o&&(t.$message("创建成功"),t.add_dict_dialog=!1,t.dictType=e.templateName,t.selectDictChange(e.templateId));case 11:case"end":return a.stop()}}),a)})))()},editDictTemp:function(e){this.editDictTempId=e.objectId,this.dictTempForm=e.data;var t=e.data.params,a=void 0===t?{}:t;this.dictTempForm.params=a,this.dict_temp_dialog=!0,this.title_temp_dialog="编辑字典模板"},put_Dict_temp:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function n(){var r,i,l;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={data:t,key:t.key},n.next=3,Object(d["putDict"])(e,r);case 3:i=n.sent,l=i.updatedAt,void 0!=l?(a.getDictData(),a.dict_temp_dialog=!1,a.$message("字典数据更新成功")):a.$message("字典数据更新失败");case 6:case"end":return n.stop()}}),n)})))()},put_Dict:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function n(){var r,i,l,s,o;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:for(i in r={},t)r[i]=t[i];return l={data:r},n.next=5,Object(d["putDict"])(e,l);case 5:s=n.sent,o=s.updatedAt,o?(a.dictType=t.templateName,a.selectDictChange(t.templateId),a.add_dict_dialog=!1,a.$message("字典数据更新成功")):a.$message("字典数据更新失败");case 8:case"end":return n.stop()}}),n)})))()},disabledDict:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function n(){var r,i,l;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.enable=t,r={key:e.key,data:e},n.next=4,Object(d["putDict"])(e.objectId,r);case 4:i=n.sent,l=i.updatedAt,l?a.$message("字典状态设置成功"):a.$message("字典状态设置失败");case 7:case"end":return n.stop()}}),n)})))()},disabledAllDict:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function n(){var r,i,l;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.data.enable=t,r={data:e.data},n.next=4,Object(d["putDict"])(e.objectId,r);case 4:i=n.sent,l=i.updatedAt,l?a.$message("字典状态设置成功"):a.$message("字典状态设置失败");case 7:case"end":return n.stop()}}),n)})))()},deleteDict:function(e,t){var a=this;return Object(l["a"])(c.a.mark((function n(){var r;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.$del_object("Dict",e.objectId);case 2:r=n.sent,r?("字典"==t?(a.selectDictChange(e.templateId),a.getDictRecord()):(a.selectDictChange("0"),a.getDictData()),a.$message(t+"删除成功")):a.$message(t+"删除失败");case 4:case"end":return n.stop()}}),n)})))()},getDictData:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a,n,r,l,s;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,n={order:"-createdAt",count:"objectId",limit:e.length,skip:e.start,where:{type:"dict_template"}},e.queryid&&(n.where["objectId"]=e.queryid),e.search_dict&&(n.where["data.name"]=e.search_dict),t.next=6,Object(d["queryDict"])(n);case 6:r=t.sent,l=r.results,s=r.count,e.total1=s,e.dictRecordOpt=[],e.dictRecord=l,e.queryid&&(e.search_dict=e.dictRecord[0].data.name),e.listLoading=!1,(a=e.dictRecordOpt).push.apply(a,[{data:{name:"ALL"},objectId:"0"}].concat(Object(i["a"])(l)));case 15:case"end":return t.stop()}}),t)})))()},channelSizeChange1:function(e){this.length1=e,this.getDictData()},channelSizeChange:function(e){this.length=e,this.getDictRecord()},channelCurrentChange1:function(e){this.start1=(e-1)*this.length1,this.getDictData()},channelCurrentChange:function(e){this.start=(e-1)*this.length,this.getDictRecord()},getDictRecord:function(){var e=this;return Object(l["a"])(c.a.mark((function t(){var a,n,r,i;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,a={order:"-createdAt",count:"objectId",limit:e.length,skip:e.start,where:{"data.templateTypekey":"dict_template"}},t.next=4,Object(d["queryDict"])(a);case 4:n=t.sent,r=n.results,i=n.count,e.total=i,e.listLoading=!1,e.dictData=r;case 10:case"end":return t.stop()}}),t)})))()}}},f=m,h=(a("5eec"),a("bdd7")),g=Object(h["a"])(f,n,r,!1,null,"93544c70",null);t["default"]=g.exports},"936f":function(e,t,a){"use strict";a.r(t);var n,r,i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addengine"},[a("div",{staticClass:"addcontent"},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"formInline",attrs:{"label-width":"80px",model:e.formInline,rules:e.formlinerule,size:"medium"}},[a("div",{staticClass:"form-block__title"},[e._v(" "+e._s(e.$translateTitle("rule.condtion"))+" "),a("div",{staticClass:"form-block__title-tips"},[e._v(" "+e._s(e.$translateTitle("rule.Processing"))+" ")])]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:e.row1}},[a("el-form-item",[a("div",{staticClass:"show-guess"},[a("p",[e._v(e._s(e.$translateTitle("rule.RuleSQLexample")))]),a("div",{staticClass:"code"},[a("code",{staticStyle:{"font-size":"12px"}},[e._v(e._s(e.sqlexample))])])])]),a("el-form-item",{attrs:{label:e.$translateTitle("rule.RuleSQL"),prop:"enginesql"}},[a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor1"}},[a("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"},model:{value:e.formInline.enginesql,callback:function(t){e.$set(e.formInline,"enginesql",t)},expression:"formInline.enginesql"}})],1)]),a("el-form-item",{attrs:{label:e.$translateTitle("rule.rule Id")}},[a("el-input",{attrs:{readonly:"编辑"==e.title,type:"text"},model:{value:e.formInline.ruleId,callback:function(t){e.$set(e.formInline,"ruleId",t)},expression:"formInline.ruleId"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.Remarks")}},[a("el-input",{attrs:{type:"text"},model:{value:e.formInline.remarks,callback:function(t){e.$set(e.formInline,"remarks",t)},expression:"formInline.remarks"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.SQLtest")}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"gray"},on:{change:e.getEditor2},model:{value:e.formInline.sqltest,callback:function(t){e.$set(e.formInline,"sqltest",t)},expression:"formInline.sqltest"}}),a("el-popover",{attrs:{content:"自定义模拟数据进行 SQL 命令测试，仅用于测试功能",placement:"top-start",trigger:"hover",width:"200"}},[a("i",{staticClass:"el-icon-question",staticStyle:{color:"#71737d"},attrs:{slot:"reference"},slot:"reference"})])],1)],1),a("el-col",{attrs:{span:4}}),a("el-col",{staticClass:"animated fadeInRightBig",attrs:{span:e.row2}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:"clientid",prop:"clientid",rules:[{required:!0,message:"clientid 不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.formInline.clientid,callback:function(t){e.$set(e.formInline,"clientid",t)},expression:"formInline.clientid"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:"username",prop:"username",rules:[{required:!0,message:"username 不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.formInline.username,callback:function(t){e.$set(e.formInline,"username",t)},expression:"formInline.username"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:"topic",prop:"topic",rules:[{required:!0,message:"topic 不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.formInline.topic,callback:function(t){e.$set(e.formInline,"topic",t)},expression:"formInline.topic"}})],1),1==e.formInline.sqltest?a("el-form-item",{attrs:{label:"qos",prop:"qos",rules:[{required:!0,message:"qos 不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.formInline.qos,callback:function(t){e.$set(e.formInline,"qos",e._n(t))},expression:"formInline.qos"}})],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:"payload",prop:"payload",rules:[{required:!0,message:"请填写payload",trigger:"blur"}]}},[a("el-input",{staticStyle:{visibility:"hidden"},attrs:{type:"text"},model:{value:e.formInline.payload,callback:function(t){e.$set(e.formInline,"payload",t)},expression:"formInline.payload"}}),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor2"}},[a("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"},model:{value:e.formInline.payload,callback:function(t){e.$set(e.formInline,"payload",t)},expression:"formInline.payload"}})],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:" "}},[a("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return e.testRule("formInline")}}},[e._v(" "+e._s(e.$translateTitle("rule.Test"))+" ")])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:e.$translateTitle("rule.TestJie")}},[a("el-input",{attrs:{rows:4,type:"textarea"},model:{value:e.formInline.result,callback:function(t){e.$set(e.formInline,"result",t)},expression:"formInline.result"}})],1)],1)],1),a("div",{staticClass:"tablebottom"},[a("div",{staticClass:"form-block__title"},[a("span",{staticStyle:{color:"rgb(255, 109, 109)"}},[e._v("*")]),e._v(" "+e._s(e.$translateTitle("rule.ResponseAction"))+" "),a("div",{staticClass:"form-block__title-tips"},[e._v(" "+e._s(e.$translateTitle("rule.Processing"))+" ")])]),a("div",{staticClass:"bottomtable",staticStyle:{"padding-left":"20px"}},[a("div",{staticClass:"tableaction"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.actionData,"header-cell-style":{"text-align":"center"}}},[a("el-table-column",{attrs:{label:e.$translateTitle("rule.channel")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.params.$resource?a("span",[e._v(" "+e._s("关联资源:"+n.params.$resource)+" ")]):a("span")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.target_topic")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.params.target_topic)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.target_qos")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.params.target_qos)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.payload_tmpl")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.params.payload_tmpl)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.editAisle(n)}}},[e._v(" "+e._s(e.$translateTitle("button.edit"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteOneData(r)}}},[e._v(" "+e._s(e.$translateTitle("button.delete"))+" ")])]}}])})],1),a("div",[a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{icon:"el-icon-circle-plus-outline",plain:"",size:"small",type:"success"},on:{click:e.addresouce}},[e._v(" "+e._s(e.$translateTitle("rule.Addto"))+" ")])],1)],1)]),a("div",[a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("rule.ResponseAction"),top:"10%",visible:e.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){return e.resetForm("params")}}},[a("el-form",{ref:"params",attrs:{"label-position":"left","label-width":"140px",model:e.params,rules:e.paramsrules}},[a("el-form-item",{attrs:{prop:"channel"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.channel")))]),a("el-tooltip",{staticClass:"item",attrs:{content:"重新发布消息到物联网通道",effect:"dark",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-select",{model:{value:e.params.channel,callback:function(t){e.$set(e.params,"channel",t)},expression:"params.channel"}},e._l(e.channellist,(function(t){return a("el-option",{key:t.name,attrs:{disabled:"dgiot"!=t.name,label:t.title.zh,value:t.title.zh}},[a("span",{staticStyle:{float:"left"}},[t.title?a("i",[e._v(" "+e._s(t.title.zh)+" ")]):e._e()]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(" "+e._s(t.description.zh)+" ")])])})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.resource"),prop:"resources"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.resource")))]),a("el-tooltip",{staticClass:"item",attrs:{content:e.$translateTitle("rule.resource"),effect:"dark",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-select",{model:{value:e.params.resources,callback:function(t){e.$set(e.params,"resources",t)},expression:"params.resources"}},e._l(e.resources,(function(t){return a("el-option",{key:t.id,attrs:{label:t.description,value:t.id}},[a("span",{staticStyle:{float:"left"}},[t.description?a("i",[e._v(" "+e._s(t.description)+" ")]):e._e()]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(" "+e._s(t.id)+" ")])])})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.target_qos")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.target_qos")))]),a("el-tooltip",{staticClass:"item",attrs:{content:"重新发布消息时用的 QoS 级别, 设置为 -1 以使用原消息中的 QoS",effect:"dark",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-select",{model:{value:e.params.target_qos,callback:function(t){e.$set(e.params,"target_qos",t)},expression:"params.target_qos"}},e._l(e.params.target_qosSelect,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.target_topic")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.target_topic")))]),a("el-tooltip",{staticClass:"item",attrs:{content:"重新发布消息到哪个主题",effect:"dark",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-input",{model:{value:e.params.target_topic,callback:function(t){e.$set(e.params,"target_topic",t)},expression:"params.target_topic"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.payload_tmpl")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.payload_tmpl")))]),a("el-tooltip",{staticClass:"item",attrs:{content:"消息内容模板，支持变量",effect:"dark",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-input",{attrs:{rows:2,type:"textarea"},model:{value:e.params.payload_tmpl,callback:function(t){e.$set(e.params,"payload_tmpl",t)},expression:"params.payload_tmpl"}})],1),a("el-form-item",[e.aisleRow.name?a("el-button",{on:{click:function(t){return e.editFom("formInline")}}},[e._v(" "+e._s(e.$translateTitle("button.modify"))+" ")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("params")}}},[e._v(" "+e._s(e.$translateTitle("button.create"))+" ")]),a("el-button",{on:{click:function(t){e.dialogFormVisible=!e.dialogFormVisible}}},[e._v(" "+e._s(e.$translateTitle("button.cancel"))+" ")])],1)],1)],1)],1)]),a("el-form-item",{attrs:{"label-width":"90"}},[e.ruleId.length?a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.editrules(e.ruleId,"formInline")}}},[e._v(" "+e._s(e.$translateTitle("button.modify"))+" ")]):a("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return e.addrules("formInline")}}},[e._v(" "+e._s(e.$translateTitle("button.create"))+" ")]),a("el-button",[e._v(e._s(e.$translateTitle("button.cancel")))])],1)],1)],1)],1)])},l=[],s=a("fb07"),o=a("d0d7"),c=a.n(o),d=(a("80ab"),a("a98c"),a("16b8"),a("1d17"),a("1258"),a("f1e1"),a("e170"),a("1b07")),u=a("9e6f"),p={data:function(){return{ruleId:this.$route.query.id||"",uid:this.$route.query.uid||"",ruleType:this.$route.query.type||"",resources:[],aisleRow:{},params:{name:"",payload_tmpl:"${payload}",target_qos:0,target_qosSelect:[-1,0,1,2],target_topic:"thing/${productid}/${clientid}/post",$resource:"",resources:"",channel:""},dialogVisible:!1,resourceform:{objectId:"",region:"data_resource",desc:""},resourcerule:{objectId:[{required:!0,message:"请填写通道编号",trigger:"blur"}],desc:[{required:!0,message:"请填写通道描述",trigger:"blur"}]},row1:24,row2:0,dialogFormVisible:!1,title:"",formInline:{user:"",region:"",enginesql:"SELECT\n      payload.msg as msg,\n      clientid,\n      'productid' as productid\n    FROM\n      \"t/#\"\n    WHERE\n      msg = 'hello'",remarks:"",sqltest:!1,clientid:"c_swqx",username:"u_swqx",qos:1,topic:"t/a",payload:"",result:""},formlinerule:{region:[{required:!0,message:"请选择触发事件",trigger:"change"}],enginesql:[{required:!0,message:"请填写规则SQL",trigger:"blur"}]},actionData:[],form:{action:"dgiot_resource",resource:""},paramsrules:{channel:[{required:!0,message:"请选择通道",trigger:"change"}],resources:[{required:!0,message:"请选择关联资源",trigger:"change"}]},formrule:{action:[{required:!0,message:"请选择动作",trigger:"change"}]},productid:"",resourcelist:[],channellist:[],ctype:"",client:[],sqlexample:"SELECT\n      payload.msg as msg\n    FROM\n      \"t/#\"\n    WHERE\n      msg = 'hello'",actionslist:[],allChannelstart:0}},mounted:function(){this.ruleId&&this.queryRule(this.ruleId),this.title=this.$route.query.title,this.productid=this.$route.query.productid,n=ace.edit("editor1"),n.session.setMode("ace/mode/sql"),n.setTheme("ace/theme/eclipse"),n.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0});var e=ace.require("ace/ext/language_tools");e.addCompleter({getCompletions:function(e,t,a,n,r){r(null,u["default"])}}),n.setValue(this.formInline.enginesql),r=ace.edit("editor2"),r.session.setMode("ace/mode/json"),r.setTheme("ace/theme/eclipse"),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),r.setValue('{"msg":"hello"}')},methods:{getEditor2:function(e){1==e?(this.row1=12,this.row2=12):(this.row1=24,this.row2=0)},queryRule:function(e){var t=this;return Object(s["a"])(c.a.mark((function a(){var r,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["get_rule_id"])(e);case 2:r=a.sent,i=r.data,console.log(i),t.actionData=i.actions,t.formInline.enginesql=i.rawsql,n.setValue(t.formInline.enginesql),t.formInline.ruleId=i.id,t.formInline.remarks=i.description,n.setValue(i.rawsql);case 11:case"end":return a.stop()}}),a)})))()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.relationChannel(t.params)}))},editFom:function(e){console.log(this.params),this.aisleRow.name=this.params.name,this.aisleRow.params.payload_tmpl=this.params.payload_tmpl,this.aisleRow.params.target_qos=this.params.target_qos,this.aisleRow.params.target_topic=this.params.target_topic,this.aisleRow.params.$resource=this.params.$resource,this.aisleRow.params.resources=this.params.resources,this.aisleRow.params.channel=this.params.channel,this.dialogFormVisible=!this.dialogFormVisible,this.aisleRow={}},resetForm:function(e){this.$refs[e].resetFields(),this.aisleRow={}},relationChannel:function(e){console.log(e),this.actionData.push({name:"dgiot",params:{$resource:e.resources,target_topic:e.target_topic,target_qos:e.target_qos,payload_tmpl:e.payload_tmpl,channel:this.params.channel},fallbacks:[]}),console.log(this.actionData,"this.actionData"),this.dialogFormVisible=!this.dialogFormVisible},_get_actions:function(){var e=this;return Object(s["a"])(c.a.mark((function t(){var a,n;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["get_actions"])();case 2:a=t.sent,n=a.data,e.channellist=n;case 5:case"end":return t.stop()}}),t)})))()},_get_resources:function(){var e=this;return Object(s["a"])(c.a.mark((function t(){var a,n;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["get_resources"])();case 2:a=t.sent,n=a.data,e.resources=n;case 5:case"end":return t.stop()}}),t)})))()},testRule:function(e){var t=this;this.formInline.result="",this.formInline.payload=r.getValue(),this.formInline.enginesql=n.getValue(),this.$refs[e].validate((function(e){if(e){var a=/from[^"]+?"([^"]+)"/im,i={clientid:t.formInline.clientid,payload:r.getValue(),qos:t.formInline.qos,topic:t.formInline.topic,username:t.formInline.username},l={actions:t.actionData,ctx:i,description:t.formInline.remarks,for:n.getValue().match(a)[1],name:t.formInline.username,rawsql:n.getValue(),test:"true"};Object(d["addRule"])(l).then((function(e){console.log("response",e);var a=e.code;0==a?(t.formInline.result=e.data.msg,console.log("     this.formInline.result ",t.formInline.result)):(t.$message.error("SQL Not Match"),console.log("error response",e))})).catch((function(e){console.log(e),t.$message.error(e)}))}}))},editrules:function(e,t){var a=this;return Object(s["a"])(c.a.mark((function i(){var l,s,o;return c.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return l={clientid:a.formInline.clientid,payload:r.getValue(),qos:a.formInline.qos,topic:a.formInline.topic,username:a.formInline.username},s={actions:a.actionData,ctx:l,description:a.formInline.remarks,for:'["t/#"]',rawsql:n.getValue()},i.next=4,Object(d["put_rule_id"])(e,s);case 4:o=i.sent,console.log(e,t,o),a.$message("修改成功"),a.$router.push({path:"/rules_engine/engine"});case 8:case"end":return i.stop()}}),i)})))()},addrules:function(e){var t=this;this.formInline.payload=r.getValue(),this.formInline.enginesql=n.getValue(),this.$refs[e].validate((function(e){if(e){if(0==t.actionData.length)return void t.$message("动作不能为空");var a={clientid:t.formInline.clientid,payload:r.getValue(),qos:t.formInline.qos,topic:t.formInline.topic,username:t.formInline.username},i={actions:t.actionData,ctx:a,description:t.formInline.remarks,for:'["t/#"]',rawsql:n.getValue()};t.uid&&t.productid&&(i.id="rule:".concat(t.ruleType,"_").concat(t.productid,"_").concat(t.uid)),Object(d["addRule"])(i).then((function(e){console.log(e),e&&(t.$message("创建成功"),t.$router.push({path:"/rules_engine/engine"}))})).catch((function(e){console.log(e),t.$message.error(e.error)}))}else t.$message("有必填项未填写")}))},addresouce:function(){console.log(this.aisleRow),this._get_actions(),this._get_resources(),this.aisleRow.name&&(this.params={name:this.aisleRow.name,payload_tmpl:this.aisleRow.params.payload_tmpl,target_qos:this.aisleRow.params.target_qos,target_qosSelect:[-1,0,1,2],target_topic:this.aisleRow.params.target_topic,$resource:this.aisleRow.params.$resource,resources:this.aisleRow.params.$resource,channel:this.aisleRow.params.channel}),this.dialogFormVisible=!0},addRes:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return t.$message.error("error submit!!"),!1;Object(d["postResource"])({channel:t.resourceform.objectId},t.resourceform.desc,"","data_resource").then((function(a){a&&(t.$message("创建成功"),t.$refs[e].resetFields(),t.dialogVisible=!1)}))}))},deleteOneData:function(e){this.actionData.splice(e,1)},editAisle:function(e){this.aisleRow=e,this.addresouce()}}},m=p,f=(a("d9b9"),a("bdd7")),h=Object(f["a"])(m,i,l,!1,null,"07616fb2",null);t["default"]=h.exports},"965e":function(e,t,a){var n={"./docDialog.vue":"eaa7f"};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id="965e"},"9f62":function(t,a,n){(function(t){var a=n("d0d7"),r=n("bc43").default,i=n("6c8e").default;n("1c6f"),n("1d17"),n("4c87"),n("b037"),n("f1e1"),n("3dec"),n("37c6"),n("a0e0"),n("16b8"),n("79da");var l=n("80b9"),s=n("cad9"),o=n("f526"),c=n("197e"),d=c.proxy[0].target;function u(e){return!!l.existsSync(e)||(u(s.dirname(e))?(l.mkdirSync(e),!0):void 0)}function p(e){return s.resolve(t,e)}function m(e){return"import { ".concat(e.join(", ")," } from '@/utils/Request/request'\n")}function f(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post",n=e.slice(1).split("/"),r=n[n.length-1];return"\n// ".concat(t||"","\nexport function ").concat(r,"(data, cb, errHandle) {\n  return ").concat(a,"('").concat(e,"', data, cb, errHandle)\n}\n")}function h(t){return new Promise((function(a,n){o.get(t,(function(t){var r,i=t.statusCode,l=t.headers["content-type"];if(200!==i?r=new Error("请求失败。\n"+"状态码: ".concat(i)):/^application\/json/.test(l)||(r=new Error("无效的 content-type.\n"+"期望 application/json 但获取的是 ".concat(l))),r)return dgiotlog.warn(r.message),void t.resume();t.setEncoding("utf8");var s="";t.on("data",(function(e){s+=e})),t.on("end",(function(){try{var t=JSON.parse(s);a(t)}catch(e){n("错误: ".concat(e.message))}}))})).on("error",(function(e){n("错误: ".concat(e.message))}))}))}var g="/src",b="".concat(d,"/swagger.json");function v(){return y.apply(this,arguments)}function y(){return y=i(a.mark((function e(){var t,n,i,s,o,c,d,v,y,w,_,$,k,x,T,D,C;return a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return dgiotlog.log("获取远程json文件中..."),e.next=3,h(b);case 3:t=e.sent,n=t.paths,dgiotlog.log("获取成功正在生成api文件"),i={},e.t0=a.keys(n);case 8:if((e.t1=e.t0()).done){e.next=40;break}if(s=e.t1.value,o=n[s],c="",!o.post){e.next=26;break}if(d=o.post.tags[0],d){e.next=16;break}return e.abrupt("continue",8);case 16:if(v=s.slice(1).split("/"),4!==s.slice(1).split("/").length){e.next=21;break}c=v[1],e.next=23;break;case 21:if(s.slice(1).split("/")[0]===d){e.next=23;break}return e.abrupt("continue",8);case 23:i[o.post.tags[0]]?i[o.post.tags[0]].push({summary:o.post.summary,tag:d,name:s,type:"post",folder:c}):i[o.post.tags[0]]=[{summary:o.post.summary,tag:d,name:s,type:"post",folder:c}],e.next=38;break;case 26:if(!o.get){e.next=38;break}if(y=o.get.tags[0],y){e.next=30;break}return e.abrupt("continue",8);case 30:if(w=s.slice(1).split("/"),4!==s.slice(1).split("/").length){e.next=35;break}c=w[1],e.next=37;break;case 35:if(s.slice(1).split("/")[0]===y){e.next=37;break}return e.abrupt("continue",8);case 37:i[o.get.tags[0]]?i[o.get.tags[0]].push({summary:o.get.summary,tag:y,name:s,type:"get",folder:c}):i[o.get.tags[0]]=[{summary:o.get.summary,tag:y,name:s,type:"get",folder:c}];case 38:e.next=8;break;case 40:for(_ in i){$="",k=[],x="",T=r(i[_]);try{for(C=function(){var e=D.value,t=k.filter((function(t){return t===e.type}));0===t.length&&k.push(e.type),$+=f(e.name,e.summary,e.type),x=e.folder},T.s();!(D=T.n()).done;)C()}catch(q){T.e(q)}finally{T.f()}$=m(k)+$,u(p("..".concat(g,"/apis/").concat(x))),dgiotlog.log($),l.writeFileSync(p("..".concat(g,"/apis/").concat(x,"/").concat(_,".js")),$)}dgiotlog.log("生成完毕");case 42:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}v()}).call(this,"/")},b012:function(e,t,a){"use strict";a("cd7b")},b5c1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"createResourcechannel"},[n("vab-input",{ref:"uploadFinish",on:{fileInfo:e.fileInfo}}),n("el-form",{ref:"addchannel",attrs:{"label-width":"auto",model:e.addchannel,rules:e.addrules,size:"mini"}},[n("div",{staticClass:"dialog-footer",staticStyle:{margin:"15px"}},[n("el-button",{on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.back"))+" ")]),n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addchannelForm("addchannel")}}},[e._v(" "+e._s(e.$translateTitle("developer.create"))+" ")])],1),n("el-row",[n("el-form-item",{attrs:{label:"通道类型",prop:"region"}},[n("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"通道类型"},on:{change:e.removeauto},model:{value:e.addchannel.region,callback:function(t){e.$set(e.addchannel,"region",t)},expression:"addchannel.region"}},e._l(e.channelregion,(function(e,t){return n("el-option",{key:t,staticStyle:{display:"block"},attrs:{label:e.title.zh,value:e.cType}})})),1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name"}},[n("el-input",{staticStyle:{float:"left"},attrs:{autocomplete:"off",placeholder:e.$translateTitle("developer.channelname")},model:{value:e.addchannel.name,callback:function(t){e.$set(e.addchannel,"name",t)},expression:"addchannel.name"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"所属应用",prop:"applicationtText"}},[n("el-input",{attrs:{readonly:""},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.addchannel.applicationtText,callback:function(t){e.$set(e.addchannel,"applicationtText",t)},expression:"addchannel.applicationtText"}}),e.showTree?n("div",{staticClass:"device-tree"},[n("el-tree",{attrs:{data:e.allApps,"default-expand-all":"",props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1)],1),e._l(e.arrlist,(function(t,a){return n("el-col",{key:a,attrs:{span:12}},[n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"ico"!=t.showname,expression:"item.showname != 'ico'"}],attrs:{label:t.title.zh,prop:t.showname,required:t.required}},[n("el-tooltip",{attrs:{effect:"dark",placement:"right-start"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(t.description.zh)+" ")]),n("i",{staticClass:"el-icon-question",staticStyle:{float:"left"}})]),"string"==t.type?n("el-input",{staticStyle:{width:"98%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}}):"integer"==t.type?n("el-input",{staticStyle:{width:"98%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}}):"ico"==t.showname?n("el-image",{staticStyle:{display:"none",width:"98%"}}):"boolean"==t.type?n("el-select",{staticClass:"notauto",staticStyle:{width:"98%"},attrs:{readonly:""},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},[n("el-option",{attrs:{label:"是",value:!0}}),n("el-option",{attrs:{label:"否",value:!1}})],1):"enum"==t.type?n("el-select",{staticStyle:{width:"98%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},e._l(t.enum,(function(e,a){return n("el-option",{key:a,attrs:{label:t.enum[a],value:t.enum[a]}})})),1):e._e()],1)],1)})),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[n("el-input",{attrs:{autocomplete:"off",placeholder:e.$translateTitle("developer.describe"),rows:3,type:"textarea"},model:{value:e.addchannel.desc,callback:function(t){e.$set(e.addchannel,"desc",t)},expression:"addchannel.desc"}})],1)],1),e.viewShow?n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:e.$translateTitle("product.view")}},[n("div",{staticStyle:{height:"30vh",overflow:"auto"}},[n("vab-monaco-plus",{ref:"monacoCode",attrs:{codes:e.addchannel.codes,language:"json","read-only":!1,theme:"vs-dark"}})],1)])],1):e._e(),n("el-col",{attrs:{span:24}},[n("el-row",{staticStyle:{width:"100%","max-height":"500px",margin:"0","overflow-x":"hidden","overflow-y":"scroll","line-height":"30px","text-align":"center"},attrs:{gutter:24}},e._l(e.channelregion,(function(t,r){return n("el-col",{key:r,staticStyle:{padding:"10px",margin:"0px",cursor:"pointer"},attrs:{span:4}},[n("el-card",{staticClass:"box-card",style:{color:e.addchannel.region==t.cType?"#00bad0":"#c0c4cc"},attrs:{shadow:e.addchannel.region==t.cType?"always":"hover",size:"mini"}},[n("div",{staticClass:"text item",on:{click:function(a){return e.setCard(t.cType)}}},[n("el-row",{attrs:{gutter:24}},[n("el-col",{attrs:{span:6}},[n("img",{staticClass:"image",staticStyle:{width:"50px",height:"50px"},attrs:{src:t.params.ico.default?t.params.ico.default:a("67aa")}})]),n("el-col",{attrs:{span:18}},[n("span",[n("p",[n("el-tag",{staticStyle:{float:"left",color:"black","text-align":"left",background:"#fff"}},[e._v(" "+e._s(t.cType)+" ")])],1),n("p",{attrs:{title:t.title.zh}},[e._v(" "+e._s(t.title.zh)+" ")])])])],1)],1)])],1)})),1)],1)],2)],1)],1)},r=[],i=a("fb07"),l=a("e97b"),s=(a("16b8"),a("3dec"),a("4656"),a("fc3d"),a("c4bc"),a("9c6a"),a("d0d7")),o=a.n(s),c=a("67aa"),d=a.n(c),u=a("1b07"),p=a("89e8"),m=a("5880"),f={name:"Createchannel",components:{},data:function(){return{viewShow:!1,channelregion:[],defaultProps:{children:"children",label:"label"},resourceid:"",showTree:!1,allApps:[],arrlist:[],addrules:{applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择通道类型",trigger:"change"}]},addchannel:{codes:"{}",name:"",region:""}}},computed:Object(l["a"])({},Object(m["mapGetters"])({roleTree:"user/roleTree"})),watch:{},mounted:function(){this.getResource()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:Object(l["a"])(Object(l["a"])({},Object(m["mapActions"])({addVisitedRoute:"tabs/addVisitedRoute",delVisitedRoute:"tabs/delVisitedRoute",delOthersVisitedRoutes:"tabs/delOthersVisitedRoutes",delLeftVisitedRoutes:"tabs/delLeftVisitedRoutes",delRightVisitedRoutes:"tabs/delRightVisitedRoutes",delAllVisitedRoutes:"tabs/delAllVisitedRoutes"})),{},{initFrom:function(){this.channelForm=!1,this.$refs["addchannel"].resetFields(),this.resourceid=""},uploadCkick:function(e,t){console.log(e,t),this.channeindex=t,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click"))},fileInfo:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("uploadFinish",e),console.log(t.channelregion),t.channelregion[t.channeindex].params.ico.default=e.url,console.log(t.channelregion[t.channeindex].params.ico.default),a.next=6,Object(u["putResourceTypes"])(t.channelregion);case 6:n=a.sent,console.log(n);case 8:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.handleTabRemove()},addchannelForm:function(e){var t=this;console.log(this.addchannel.applicationtText),this.$refs[e].validate((function(e){if(e){var a={};for(var n in t.addchannel)a[n]=t.addchannel[n];delete a.region,delete a.desc,delete a.type,delete a.isEnable,delete a.name;var r="role:"+t.addchannel.applicationtText,i={};i[r]={read:!0,write:!0};var l={data:JSON.parse(t.$refs.monacoCode.monacoEditor.getValue()),ACL:i,config:a,name:t.addchannel.name,cType:t.addchannel.region,desc:t.addchannel.desc,isEnable:!1,status:"OFFLINE",type:t.addchannel.type.toString()};t.addchannelaxios(l)}else t.$message("有必填项未填")}))},setCard:function(e){this.removeauto(e)},orderObject:function(e){var t=[];for(var a in e)e[a].showname=a,t.push(e[a]);return t.sort(this.arrSort)},removeauto:function(e){var t=this;this.viewShow=!1,console.log(e);var a={},n={applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择通道类型",trigger:"change"}]};if(""==this.resourceid?this.channelregion.map((function(r){r.cType==e&&(t.$forceUpdate(),t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(e){e.default?a[e.showname]=e.default:a[e.showname]="",e.required&&("string"==e.type||"integer"==e.type?n[e.showname]=[{required:!0,trigger:"blur"}]:n[e.showname]=[{required:!0,trigger:"change"}])})),console.log("arr",t.arrlist),a.region=e,a.desc="",a.name="",a.type=t.selectregion.type,a.isEnable=!1)})):this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.$forceUpdate(),t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(r){for(var i in t.channelrow.config)r.showname==i&&(a[r.showname]=t.channelrow.config[i]),r.required&&("string"==r.type||"integer"==r.type?n[r.showname]=[{required:!0,trigger:"blur"}]:n[r.showname]=[{required:!0,trigger:"change"}]),a.region=e,a.desc=t.channelrow.desc,a.name=t.channelrow.name,a.type=t.selectregion.type,a.isEnable=t.channelrow.isEnable})))})),this.channelrow)for(var r in this.channelrow.ACL)a.applicationtText=r?r.substr(5):"";console.log("obj",a),this.addchannel=a,this.addchannel.region=e,this.addrules=n,this.viewShow=!0,this.addchannel.codes="{}"},addchannelaxios:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(p["postChannel"])(e).then((function(e){e&&(t.$message({type:"success",message:"编辑"==t.channelupdated?"编辑成功":"创建成功"}),t.addchannel={},t.channelForm=!1,t.resourceid="",t.handleTabRemove())}));case 2:case"end":return a.stop()}}),a)})))()},handleTabRemove:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$route.path,t.next=3,e.delVisitedRoute(a);case 3:e.$router.go(-1);case 4:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.$set(this.addchannel,"applicationtText",e.name),this.showTree=!this.showTree},clearValidate:function(e){console.log("清除了 ".concat(e," 的规则校验")),this.$refs.addchannel.clearValidate("".concat(e))},getResource:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(u["resourceTypes"])();case 3:a=t.sent,a.forEach((function(e){e.params.ico||(e.params.ico={title:{en:"channel ICO",zh:"通道ICO"},description:{en:"channel ICO",zh:"通道ICO"},default:d.a})})),e.channelregion=a,e.$nextTick((function(){e.initFrom()}));case 7:case"end":return t.stop()}}),t)})))()},onSubmit:function(){console.log("submit!")}})},h=f,g=(a("41da"),a("bdd7")),b=Object(g["a"])(h,n,r,!1,null,"87b24ee6",null);t["default"]=b.exports},b908:function(e,t,a){},c025:function(e,t,a){"use strict";a("b908")},c20c:function(e,t,a){},c3b1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{key:e.queryForm.key,staticClass:"comprehensive-table-container"},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"49px",model:e.queryForm,size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.Table Name")}},[a("el-input",{attrs:{readonly:"",size:"mini"},model:{value:e.queryForm.class,callback:function(t){e.$set(e.queryForm,"class",t)},expression:"queryForm.class"}})],1),a("el-form-item",{attrs:{label:"key"}},[a("el-input",{attrs:{readonly:"",size:"mini"},model:{value:e.queryForm.key,callback:function(t){e.$set(e.queryForm,"key",t)},expression:"queryForm.key"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.title")}},[a("el-select",{staticStyle:{width:"95%"},attrs:{"allow-create":"","default-first-option":"",filterable:"",placeholder:"请选择",size:"mini"},model:{value:e.queryForm.title,callback:function(t){e.$set(e.queryForm,"title",t)},expression:"queryForm.title"}},e._l(e.titleOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.Type")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"","default-first-option":"",filterable:"",placeholder:e.$translateTitle("rule.Type"),size:"mini"},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}},e._l(e.dicttype,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleAdd}}),a("el-button",{attrs:{icon:"el-icon-search",type:"success"},on:{click:function(t){return e.fetchData()}}})],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:"",data:e.list}},[a("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":"",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"objectId",prop:"objectId","show-overflow-tooltip":""}}),a("el-table-column",{directives:[{name:"show",rawName:"v-show",value:!e.queryForm.hiddenRow.includes("title"),expression:"!queryForm.hiddenRow.includes('title')"}],attrs:{align:"center",label:e.$translateTitle("product.title"),prop:"title","show-overflow-tooltip":""}}),a("el-table-column",{directives:[{name:"show",rawName:"v-show",value:!e.queryForm.hiddenRow.includes("class"),expression:"!queryForm.hiddenRow.includes('class')"}],attrs:{align:"center",label:e.$translateTitle("product.Table Name"),prop:"class","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"key",prop:"key","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("rule.Type"),prop:"type","show-overflow-tooltip":""}}),a("el-table-column",{directives:[{name:"show",rawName:"v-show",value:!e.queryForm.hiddenRow.includes("createdAt"),expression:"!queryForm.hiddenRow.includes('createdAt')"}],attrs:{align:"center",label:e.$translateTitle("application.createtime"),prop:"createdAt","show-overflow-tooltip":"",width:"140"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("node.operation"),"show-overflow-tooltip":"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDict(n.objectId)}}},[e._v(" 设计 ")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")])]}}])})],1),a("vab-parser-pagination",{attrs:{pagination:e.paginations,"query-payload":e.queryPayload},on:{pagination:e.fetchData,paginationQuery:e.paginationQuery}}),a("dict-edit",{ref:"edit",on:{"fetch-data":e.fetchData}}),a("dictDesign",{ref:"dictDesign",on:{objectId:e.dictId}})],1)},r=[],i=a("fb07"),l=(a("3dec"),a("9c6a"),a("d0d7")),s=a.n(l),o=a("9140"),c=a("e0e9"),d=a("042f7"),u={class:"",type:"",title:"",key:"",data:{},disabled:!1,hiddenRow:[]},p={name:"ComprehensiveTable",components:{dictEdit:d["default"],dictDesign:o["default"]},filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},props:{dictForm:{required:!1,type:Object,default:function(){return u}}},data:function(){return{dictId:"",paginations:{pageSizes:[5,10,20,50,100,200,500],layout:"total, sizes, prev, pager, next, jumper",background:!0,hidden:!1,small:!1,pageSize:10,total:0,pageCount:0,pagerCount:7,currentPage:1,popperClass:"",prevText:"",nextText:"",disabled:!1,hideOnSinglePage:!1},queryPayload:{include:"",order:"-createdAt",limit:10,skip:0,count:"objectId"},queryForm:this.dictForm,dicttype:["dict","word","rule"],titleOption:["worddict","ruledict"],list:[],imageList:[],listLoading:!0,selectRows:""}},created:function(){this.fetchData()},mounted:function(){var e=this;this.$dgiotBus.$off("saveDict"),this.$dgiotBus.$on("saveDict",(function(t){e.saveDict(t.id,t.data)}))},methods:{handleAdd:function(){this.$refs["edit"].type="add",console.log("this.queryForm",this.queryForm),this.$refs["edit"].showEdit(this.queryForm)},handleEdit:function(e){this.$refs["edit"].dictId=e.objectId,this.$refs["edit"].type="edit",console.log("row",e),this.$refs["edit"].showEdit(e)},handleDelete:function(e){var t=this;console.log(e.data,e.objectId),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["delDict"])(e.objectId);case 2:a.sent,t.$baseMessage(t.$translateTitle("successfully deleted"),"success","vab-hey-message-success"),t.fetchData();case 5:case"end":return a.stop()}}),a)}))))},handleDict:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){var n,r;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.$baseColorfullLoading(1),a.next=3,Object(c["getDict"])(e);case 3:r=a.sent,n.close(),t.$dgiotBus.$emit("dictDesign",r);case 6:case"end":return a.stop()}}),a)})))()},saveDict:function(e,t){var a=this;return Object(i["a"])(s.a.mark((function n(){var r;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=a.$baseColorfullLoading(1),n.next=3,Object(c["putDict"])(e,t);case 3:n.sent,r.close();case 5:case"end":return n.stop()}}),n)})))()},paginationQuery:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.queryPayload=e;case 1:case"end":return a.stop()}}),a)})))()},fetchData:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){var n,r,i,l,o,d,u,p,m,f;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return _.isEmpty(e)&&(e=t.queryPayload),t.queryPayload.where={class:t.queryForm.class?{$regex:t.queryForm.class}:{$ne:null},type:t.queryForm.type?{$regex:t.queryForm.type}:{$ne:null},title:t.queryForm.title?{$regex:t.queryForm.title}:{$ne:null},key:t.queryForm.key?{$regex:t.queryForm.key}:{$ne:null},objectId:t.queryForm.objectId?{$regex:t.queryForm.objectId}:{$ne:null}},n=e,r=n.count,i=n.order,l=n.excludeKeys,o=n.limit,d=n.skip,u=n.where,console.log(t.queryForm),t.listLoading=!0,a.next=7,Object(c["queryDict"])({count:r,order:i,excludeKeys:l,limit:o,skip:d,where:u});case 7:p=a.sent,m=p.results,f=p.count,m&&m.forEach((function(e){e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss")})),t.list=m,t.$dgiotBus.$emit("dictLen",f),t.paginations.total=f,t.listLoading=!1;case 15:case"end":return a.stop()}}),a)})))()}}},m=p,f=a("bdd7"),h=Object(f["a"])(m,n,r,!1,null,null,null);t["default"]=h.exports},cd7b:function(e,t,a){},ce0f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("developer.dictinfo"),name:"字典管理"}},[a("el-form",{ref:"dataform",attrs:{"label-width":"100px",model:e.dataform}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"small",type:"primary"},nativeOn:{click:function(t){return e.addparam.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.dataform.params}},[a("el-table-column",{attrs:{label:e.$translateTitle("equipment.serialnumber"),prop:"order"}}),a("el-table-column",{attrs:{label:e.$translateTitle("deviceLog.identifier"),prop:"identifier"}}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.name"),prop:"name"}}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.Type"),prop:"type"}}),a("el-table-column",{attrs:{label:e.$translateTitle("cloudTest.datasources"),prop:"sources"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Operation"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("el-button",{attrs:{plain:"",size:"mini",title:e.$translateTitle("task.Edit"),type:"info"},nativeOn:{click:function(t){return e.editRow(r,n)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),a("el-button",{attrs:{plain:"",size:"mini",title:e.$translateTitle("task.Delete"),type:"danger"},nativeOn:{click:function(t){return e.delRow(r)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1)],1)],1),a("el-tab-pane",{attrs:{label:"Json",name:"Json"}},[a("el-form",{ref:"dataform",attrs:{"label-width":"100px",model:e.dataform}},[a("el-form-item",{attrs:{label:e.$translateTitle("task.data"),prop:"data"}},[a("div",{staticStyle:{height:"30vh",overflow:"auto"}},[a("vab-monaco-plus",{ref:"monacoCode",attrs:{codes:e.dataform.data,language:"json","read-only":!1,theme:"vs-dark"}})],1)])],1)],1)],1),a("el-drawer",{directives:[{name:"drawerDrag",rawName:"v-drawerDrag"}],ref:"param",attrs:{"append-to-body":"",size:"30%",title:e.title_param_dialog,visible:e.edit_param_dialog},on:{"update:visible":function(t){e.edit_param_dialog=t}}},[a("div",[a("el-form",{ref:"param",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:e.param,rules:e.rules,size:"mini","status-icon":""}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.serialnumber"),prop:"order"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:e.param.order,callback:function(t){e.$set(e.param,"order",t)},expression:"param.order"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[a("el-input",{model:{value:e.param.identifier,callback:function(t){e.$set(e.param,"identifier",t)},expression:"param.identifier"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.name"),prop:"name"}},[a("el-input",{model:{value:e.param.name,callback:function(t){e.$set(e.param,"name",t)},expression:"param.name"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("rule.Type"),prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.param.type,callback:function(t){e.$set(e.param,"type",t)},expression:"param.type"}},e._l(e.dictOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.datasources"),prop:"sources"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("task.Select")},model:{value:e.param.sources,callback:function(t){e.$set(e.param,"sources",t)},expression:"param.sources"}},e._l(e.sourcesOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),"dynamicTable"==e.param.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.row"),prop:"order"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:e.param.row,callback:function(t){e.$set(e.param,"row",t)},expression:"param.row"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.column"),prop:"order"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1},model:{value:e.param.column,callback:function(t){e.$set(e.param,"column",t)},expression:"param.column"}})],1)],1)],1):e._e(),"dynamicTable"==e.param.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.parameter"),prop:"order"}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 物模型标识符， "),a("br"),e._v(" 用 ‘,’ 分隔， "),a("br"),e._v(" 例：flow,power,head,ratedspeed,pressure_in,pressure_out,conversion_flow,conversion_head,conversion_power,effect ")]),a("i",{staticClass:"el-icon-question"})]),a("el-input",{staticStyle:{width:"96%"},attrs:{min:1,placeholder:"flow,power,head"},model:{value:e.param.parameter,callback:function(t){e.$set(e.param,"parameter",t)},expression:"param.parameter"}})],1)],1)],1):e._e(),"dynamicTable"==e.param.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.samplingnumber"),prop:"samplingnumber"}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("稳态值个数")]),a("i",{staticClass:"el-icon-question"})]),a("el-input-number",{staticStyle:{width:"96%"},attrs:{min:1},model:{value:e.param.samplingnumber,callback:function(t){e.$set(e.param,"samplingnumber",t)},expression:"param.samplingnumber"}})],1)],1)],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitparam("param")}}},[e._v(" "+e._s(e.$translateTitle("button.determine"))+" ")])],1)],1)],1)])],1)},r=[],i=a("fb07"),l=a("d0d7"),s=a.n(l),o=(a("e170"),{name:"DgiotWord",components:{},props:{objectId:{default:"",required:!0,type:String},data:{default:function(){return{params:[]}},required:!0,type:Object}},data:function(){return{dataform:this.data,param:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],sources:[{required:!0,message:"请选择数据来源",trigger:"change"}],identifier:[{required:!0,message:"请输入标识符",trigger:"blur"}],parameter:[{required:!0,message:"请输入表头参数标识符",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]},title_param_dialog:"",edit_param_dialog:!1,activeName:"字典管理",infoData:"DgiotDict",dictOptions:["text","image","dynamicTable","table","string","boolean","number"],sourcesOptions:["amis","thing"],editIndexId:""}},computed:{},mounted:function(){console.log("this.data",this.data),console.log("this.dataform",this.dataform)},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{opendialog:function(e){var t=this;this.$nextTick((function(){t.$refs[e].clearValidate()}))},delRow:function(e){this.dataform.params.splice(e,1),this.saveDict()},editRow:function(e,t){this.editIndexId=e,this.title_param_dialog="修改字典数据",this.edit_param_dialog=!0,this.param=t},addparam:function(){this.editIndexId=void 0,this.title_param_dialog="新增字典数据",this.edit_param_dialog=!0,this.param={order:this.dataform.params.length+1,row:1,column:1,identifier:"",name:"",type:"",sources:"",samplingnumber:10}},submitparam:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(s.a.mark((function e(a){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a&&(void 0!=t.editIndexId?(t.dataform.params[t.editIndexId]=t.param,t.$message.success("编辑成功")):(t.dataform.params.push(t.param),t.$message.success("新增成功")),t.saveDict(),t.edit_param_dialog=!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},saveDict:function(){this.$dgiotBus.$emit("saveDict",{id:this.objectId,data:{data:this.dataform}})}}}),c=o,d=(a("2d9a"),a("bdd7")),u=Object(d["a"])(c,n,r,!1,null,"308fef70",null);t["default"]=u.exports},cee0:function(e,t,a){"use strict";a("4e4c")},d141:function(e,t,a){"use strict";a("f1fc")},d1ce:function(e,t,a){},d3de:function(e,t,a){"use strict";a("e265")},d855:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"wrapper"},[a("el-button",{attrs:{size:"mini",title:e.$translateTitle("konva.save"),type:"success"},nativeOn:{click:function(t){return e.saveAmis()}}},[e._v(" "+e._s(e.$translateTitle("konva.save"))+" ")]),a("el-button",{attrs:{size:"mini",type:"warning"},nativeOn:{click:function(t){e.isPreview=!e.isPreview}}},[e._v(" "+e._s(e.isPreview?e.$translateTitle("task.Edit"):e.$translateTitle("application.preview"))+" ")])],1),a("vab-amis",{directives:[{name:"show",rawName:"v-show",value:e.isPreview,expression:"isPreview"}],attrs:{schema:e.renderSchema,"show-help":!1}}),a("vab-amis-editor",{directives:[{name:"show",rawName:"v-show",value:!e.isPreview,expression:"!isPreview"}],ref:"vabAmis",attrs:{"amis-key":e.viewId,theme:e.theme,value:e.amisJson},on:{onChange:e.onChange}})],1)},r=[],i=a("fb07"),l=a("d0d7"),s=a.n(l),o=a("8ba7"),c={name:"Editor",data:function(){return{renderSchema:{},theme:"antd",viewId:this.$route.query.viewId||"",isPreview:this.$route.query.isPreview||!1,amisJson:{}}},computed:{},mounted:function(){this.viewId&&this.viewData(this.viewId)},methods:{onChange:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$refs["vabAmis"].setSchema(e),t.renderSchema=e;case 2:case"end":return a.stop()}}),a)})))()},viewData:function(e){var t=this;return Object(i["a"])(s.a.mark((function a(){var n,r,i,l,c,d;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},a.prev=1,r=t.$baseLoading(1),a.next=5,Object(o["getView"])(e);case 5:i=a.sent,l=i.data,c=i.class,d=i.key,"Device"==c&&(n["parse_objectid"]=d,localStorage.setItem("parse_objectid",d),console.groupCollapsed("%c amis env","color:#009a61; font-size: 28px"),console.log("amisEnv",n),console.groupEnd()),t.amisJson=l,t.$refs["vabAmis"].schema=l,t.renderSchema=t.$refs["vabAmis"].schema,t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),r.close(),a.next=21;break;case 17:a.prev=17,a.t0=a["catch"](1),console.log(a.t0),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 21:case"end":return a.stop()}}),a,null,[[1,17]])})))()},saveAmis:function(){var e=this;return Object(i["a"])(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$baseColorfullLoading(),n={data:e.$refs["vabAmis"].getSchema()},t.next=5,Object(o["putView"])(e.$route.query.viewId,n);case 5:t.sent,console.groupCollapsed("%c putView logs","color:red; font-size: 28px; font-weight: 300"),console.table({id:e.$route.query.viewId,data:e.$refs["vabAmis"].schema}),console.groupEnd(),e.$baseMessage(e.$translateTitle("user.update completed"),"success","vab-hey-message-success"),a.close(),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),console.log(t.t0),e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(t.t0),"error","vab-hey-message-error");case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()}}},d=c,u=(a("0213"),a("bdd7")),p=Object(u["a"])(d,n,r,!1,null,"26919354",null);t["default"]=p.exports},d9b9:function(e,t,a){"use strict";a("19f2")},dcc8:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},e265:function(e,t,a){},e2e9:function(e,t,a){"use strict";a("c20c")},e9e9:function(e,t,a){},eaa7f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"doc-dialog"},[a("el-dialog",{key:e.key,attrs:{"append-to-body":"",title:"add"==e.form.type?e.$translateTitle("article.New category"):e.$translateTitle("article.edit category"),visible:e.dialogFormVisible,width:"400px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.handleClose}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("article.name"),"label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.parent.objectId.includes("article"),expression:"form.parent.objectId.includes('article')"}],attrs:{label:e.$translateTitle("article.category"),"label-width":e.formLabelWidth,prop:"category"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.parent.objectId.includes("article"),expression:"form.parent.objectId.includes('article')"}],attrs:{label:e.$translateTitle("article.Icon"),"label-width":e.formLabelWidth,prop:"ico"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.ico,callback:function(t){e.$set(e.form,"ico",t)},expression:"form.ico"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("article.order"),"label-width":e.formLabelWidth,prop:"order"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",min:0,step:1},model:{value:e.form.order,callback:function(t){e.$set(e.form,"order",t)},expression:"form.order"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:e.$translateTitle("article.parent"),"label-width":e.formLabelWidth,prop:"parent.objectId"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.parent.objectId,callback:function(t){e.$set(e.form.parent,"objectId",t)},expression:"form.parent.objectId"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("button.cancel"))+" ")]),"add"==e.form.type?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$parent.createDoc("form",e.form,e.form.type)}}},[e._v(" "+e._s(e.$translateTitle("button.create"))+" ")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$parent.editDoc("form",e.form,e.form.type)}}},[e._v(" "+e._s(e.$translateTitle("button.modify"))+" ")])],1)],1)],1)},r=[],i={name:"DocDialog",data:function(){return{key:moment(new Date).valueOf(),dialogFormVisible:!1,form:{type:"",name:"",parent:{objectId:"article",__type:"Pointer",className:"Article"},data:"",order:0,category:"",Icon:"",desc:""},rules:{name:[{required:!0,message:"请输入文档名",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],category:[{required:!0,message:"请输入类别",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],ico:[],order:[{required:!0,type:"number",message:"请选择排序",trigger:"blur"}],"parent.objectId":[{required:!0,type:"string",message:"请输入父及",trigger:"blur"}]},formLabelWidth:"60px"}},computed:{},mounted:function(){},created:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{handleClose:function(e){console.log(e),this.$refs.form.resetFields(),this.form={type:"",name:"",parent:{objectId:"article",__type:"Pointer",className:"Article"},data:"",order:0,category:"",Icon:"",desc:""}}}},l=i,s=a("bdd7"),o=Object(s["a"])(l,n,r,!1,null,null,null);t["default"]=o.exports},f1fc:function(e,t,a){},f8c3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"checkengine"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"fonty-size":"16px"}},[e._v("基本信息")])]),a("div",{staticClass:"box-form"},[a("el-form",{attrs:{"label-width":"80px",model:e.engineform}},[a("el-form-item",{attrs:{label:"触发事件:"}},[a("span",[e._v(e._s(e.engineform.region))])]),a("el-form-item",{attrs:{label:"规则SQL:"}},[a("span",[e._v(e._s(e.engineform.sql))])]),a("el-form-item",{attrs:{label:"备注:"}},[a("span",[e._v(e._s(e.engineform.remarks))])])],1)],1)]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("度量指标")])]),a("div",{staticClass:"box-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.engineData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{label:"节点",prop:"node"}}),a("el-table-column",{attrs:{label:"已命中",prop:"matched",sortable:"",width:"180"}}),a("el-table-column",{attrs:{label:"命中速度",prop:"speed",sortable:"",width:"180"}}),a("el-table-column",{attrs:{label:"最大命中速度",prop:"speed_max"}}),a("el-table-column",{attrs:{label:"5分钟平均速度",prop:"speed_last5m"}})],1)],1)]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("响应动作")])]),a("div",{staticClass:"box-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rulesdata}},[a("el-table-column",{attrs:{label:"类型",prop:"name",width:"180"}}),a("el-table-column",{attrs:{label:"参数"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.params))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"度量指标"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("ul",[e._l(n.metrics,(function(t,n){return a("li",{key:n},[a("span",{staticStyle:{display:"inline-block",width:"120px"}},[e._v(" "+e._s(t.node)+" ")]),a("span",{staticClass:"type"},[e._v(e._s("成功:"+t.success))]),a("span",{staticClass:"type"},[e._v(e._s("失败:"+t.failed))])])})),a("li",[a("span",{staticStyle:{display:"inline-block",width:"120px","margin-top":"20px"}},[e._v(" 合计 ")]),a("span",{staticClass:"type"},[e._v(" "+e._s("成功:"+e.allsuccss(n.metrics))+" ")]),a("span",{staticClass:"type"},[e._v(" "+e._s("失败:"+e.allfailed(n.metrics))+" ")])])],2)]}}])})],1)],1)])],1)},r=[],i=(a("1c6f"),a("80ab"),a("a98c"),a("c4bc"),a("1b07")),l={data:function(){return{engineform:{region:"",remarks:"",sql:""},engineData:[],ruleid:"",rulesdata:[]}},mounted:function(){this.detailForRule()},methods:{detailForRule:function(){var e=this;this.rulesdata=[],this.ruleid=this.$route.query.id,Object(i["getRuleDetail"])(this.ruleid).then((function(t){t.data&&(e.engineform.region=t.data.for.join(","),e.engineform.remarks=t.data.description,e.engineform.sql=t.data.rawsql,e.engineData=t.data.metrics,e.rulesdata=t.data.actions)})).catch((function(t){e.$message(t.error)}))},allsuccss:function(e){var t=0;return e.map((function(e){t+=e.success})),t},allfailed:function(e){var t=0;return e.map((function(e){t+=e.failed})),t}}},s=l,o=(a("d3de"),a("bdd7")),c=Object(o["a"])(s,n,r,!1,null,"31ab1862",null);t["default"]=c.exports},fc1a:function(e,t,a){}}]);