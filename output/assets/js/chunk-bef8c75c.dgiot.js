/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  Time: 2022-01-12 11:38:04
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bef8c75c"],{"0061":function(e,t,a){},"0238":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{staticClass:"parserTable",attrs:{"append-to-body":!0,direction:"rtl",visible:e.dialogFormVisible,width:"500"},on:{close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:e.close}},[e._v(" "+e._s(e.$translateTitle("category.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.save(e.form.mark)}}},[e._v(" "+e._s(e.$translateTitle("category.submit"))+" ")])]},proxy:!0}])},[a("vab-query-form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[a("vab-query-form-top-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"80px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("alert.productname")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("alert.please enter")+e.$translateTitle("alert.product name")},on:{clear:e.Industry},model:{value:e.queryForm.productId,callback:function(t){e.$set(e.queryForm,"productId",t)},expression:"queryForm.productId"}},e._l(e.productData,(function(t){return a("el-option",{key:t.objectId,attrs:{label:t.name,value:t.objectId},nativeOn:{click:function(a){return e.Industry(t)}}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:e.Industry}},[e._v(" 查询 ")])],1)],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"","cell-style":{"text-align":"center"},data:e.tableData,"header-cell-style":{"text-align":"center"},height:e.$baseTableHeight(0)+180,size:"mini"}},[a("el-table-column",{attrs:{label:"objectId",prop:"objectId",width:"140"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.Templatename"),prop:"name",width:"180"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.toDeleteATemplate(r.objectId)}}},[e._v(" "+e._s(e.$translateTitle("product.Delete template"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.Industry}})],1)},l=[],o=a("fb07"),i=a("e97b"),n=a("d0d7"),s=a.n(n),c=(a("c4bc"),a("16b8"),a("3dec"),a("79da"),a("ef68")),d=a("7212"),u=a("5880"),p={name:"ProductTemplet",data:function(){return{form:{},dialogFormVisible:!1,tableData:[],productData:[],queryForm:{productId:"",productFlag:!1,pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,total:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(i["a"])(Object(i["a"])({},Object(u["mapGetters"])({role:"acl/role",username:"user/username"})),{},{aclObj:function(){var e={};return this.role.map((function(t){dgiotlog.log(t.name,""),e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),created:function(){},mounted:function(){},methods:{selectType:function(e){this.form.data=e,dgiotlog.log(e)},categoryChange:function(e){},Industry:function(){var e=arguments,t=this;return Object(o["a"])(s.a.mark((function a(){var r,l,o,i,n,d,u;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),l={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys},a.prev=3,o=t.$baseColorfullLoading(),a.next=7,Object(c["queryProductTemplet"])(l);case 7:i=a.sent,n=i.results,d=i.count,u=void 0===d?0:d,o.close(),t.tableData=n,t.queryForm.total=u,a.next=20;break;case 16:a.prev=16,a.t0=a["catch"](3),dgiotlog.log(a.t0),t.$message.error("".concat(a.t0));case 20:case"end":return a.stop()}}),a,null,[[3,16]])})))()},queryProduct:function(){var e=this;return Object(o["a"])(s.a.mark((function t(){var a,r,l;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$baseColorfullLoading(),t.next=4,Object(d["queryProduct"])({keys:"name",where:{}});case 4:r=t.sent,l=r.results,a.close(),e.productData=l,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),dgiotlog.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},updateTemplate:function(e){return Object(o["a"])(s.a.mark((function t(){var a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,api(e);case 3:a=t.sent,dgiotlog.log(a),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),dgiotlog.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},toDeleteATemplate:function(e){var t=this;return Object(o["a"])(s.a.mark((function a(){var r,l;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,r=t.$baseColorfullLoading(),a.next=4,Object(c["delProductTemplet"])(e);case 4:l=a.sent,r.close(),dgiotlog.log(l),t.$message.success(t.$translateTitle("user.successfully deleted")),t.Industry(),a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](0),dgiotlog.log(a.t0),t.$message.error(t.$translateTitle("user.error deleted")+"".concat(a.t0));case 15:case"end":return a.stop()}}),a,null,[[0,11]])})))()},showEdit:function(e){this.queryProduct(),e&&(this.queryForm.productId=e),this.queryForm.productFlag=!0,this.Industry(),this.dialogFormVisible=!0},close:function(){this.dialogFormVisible=!1},save:function(e){var t=this;dgiotlog.log(e);var a={"*":{read:!0}};a[this.objectid]={read:!0,write:!0};var r={name:this.form.name,type:this.form.type,data:this.form.data,order:this.form.order},l="top"==e?_.merge(r,{ACL:_.merge(a,this.aclObj),parent:{objectId:"0",__type:"Pointer",className:"Category"}}):"child"==e?_.merge(r,{ACL:_.merge(a,this.aclObj),parent:{objectId:this.form.objectId,__type:"Pointer",className:"Category"}}):r;this.$refs["form"].validate(function(){var a=Object(o["a"])(s.a.mark((function a(r){var o,i;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(dgiotlog.log("setparams",l),!r){a.next=16;break}if("edit"!=e){a.next=8;break}return a.next=5,putCategory(t.form.objectId,l);case 5:a.t0=a.sent,a.next=11;break;case 8:return a.next=10,postCategory(l);case 10:a.t0=a.sent;case 11:o=a.t0,i=o.msg,t.$baseMessage(i,"success","vab-hey-message-success"),t.$emit("fetch-data"),t.close();case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}}},m=p,f=a("bdd7"),b=Object(f["a"])(m,r,l,!1,null,null,null);t["default"]=b.exports},1238:function(e,t,a){},"1267e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},l=[],o=(a("f1e1"),a("ed08")),i={props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"370px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0,default:function(){return{expectedData:[],actualData:[],title:"1",max:0}}}},data:function(){return{chart:null,sidebarElm:null}},watch:{chartData:{deep:!0,handler:function(e){this.setOptions(e)}}},mounted:function(){var e=this,t=document.getElementsByClassName("chart")[0];t.style.width=.4*window.innerWidth-120+"px",this.initChart(),this.autoResize&&(this.__resizeHandler=Object(o["debounce"])((function(){e.chart&&(t.style.width=.4*window.innerWidth-120+"px",e.chart.resize())}),100),window.addEventListener("resize",this.__resizeHandler))},beforeDestroy:function(){this.chart&&(this.autoResize&&window.removeEventListener("resize",this.__resizeHandler),this.sidebarElm&&this.sidebarElm.removeEventListener("transitionend",this.sidebarResizeHandler),this.chart.dispose(),this.chart=null)},methods:{sidebarResizeHandler:function(e){"width"===e.propertyName&&this.__resizeHandler()},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.expectedData,a=e.actualData,r=e.title,l=e.max;this.chart.setOption({xAxis:{data:a,boundaryGap:!1,axisTick:{show:!1}},grid:{left:10,right:10,bottom:20,top:30,containLabel:!0},title:{text:r,textStyle:{color:"black"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:["数据"]},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",show:!0,start:0,end:50,handleSize:8},{type:"inside",start:0,end:50}],visualMap:{show:!1,dimension:1,pieces:[{gte:0,lte:l,color:"green"}],outOfRange:{color:"red"}},series:[{name:"数据",itemStyle:{normal:{color:"#FF005A",lineStyle:{color:"#FF005A",width:2},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#7CF5A2"},{offset:.6,color:"#7EF57C"},{offset:1,color:"#fff"}])}}}},markLine:{silent:!1,data:[{name:"告警线",yAxis:l,label:{show:"true",position:"middle",formatter:"".concat(r,"最大").concat(l)}}]},smooth:!0,type:"line",data:t,animationDuration:2800,animationEasing:"cubicInOut"}]})},initChart:function(){var e=this;setTimeout((function(){e.chart=echarts.init(e.$el,"macarons"),e.setOptions(e.chartData)}),1e3)}}},n=i,s=a("bdd7"),c=Object(s["a"])(n,r,l,!1,null,null,null);t["default"]=c.exports},1331:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"1c75":function(e,t,a){"use strict";a("8b057")},2238:function(e,t,a){},"291d":function(e,t,a){},"291e":function(e,t,a){},"2fbe":function(e,t,a){"use strict";a("0061")},"30d9":function(e,t,a){"use strict";a("e094")},3248:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":!0,title:e.title,visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.save.apply(null,arguments)}}},[e._v("确 定")])]},proxy:!0}])},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"===typeof t?t.trim():t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{model:{value:e.form.author,callback:function(t){e.$set(e.form,"author","string"===typeof t?t.trim():t)},expression:"form.author"}})],1)],1)],1)},l=[],o=a("fb07"),i=a("d0d7"),n=a.n(i),s=a("8456"),c={name:"TableEdit",data:function(){return{form:{title:"",author:""},rules:{title:[{required:!0,trigger:"blur",message:"请输入标题"}],author:[{required:!0,trigger:"blur",message:"请输入作者"}]},title:"",dialogFormVisible:!1}},created:function(){},methods:{showEdit:function(e){e?(this.title="编辑",this.form=Object.assign({},e)):this.title="添加",this.dialogFormVisible=!0},close:function(){this.$refs["form"].resetFields(),this.form=this.$options.data().form,this.dialogFormVisible=!1},save:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(o["a"])(n.a.mark((function t(a){var r,l;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return t.next=3,Object(s["doEdit"])(e.form);case 3:r=t.sent,l=r.msg,e.$baseMessage(l,"success","vab-hey-message-success"),e.$emit("fetch-data"),e.close();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=c,u=a("bdd7"),p=Object(u["a"])(d,r,l,!1,null,null,null);t["default"]=p.exports},"38b0":function(e,t,a){},"391ce":function(e,t,a){},"39b8":function(e,t,a){},4095:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gateway"},[a("el-card",{staticClass:"wayheader",attrs:{shadow:"always"}},[a("div",{staticClass:"wayheaderone"},[a("span",{staticClass:"oneheader"},[e._v("网络设备")]),a("span",{staticClass:"twoheader"},[e._v("网络层级:"+e._s(e.cengji))]),a("span",{staticClass:"threeheader"})])])],1)},l=[],o={data:function(){return{cengji:2}},mounted:function(){},methods:{}},i=o,n=(a("1c75"),a("bdd7")),s=Object(n["a"])(i,r,l,!1,null,"421e4474",null);t["default"]=s.exports},"43b8":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"custom-table",staticClass:"custom-table-container",class:{"vab-fullscreen":e.isFullscreen}},[r("vab-query-form",[r("vab-query-form-left-panel",[r("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"标题"},model:{value:e.queryForm.title,callback:function(t){e.$set(e.queryForm,"title",t)},expression:"queryForm.title"}})],1),r("el-form-item",[r("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:e.handleQuery}},[e._v(" 查询 ")]),r("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},nativeOn:{click:function(t){return e.handleAdd.apply(null,arguments)}}},[e._v(" 添加 ")]),r("el-button",{attrs:{icon:"el-icon-delete",type:"danger"},on:{click:e.handleDelete}},[e._v(" 删除 ")])],1)],1)],1),r("vab-query-form-right-panel",[r("div",{staticClass:"stripe-panel"},[r("el-checkbox",{model:{value:e.stripe,callback:function(t){e.stripe=t},expression:"stripe"}},[e._v("斑马纹")])],1),r("div",{staticClass:"border-panel"},[r("el-checkbox",{model:{value:e.border,callback:function(t){e.border=t},expression:"border"}},[e._v("边框（可拉伸列）")])],1),r("el-button",{staticStyle:{margin:"0 10px 10px 0 !important"},attrs:{type:"primary"},on:{click:e.clickFullScreen}},[r("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}}),e._v(" 表格全屏 ")],1),r("el-popover",{ref:"popover",attrs:{"popper-class":"custom-table-checkbox",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[r("el-button",{staticStyle:{margin:"0 10px 10px 0 !important"},attrs:{type:"primary"}},[r("dgiot-icon",{attrs:{icon:"line-height"}}),e._v(" 表格尺寸 ")],1)]},proxy:!0}])},[r("el-radio-group",{model:{value:e.lineHeight,callback:function(t){e.lineHeight=t},expression:"lineHeight"}},[r("el-radio",{attrs:{label:"medium"}},[e._v("大")]),r("el-radio",{attrs:{label:"small"}},[e._v("中")]),r("el-radio",{attrs:{label:"mini"}},[e._v("小")])],1)],1),r("el-popover",{attrs:{"popper-class":"custom-table-checkbox",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[r("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" 可拖拽列设置 ")])]},proxy:!0}])},[r("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[r("vab-draggable",e._b({attrs:{list:e.columns}},"vab-draggable",e.dragOptions,!1),e._l(e.columns,(function(t,a){return r("div",{key:t+a},[r("dgiot-icon",{attrs:{icon:"drag-drop-line"}}),r("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t.label}},[e._v(" "+e._s(t.label)+" ")])],1)})),0)],1)],1)],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.list,height:e.height,size:e.lineHeight,stripe:e.stripe},on:{"selection-change":e.setSelectRows},scopedSlots:e._u([{key:"empty",fn:function(){return[r("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[r("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),r("el-table-column",{attrs:{align:"center",label:"序号","show-overflow-tooltip":"",sortable:"",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),e._l(e.finallyColumns,(function(t,a){return r("el-table-column",{key:a,attrs:{align:"center",label:t.label,sortable:"",width:t.width},scopedSlots:e._u([{key:"default",fn:function(a){var l=a.row;return["评级"===t.label?r("span",[r("el-rate",{attrs:{disabled:""},model:{value:l.rate,callback:function(t){e.$set(l,"rate",t)},expression:"row.rate"}})],1):r("span",[e._v(e._s(l[t.prop]))])]}}],null,!0)})})),r("el-table-column",{attrs:{align:"center",label:"操作","show-overflow-tooltip":"",sortable:"",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]}}])})],2),r("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,layout:e.layout,"page-size":e.queryForm.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),r("table-edit",{ref:"edit",on:{"fetch-data":e.fetchData}})],1)},l=[],o=a("fb07"),i=a("d0d7"),n=a.n(i),s=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("1c6f"),a("c4bc"),a("9c6a"),a("8456")),c=a("3248"),d=a("289a"),u=a.n(d),p={name:"Empty",components:{TableEdit:c["default"],VabDraggable:u.a},data:function(){return{infoData:"Empty",isFullscreen:!1,border:!0,height:this.$baseTableHeight(1),stripe:!1,lineHeight:"medium",checkList:["标题","作者","评级","点击量","时间"],columns:[{label:"标题",width:"auto",prop:"title",sortable:!0,disableCheck:!0},{label:"作者",width:"auto",prop:"author",sortable:!0},{label:"评级",width:"200",prop:"rate",sortable:!0},{label:"点击量",width:"auto",prop:"pageViews",sortable:!0},{label:"时间",width:"auto",prop:"datetime",sortable:!0}],list:[],imageList:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",total:0,selectRows:"",queryForm:{pageNo:1,pageSize:20,title:""}}},computed:{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.columns.filter((function(t){return e.checkList.includes(t.label)}))}},mounted:function(){},created:function(){this.fetchData()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{clickFullScreen:function(){this.isFullscreen=!this.isFullscreen,this.handleHeight()},handleHeight:function(){this.isFullscreen?this.height=this.$baseTableHeight(1)+210:this.height=this.$baseTableHeight(1)},setSelectRows:function(e){this.selectRows=e},handleAdd:function(){this.$refs["edit"].showEdit()},handleEdit:function(e){this.$refs["edit"].showEdit(e)},handleDelete:function(e){var t=this;if(e.id)this.$baseConfirm("你确定要删除当前项吗",null,Object(o["a"])(n.a.mark((function a(){var r,l;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["doDelete"])({ids:e.id});case 2:return r=a.sent,l=r.msg,t.$baseMessage(l,"success","vab-hey-message-success"),a.next=7,t.fetchData();case 7:case"end":return a.stop()}}),a)}))));else if(this.selectRows.length>0){var a=this.selectRows.map((function(e){return e.id})).join();this.$baseConfirm("你确定要删除选中项吗",null,Object(o["a"])(n.a.mark((function e(){var r,l;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["doDelete"])({ids:a});case 2:return r=e.sent,l=r.msg,t.$baseMessage(l,"success","vab-hey-message-success"),e.next=7,t.fetchData();case 7:case"end":return e.stop()}}),e)}))))}else this.$baseMessage("未选中任何行","error","vab-hey-message-error")},handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageNo=e,this.fetchData()},handleQuery:function(){this.queryForm.pageNo=1,this.fetchData()},fetchData:function(){var e=this;return Object(o["a"])(n.a.mark((function t(){var a,r,l,o,i;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,Object(s["getList"])(e.queryForm);case 3:a=t.sent,r=a.data,l=r.list,o=r.total,e.list=l,i=[],l.forEach((function(e){i.push(e.img)})),e.imageList=i,e.total=o,e.listLoading=!1;case 13:case"end":return t.stop()}}),t)})))()}}},m=p,f=(a("4a2c"),a("bdd7")),b=Object(f["a"])(m,r,l,!1,null,"05840f64",null);t["default"]=b.exports},"4a2c":function(e,t,a){"use strict";a("ef3f4")},"4a99":function(e,t,a){},"4b04":function(e,t,a){},"4c00":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{key:e.productId},[a("a-tabs",{attrs:{"default-active-key":"物模型",s:"",type:"card"},on:{change:e.handletabs}},[a("a-tab-pane",{key:"物模型",attrs:{tab:"物模型"}},[a("vab-query-form-left-panel",[a("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.checkschema.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.viewobjectmodel"))+" ")]),a("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.createProperty.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newobjectmodel"))+" ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],key:e.tableType,staticStyle:{width:"100%"},attrs:{border:"","cell-style":{"text-align":"center"},data:"things"==e.tableType?e.things:"profile"==e.tableType||"parser"==e.tableType?e.parserTableList:"basedate.params"==e.tableType?e.dictTableList:[],"header-cell-style":{"text-align":"center"},"highlight-current-row":"","row-key":"objectId",size:"medium"}},["things"==e.tableType?a("div",{key:e.tableType+e.thingKey},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.order"),prop:"dataForm.order","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.Rounds"),prop:"dataForm.round","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.Strategy"),prop:"dataForm.strategy","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocol"),prop:"dataForm.protocol","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.identifier"),prop:"identifier","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionname"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.datatype"),prop:"dataType.type","show-overflow-tooltip":"",sortable:"",width:"auto"}}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("product.datadefinition"),prop:"dataType.type","show-overflow-tooltip":"",sortable:"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[!r.dataType.specs||"double"!=r.dataType.type&&"float"!=r.dataType.type&&"int"!=r.dataType.type?"string"==r.dataType.type?a("span",[e._v(" "+e._s(e.$translateTitle("product.datalength")+":"+r.dataType.size+e.$translateTitle("product.byte"))+" ")]):"struct"!=r.dataType.type?a("span",[e._v(" "+e._s(r.dataType.specs)+" ")]):e._e():a("span",[e._v(" "+e._s(e.$translateTitle("product.rangeofvalues")+r.dataType.specs.min+"~"+r.dataType.specs.max)+" ")])]}}],null,!1,2022078325)}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),"min-width":"240",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,l=t.$index;return[a("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deletewmx(l)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.wmxDataFill(r,l)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}],null,!1,832725005)})],1):"profile"==e.tableType||"parser"==e.tableType?a("div",[a("el-table-column",{attrs:{align:"center",label:"uid",prop:"uid","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.chinesetitle"),prop:"name","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-popover",{attrs:{placement:"top",trigger:"hover"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.englishtitle"))+": "+e._s(r.enname)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("developer.describe"))+": "+e._s(r.description)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("product.identifier"))+": "+e._s(r.identifier)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("developer.describe"))+": "+e._s(r.description)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("product.Table Name"))+": "+e._s(r.table)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("product.class"))+": "+e._s(r.field)+" ")]),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(" "+e._s(r.name)+" ")])],1)])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionaltypes"),prop:"type","show-overflow-tooltip":"",sortable:""}})],1):a("div",[a("el-empty",{attrs:{"image-size":200}})],1)])],1),a("a-tab-pane",{key:"解码器",attrs:{tab:"解码器"}},[a("vab-monaco-plus",{ref:"monacoCode",attrs:{codes:e.ace_editor,language:"json","read-only":!0,theme:"vs-dark"}})],1),a("a-tab-pane",{key:"低代码",attrs:{tab:"低代码"}},[a("dgiot-views",{attrs:{"view-form":e.viewForm}})],1),a("a-tab-pane",{key:"组态",attrs:{tab:"组态"}},[a("el-empty",{attrs:{"image-size":200}})],1),a("a-tab-pane",{key:"规则",attrs:{tab:"规则"}},[a("el-empty",{attrs:{"image-size":200}})],1),a("a-tab-pane",{key:"字典",attrs:{tab:"字典"}},[a("dgiot-dict",{attrs:{"dict-form":e.dictForm}})],1)],1)],1)},l=[],o=a("fb07"),i=a("e97b"),n=a("d0d7"),s=a.n(n),c=(a("04d6"),a("e170"),a("5880")),d=a("c32d"),u=a.n(d),p=a("ef68"),m=a("0c3c"),f=a("c3b1"),b={name:"ProfileDescriptions",components:{dgiotViews:m["default"],dgiotDict:f["default"]},props:{thingKey:{required:!0,type:String,default:""},productId:{required:!0,type:String,default:""},tableLoading:{required:!1,type:Boolean,default:!1},dictTableList:{required:!1,type:Array,default:function(){return[]}},decoderTableList:{required:!1,type:Object,default:function(){}},parserTableList:{required:!1,type:Array,default:function(){return[]}},things:{required:!1,type:Array,default:function(){return[]}},tableType:{required:!0,type:String,default:""}},data:function(){return{dialogTopoVisible:!1,lowcodeLen:0,dictLen:0,viewForm:{},dictForm:{},amisconfig:[],amisForm:{},dialogTableVisible:!1,dialogDictVisible:!1,key:u()(new Date).valueOf(),editType:0,amisJsonPlus:"",ace_editor:"",codeFlag:!1,amisFlag:!1,activeName:"first",productDetail:{decoder:{code:""},thing:{properties:[]},config:{parser:[],profile:[],amis:[],basedate:{params:[]}}}}},computed:Object(i["a"])({},Object(c["mapGetters"])({amisJson:"amis/amisJson"})),watch:{amisJson:{deep:!0,handler:function(e){this.amisJsonPlus=JSON.stringify(e)}}},mounted:function(){var e=this;this.$dgiotBus.$off("lowcodeLen"),this.$dgiotBus.$on("lowcodeLen",(function(t){e.lowcodeLen=t})),this.$dgiotBus.$off("dictLen"),this.$dgiotBus.$on("dictLen",(function(t){e.dictLen=t}))},methods:Object(i["a"])(Object(i["a"])({handletabs:function(e){var t=this;return Object(o["a"])(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log("handletabs",e),t.viewForm={class:"ProductTemplet",type:"amis",key:t.productId,title:"",disabled:!0,data:{type:"page",initApi:{url:"iotapi/classes/Device/parse_objectid",method:"get",adaptor:'return {\r\n  "status":0,\r\n  "msg":"",\r\n  "data":response.data.basedata\r\n  }',headers:{store:"localStorage",dgiotReplace:"parse_objectid"},dataType:"json"},body:[{type:"form",api:{method:"put",url:"iotapi/classes/Device/parse_objectid",headers:{store:"localStorage",dgiotReplace:"parse_objectid"},dataType:"json",requestAdaptor:"return {\r\n    ...api,\r\n    data: {\r\n        basedata:{ ...api.data}\r\n    }\r\n}"},body:[{type:"input-text",label:"设备名称",name:"name"}]}]},hiddenRow:["class","key","createdAt"]},t.dictForm={class:"ProductTemplet",type:"",key:t.productId,title:"",disabled:!0,data:{params:[]},hiddenRow:["class","key","createdAt"]},a.t0=e,a.next="物模型"===a.t0?6:"解码器"===a.t0?9:"低代码"===a.t0?11:"组态"===a.t0?12:"规则"===a.t0?15:"字典"===a.t0?17:19;break;case 6:return a.next=8,t.featProperties(t.productDetail.thing.properties);case 8:return a.abrupt("break",19);case 9:return console.log("ace_editor",t.ace_editor),a.abrupt("break",19);case 11:return a.abrupt("break",19);case 12:return a.next=14,t.topoView();case 14:return a.abrupt("break",19);case 15:return t.openRule(),a.abrupt("break",19);case 17:return t.openDict(),a.abrupt("break",19);case 19:case"end":return a.stop()}}),a)})))()},openView:function(){this.dialogTableVisible=!0},topoView:function(){this.dialogTopoVisible=!0},openRule:function(){},openDict:function(){this.dialogDictVisible=!0},saveAmis:function(e,t,a){var r=this;return Object(o["a"])(s.a.mark((function l(){var o;return s.a.wrap((function(l){while(1)switch(l.prev=l.next){case 0:return o=_.merge(r.productDetail,{config:{amis:t}}),dgiotlog.log(e,t,a,o),l.next=4,Object(p["putProductTemplet"])(e,{config:r.productDetail.config});case 4:l.sent,r.$baseMessage(r.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),r.amisFlag=!1;case 7:case"end":return l.stop()}}),l)})))()},addAmis:function(){},handleEdit:function(e,t){this.amisForm=t,this.editType=e,dgiotlog.log(e,t),this.set_amisJson(t.json),this.amisFlag=!0},handleDelete:function(e,t){dgiotlog.log(e,t),this.amisconfig.splice(e,1)},cancelForm:function(){this.amisconfig[this.editType].json=this.amisJson,"add"==this.amisconfig[this.editType].type&&(this.amisconfig[this.editType].type="edit"),this.amisFlag=!1}},Object(c["mapMutations"])({set_amisJson:"amis/set_amisJson"})),{},{seeDecoder:function(e){dgiotlog.log(ace,"ace",this.ace_editor);var t=e.decoder,a=void 0===t?{}:t;this.dialogTableVisible=!1,this.dialogDictVisible=!1,this.codeFlag=!this.codeFlag,this.ace_editor=Base64.decode(a.code)},featProperties:function(e){dgiotlog.log(e),this.codeFlag=!1,this.dialogTableVisible=!1,this.dialogDictVisible=!1,this.$parent.$parent.$parent.properties(e)},feateditorParser:function(e,t,a){this.codeFlag=!1,this.dialogTableVisible=!1,this.dialogDictVisible=!1,this.$parent.$parent.$parent.editorParser(e,t,a)},createProperty:function(){this.$parent.$parent.$parent.createProperty()},deletewmx:function(e){this.$parent.$parent.$parent.deletewmx(e)},wmxDataFill:function(e,t){this.$parent.$parent.$parent.wmxDataFill(e,t)},goKonva:function(e){this.$parent.$parent.$parent.goKonva(e)},checkschema:function(){this.$parent.$parent.$parent.checkschema()}})},h=b,g=(a("911a"),a("bdd7")),v=Object(g["a"])(h,r,l,!1,null,"2fb4360a",null);t["default"]=v.exports},"590f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"application dgiot-container"}},[a("vab-query-form-top-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("application.applicationname"),size:"mini"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.getAppMange(0)}}},[e._v(" "+e._s(e.$translateTitle("application.search"))+" ")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.tableData,"header-cell-style":{"text-align":"center"},height:e.tableHeight}},[a("el-table-column",{attrs:{label:e.$translateTitle("application.applicationidentification"),prop:"productIdentifier"}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.applicationname"),prop:"title"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.Applicationunit"),prop:"userUnit"}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.scaleofservice"),prop:"scale",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.industrytype"),prop:"category"}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.createtime"),prop:"creation_time"}}),a("el-table-column",{attrs:{flex:"right",label:e.$translateTitle("developer.operation"),prop:"operation",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,l=t.$index;return[a("el-popover",{ref:"popover-"+l,attrs:{placement:"top",width:"300"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.qdsczg"))+e._s(r.name)+e._s(e.$translateTitle("equipment.yym"))+" ")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){r._self.$refs["popover-"+l].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.makeSure(e.scope,l)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-link",{attrs:{slot:"reference",icon:"el-icon-delete",type:"danger",underline:!1},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1),a("el-button",{attrs:{icon:"el-icon-edit",size:"small",type:"text"},on:{click:function(t){return e.handleClickUpdate(e.scope)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.Gotoproduct(e.scope)}}},[a("i",{staticClass:"el-icon-s-management"}),e._v(" "+e._s(e.$translateTitle("leftbar.management"))+" ")]),a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.applicationDeployment(r)}}},[e._v(" "+e._s(e.$translateTitle("developer.deploy"))+" ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.page.currentPage,layout:"total, sizes, prev, pager, next, jumper","page-size":e.page.pageSize,"page-sizes":e.page.pageSizes,total:e.page.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)},l=[],o=(a("16b8"),a("80ab"),a("a98c"),a("f1e1"),a("1285")),i=a("7212"),n=a("ed08"),s=a("1c4e"),c={data:function(){return{tableHeight:this.$baseTableHeight(0),label:"我的应用",activeName:"app",dialogVisible:!1,name:"",page:{currentPage:0,pageSizes:[10,20,30],pageSize:10,total:0},description:"暂无数据",tableData:[],isShow:!1,arr:[]}},created:function(){this.getAppMange()},methods:{handleClickVisit:function(e,t){var a=t,r=this.tableData[a].productIdentifier,l=window.location.origin+"/iot/"+r+"#/login";window.open(l,"__blank")},getAppMange:function(e){var t=this;0==e&&(this.page.currentPage=0),this.tableData=[];var a={};this.name&&(a.title=this.name),Object(s["getProject"])({limit:this.page.pageSize,skip:this.page.currentPage,count:"objectId",where:a}).then((function(e){var a=e.results;t.label="我的应用(".concat(e.count,")"),t.description="获取".concat(a.length,"条数据"),t.page.total=e.count;for(var r=0;r<a.length;r++){var l={};l.name=a[r].title,l.objectId=a[r].objectId,l.productIdentifier=a[r].productIdentifier,l.scale=Object(s["handleZero"])(a[r].scale),l.creation_time=Object(n["utc2beijing"])(a[r].createdAt),l.end_time=Object(n["utc2beijing"])(a[r].updatedAt),l.category=a[r].category,l.secret=a[r].secret,l.logo=a[r].logo,l.title=a[r].title,l.userUnit=a[r].userUnit,l.dashboard=a[r].dashboard,l.background=a[r].background,l.acl=a[r].ACL,l.desc=a[r].desc,l.copyright=a[r].copyright,t.tableData.push(l)}}))},handleSizeChange:function(e){this.page.pageSize=e,this.getAppMange()},handleCurrentChange:function(e){this.page.currentPage=(e-1)*this.page.pageSize,this.getAppMange()},handleClickLook:function(e,t){dgiotlog.log(e);var a='\n          <table\n              class="mailtable"\n              style="width:100%;"\n              border="0"\n              cellspacing="0"\n              cellpadding="0"\n            >\n              <tr>\n                  <td style="text-align:left;\n                  color: #74777a;\n                  font-weight: 400;\n                  background: #fafafc;\n                  width:200px;\n                  font-weight:bold;">App Id:</td>\n                  <td>'.concat(row.objectId,'</td>\n              </tr>\n              <tr ">\n                   <td style="color: #74777a;\n                  font-weight: 400;\n                  background: #fafafc;\n                  width:200px;\n                  padding-top:20px;\n                  font-weight:bold;">App Secret:\n                  </td>\n                  <td style="padding-top:20px;">').concat(row.secret,"</td>\n              </tr>\n              </table>\n          ");this.$alert(a,"应用详情",{dangerouslyUseHTMLString:!0})},handleClickUpdate:function(e){var t=e;dgiotlog.log("$row",t),this.$router.push({path:"/applicationManagement/addApp",query:{actionType:"update",title:"修改应用",name:t.name,scale:t.scale,creation_time:t.creation_time,end_time:t.end_time,category:t.category,productIdentifier:t.productIdentifier,secret:t.secret,objectId:t.objectId,logo:t.logo,userUnit:t.userUnit,dashboard:t.dashboard,background:t.background,desc:t.desc,copyright:t.copyright}})},makeSure:function(e,t){var a=this,r={count:"objectId",skip:0,limit:1,where:{product:row.objectId}};Object(o["queryDevice"])(r).then((function(r){r.count>0?a.$message("请先删除该产品下设备"):Object(i["getProduct"])(row.objectId).then((function(r){dgiotlog.log(r),Object(i["delProduct"])(row.objectId).then((function(r){r&&(a.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(t)].doClose(),a.getAppMange())})).catch((function(e){dgiotlog.log("delProduct ",e.error)}))})).catch((function(e){dgiotlog.log("getProduct ",e.error)}))})).catch((function(e){dgiotlog.log("queryDevice ",e.error)}))},Gotoproduct:function(e){var t=[];for(var a in row.acl)dgiotlog.log(a.substring(5)),t.push(a.substring(5));this.$store.dispatch("setProjectRole",t),this.$router.push({path:"/roles/product",query:{project:row.objectId}})},serverlictool:function(e){dgiotlog.log(e),this.$router.push({path:"/roles/server_control",query:{appid:e.objectId,appsecret:e.secret}})},applicationDeployment:function(e){var t=this;e.name?Object(s["setUpLictool"])(e.name).then((function(e){e&&t.$message("正在部署中")})).catch((function(e){t.$message(e)})):this.$message("没有应用名")}}},d=c,u=(a("9e8e"),a("bdd7")),p=Object(u["a"])(d,r,l,!1,null,"02546292",null);t["default"]=p.exports},5959:function(e,t,a){"use strict";a("af11")},"59ef":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logs logs-container",class:{"vab-fullscreen":e.isFullscreen}},[a("vab-query-form",[a("vab-query-form-top-panel",[e.$loadsh.isEmpty(e.queryForm)?e._e():a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"80px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("device.tracetype")}},[a("el-select",{model:{value:e.queryForm.tracetype,callback:function(t){e.$set(e.queryForm,"tracetype",t)},expression:"queryForm.tracetype"}},e._l(e.traceData,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("device.action")}},[a("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","active-text":e.$translateTitle("device.start"),"active-value":"start","inactive-color":"#ff4949","inactive-text":e.$translateTitle("device.stop"),"inactive-value":"stop"},on:{change:e.starttrace},model:{value:e.queryForm.action,callback:function(t){e.$set(e.queryForm,"action",t)},expression:"queryForm.action"}})],1),a("el-form-item",[a("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[a("dgiot-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),a("el-popover",{directives:[{name:"show",rawName:"v-show",value:e.scroketMsg.length,expression:"scroketMsg.length"}],attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[a("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}],null,!1,2370876510)},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("vue-draggable",e._b({attrs:{list:e.logcolumns}},"vue-draggable",e.dragOptions,!1),e._l(e.logcolumns,(function(t,r){return a("div",{key:t+r},[a("dgiot-icon",{attrs:{icon:"drag-drop-line"}}),a("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t}},[e._v(" "+e._s(t)+" ")])],1)})),0)],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("device.topic"),prop:"product"}},[a("el-select",{model:{value:e.instructtopic,callback:function(t){e.instructtopic=t},expression:"instructtopic"}},e._l(e.producttopic,(function(e,t){return a("el-option",{key:t,attrs:{label:e.topic,value:e.topic}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("device.instruct"),prop:"product"}},[a("el-input",{model:{value:e.instruct,callback:function(t){e.instruct=t},expression:"instruct"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sendinstruct()}}},[e._v(" "+e._s(e.$translateTitle("device.sendinstruct"))+" ")])],1)],1)],1)],1),a("a-tabs",{attrs:{"default-active-key":"editor"}},[a("a-tab-pane",{key:"editor"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("dgiot-icon",{attrs:{icon:"aspect-ratio-fill"}}),e._v(" "+e._s(e.$translateTitle("Logs.console"))+" ")],1),a("vab-editor",{key:e.logMqtt.key,attrs:{height:e.isFullscreen?1080:1040,lang:"json","max-lines":(e.isFullscreen,1e3/12),"min-lines":(e.isFullscreen,1e3/12),theme:"gob"},model:{value:e.clickItem,callback:function(t){e.clickItem=t},expression:"clickItem"}})],1),a("a-tab-pane",{key:"table"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("dgiot-icon",{attrs:{icon:"table-2"}}),e._v(" "+e._s(e.$translateTitle("Logs.table"))+" ")],1),a("el-table",{key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"logs-table",attrs:{border:"",data:e.scroketMsg,"default-expand-all":"",height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[e._l(e.finallyColumns,(function(t,r){return a("el-table-column",{key:r,attrs:{align:"center",label:t,prop:t,"show-overflow-tooltip":"",sortable:"",width:e.w80.includes(t)?80:e.Wh120.includes(t)?120:"auto"}})})),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2}},[a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{directives:[{name:"copy",rawName:"v-copy",value:t.row.msg,expression:"props.row.msg"}],staticClass:"el-icon-copy-document"})]),e._v(" "+e._s(t.row.msg)+" ")],2)],1)]}}])})],2),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)],1)],1)},l=[],o=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("1d17"),a("98da"),a("e170"),a("04d6"),a("bb22")),i=a("7212"),n={name:"SceneLog",props:{name:{type:String,required:!0,default:"name"},deviceInfo:{type:Object,required:!0,default:function(){return{}}}},data:function(){return{instruct:"",instructtopic:"",producttopic:[],productId:"",ttl:108e5,topicKey:"",topic:"",logMqtt:{channeltopic:"",key:moment(new Date).valueOf()},subtopic:"",router:"",scroketMsg:[],clickItem:"",isFullscreen:!1,height:this.$baseTableHeight(0),logdata:[],momentKey:moment(new Date).valueOf(),checkList:["time","topic","pid","peername"],logcolumns:["topic","time","pid","peername","msg","level","gl","clientid","mfa"],fold:!0,w80:["line","level"],Wh120:["pid","domain","gl"],Wh200:["time","clientid","peername"],leverData:["debug","info","notice","warning","error","crtical","alert","emergency"],actionData:["start","stop"],traceData:["clientid","topic"],queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"info",logfile:"test.txt",order:1,action:"start",tracetype:"clientid"}}},computed:{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.logcolumns.filter((function(t){return e.checkList.includes(t)}))}},watch:{"deviceInfo.product.objectId":{handler:function(e){e&&(this.productId=e)},deep:!0,limit:!0},name:{handler:function(e){"task"==e&&this.queryTable()},deep:!0,limit:!0}},mounted:function(){this.router=this.$dgiotBus.router(location.href+this.$route.fullPath),this.get_topic()},created:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{get_topic:function(){var e=this;dgiotlog.log("this.deviceInfo",this.deviceInfo),Object(i["getProduct"])(this.deviceInfo.product.objectId).then((function(t){e.producttopic=t.topics}))},sendinstruct:function(){var e=this.instructtopic.replace("${DevAddr}",this.deviceInfo.devaddr);this.$dgiotBus.$emit("MqttPublish",e,this.instruct,0,!1)},handleHeight:function(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName:function(e){var t=e.row;return t.disabled?"disabled":""},rowDrop:function(){var e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd:function(e){var a=e.newIndex,r=e.oldIndex,l=t.logdata.splice(r,1)[0];t.logdata.splice(a,0,l)}})},columnDrop:function(){var e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:function(t){var a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout((function(){e.rowDrop(),e.columnDrop()}),1500)}})},starttrace:function(e){dgiotlog.log("aaa",e),this.queryForm.action=e,this.queryTable()},queryTable:function(){var e=this;this.scroketMsg=[],this.clickItem="",this.queryForm.deviceid=this.deviceInfo.objectId,"start"==this.queryForm.action&&(this.subtopic="logger_trace/trace/"+this.deviceInfo.objectId+"/#"),this.topicKey=this.$dgiotBus.topicKey(this.router,this.subtopic),this.$dgiotBus.$emit("MqttSubscribe",{router:this.router,topic:this.subtopic,qos:0,ttl:108e5}),this.$dgiotBus.$off("".concat(this.topicKey)),this.$dgiotBus.$on("".concat(this.topicKey),(function(t){t.payload&&(e.scroketMsg.unshift(JSON.parse(t.payload)),e.logMqtt.key=e.topicKey,e.clickItem=JSON.stringify(e.scroketMsg,null,2))})),"stop"==this.queryForm.action&&this.MqttUnbscribe();var t=this.$baseColorfullLoading(),a=this.queryForm,r=a.level,l=a.action,i=a.order,n=a.deviceid,s=a.tracetype,c="clientid"==this.queryForm.tracetype?this.queryForm.deviceid:this.queryForm.topic;try{t.close();var d={level:r,action:l,order:i,handle:c,tracetype:s,deviceid:n};Object(o["postTrace"])(d).then((function(t){dgiotlog.log(t);var a=t.code,r=void 0===a?0:a,l=t.error,o=void 0===l?"":l;t.msg;200==r?e.$baseMessage(e.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"):e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(o),"error","vab-hey-message-error")})).catch((function(t){dgiotlog.error(t),e.$baseMessage(e.$translateTitle("alert.Data request error")+"".concat(t),"error","vab-hey-message-error")})),t.close()}catch(u){t.close(),dgiotlog.log(u),this.$baseMessage(this.$translateTitle("alert.Data request error")+"".concat(u),"error","vab-hey-message-error")}this.momentKey=moment(new Date).valueOf()},MqttUnbscribe:function(){this.$dgiotBus.$emit("MqttUnbscribe",this.topicKey,this.subtopic)}}},s=n,c=(a("cd14"),a("5959"),a("bdd7")),d=Object(c["a"])(s,r,l,!1,null,"608b1073",null);t["default"]=d.exports},"5dbb":function(e,t,a){"use strict";a("4b04")},"5f5d":function(e,t,a){"use strict";a("2238")},6818:function(e,t,a){var r={"./ProductTemplet.vue":"0238","./ProfileDescriptions.vue":"4c00","./ProfileDict.vue":"d815","./ProfileDrawer.vue":"df9c"};function l(e){var t=o(e);return a(t)}function o(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}l.keys=function(){return Object.keys(r)},l.resolve=o,e.exports=l,l.id="6818"},"6ac7":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"editdevices"},[a("div",[a("el-tabs",{on:{"tab-click":e.tabHandleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.deviceinformation"),name:"first"}},[a("info",{attrs:{devicedetail:e.deviceInfo}}),a("el-card",[a("vab-baidu-map",{ref:"map",attrs:{bmLabel:e.bmLabel,label:e.mapLabel,navShow:!0,scaleShow:!0,mapCenter:e.mapLabel.position}})],1)],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.realTime data"),name:"first1"}},[a("div",[a("div",{staticClass:"thirdtb"},[a("el-row",{key:e.thirdtbKey},e._l(e.machinelist,(function(t,r,l){return a("el-col",{key:l,attrs:{span:24}},[a("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"never"}},[a("div",{staticStyle:{padding:"14px"}},[a("span",{staticStyle:{"font-size":"30px"}},[e._v(e._s(r))]),t.length?a("ul",{staticStyle:{display:"flex","flex-wrap":"wrap"}},e._l(t,(function(t,r){return a("li",{key:r,staticClass:"updatedtable"},[a("div",{staticStyle:{height:"70px"}},[a("span",{staticStyle:{"font-size":"16px"}},[e._v(e._s(t.name))]),a("span",{staticStyle:{float:"right","margin-top":"10px","margin-right":"15px"}},[a("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.imgurl}},[a("div",{staticClass:"image-slot",staticStyle:{width:"60px",height:"60px"},attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1)]),a("div",{staticClass:"stla"},[a("span",{attrs:{title:e._f("filterVal")(t.number)}},[e._v(" "+e._s(e._f("filterVal")(t.number))+" ")]),t.unit?a("span",{attrs:{title:t.unit}},[e._v(" "+e._s(t.unit)+" ")]):e._e()]),a("div",{staticClass:"ta"},[a("span",{staticClass:"fontSize"},[e._v(" "+e._s(e.$translateTitle("equipment.updatetime")+":")+" ")]),a("span",{staticClass:"fontSize",on:{click:function(t){return e.print(e.machinelist)}}},[e._v(" "+e._s(t.time)+" ")])])])})),0):e._e()])])],1)})),1)],1)])]),a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.historical data"),name:"third"}},[a("div",{staticStyle:{"box-sizing":"border-box",padding:"10px",background:"#ffffff"}},[a("div",{staticClass:"chartsinfo"},[a("div",{staticClass:"queryHeader",style:{height:"desktop"==e.Device?"50px":"240px"}},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"desktop"==e.Device?"80px":"70px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.startTime")}},[a("el-date-picker",{staticStyle:{width:"83%"},attrs:{"picker-options":e.pickerOptionsDay,placeholder:e.$translateTitle("developer.startTime"),align:"right",size:"mini",type:"datetime"},model:{value:e.params.startTime,callback:function(t){e.$set(e.params,"startTime",t)},expression:"params.startTime"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.EndTime")}},[a("el-date-picker",{staticStyle:{width:"83%"},attrs:{clearable:!1,"picker-options":e.pickerOptionsDay,placeholder:e.$translateTitle("developer.EndTime"),align:"right",size:"mini",type:"datetime"},model:{value:e.params.endTime,callback:function(t){e.$set(e.params,"endTime",t)},expression:"params.endTime"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.type")}},[a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择",size:"mini"},on:{change:e.toggleChart},model:{value:e.params.style,callback:function(t){e.$set(e.params,"style",t)},expression:"params.style"}},e._l(e.chartType,(function(t,r){return a("el-option",{key:r,attrs:{disabled:-1!=e.disabledChart.indexOf(t.type),label:t.name,value:t.type}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.interval")}},[a("el-input-number",{staticStyle:{width:"100px"},attrs:{min:1,placeholder:"请输入内容",size:"mini"},model:{value:e.params.number,callback:function(t){e.$set(e.params,"number",t)},expression:"params.number"}}),a("el-select",{staticStyle:{width:"70px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.params.interval,callback:function(t){e.$set(e.params,"interval",t)},expression:"params.interval"}},e._l(e.interval,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.type}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.function")}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.params._function,callback:function(t){e.$set(e.params,"_function",t)},expression:"params._function"}},e._l(e.functionarr,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1),a("el-button",{attrs:{disabled:e.queryFlag,icon:"el-icon-search",size:"mini",type:"primary"},on:{click:e.queryChart}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1)],1)],1)],1),a("div",{key:e.chartKey,staticClass:"chartsmain"},[a("vabChart",{ref:"charts",attrs:{"after-config":e.afterConfig,data:e.chartData,"data-empty":e.dataEmpty,"data-zoom":e.chartDataZoom,extend:e.chartExtend,loading:e.loading,"set-option-opts":!1,settings:e.chartSettings,toolbox:e.toolbox,type:e.params.style}})],1),a("div",{staticClass:"chartOther"},[a("el-row",{attrs:{gutter:20}},[e._l(e.chartData.child,(function(t,r){return a("el-col",{directives:[{name:"show",rawName:"v-show",value:"日期"!=t.columns[1],expression:"item.columns[1] != '日期'"}],key:r,attrs:{md:e.md,sm:e.sm,xl:e.xl,xs:e.xs}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.columns[1])+" : "+e._s(t.unit))]),a("el-button-group",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[a("el-button",{attrs:{icon:"el-icon-warning-outline"}}),a("el-button",{attrs:{icon:"el-icon-full-screen"},on:{click:function(t){return e.toggleCardRow(r,e.xs,e.sm,e.md,e.xl)}}})],1)],1),a("vabChart",{ref:"charts",refInFor:!0,attrs:{"after-config":e.afterConfig,data:e.chartData.child[r],"data-empty":e.dataEmpty,"data-zoom":e.chartDataZoom,extend:e.chartExtend,"legend-visible":!1,loading:e.loading,"set-option-opts":!1,settings:e.chartSettings,toolbox:e.toolbox,type:e.params.style,height:"300px"}})],1)],1)})),a("el-col",{directives:[{name:"show",rawName:"v-show",value:!e.chartData.child,expression:"!chartData.child"}],attrs:{span:24}},[a("vab-empty")],1)],2)],1)])]),a("div",{staticClass:"twofirsttable",staticStyle:{"box-sizing":"border-box",padding:"10px","margin-top":"20px",background:"#ffffff"}})]),"0"!=e.$route.query.nodeType?a("el-tab-pane",{attrs:{label:e.$translateTitle("equipment.subdevice"),name:"children"}},[a("div",{staticClass:"childrendevices"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.childrendevices,size:"small"}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.devicenumber")+":"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("equipment.devicenumber")},model:{value:e.childrendevices.devicesname,callback:function(t){e.$set(e.childrendevices,"devicesname",t)},expression:"childrendevices.devicesname"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.getDevices(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{disabled:0==e.multipleTable.length,type:"primary"},on:{click:e.deleteDevcie}},[e._v(" "+e._s(e.$translateTitle("equipment.RelievingAssociation"))+" ")]),a("el-button",{attrs:{disabled:0==e.multipleTable.length,type:"primary"},on:{click:e.unactiveDevice}},[e._v(" "+e._s(e.$translateTitle("developer.prohibit"))+" ")]),a("el-button",{attrs:{disabled:0==e.multipleTable.length,type:"primary"},on:{click:e.activeDevice}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{plain:"",type:"info"}},[e._v(" "+e._s(e.$translateTitle("equipment.Refresh"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.childDialog=!0}}},[e._v(" "+e._s(e.$translateTitle("equipment.addchilddevice"))+" ")])],1)],1),a("div",{staticClass:"devicetable"},[a("el-table",{ref:"filterTable",staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.devicesTableData,height:e.$baseTableHeight(0)-120},on:{"selection-change":e.DevicesSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicenumber"),align:"center",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.devaddr))])]}}],null,!1,3690553824)}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.devicename"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.name))])]}}],null,!1,2611166627)}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.state"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{class:r.status},[e._v(" "+e._s(r.status)+" ")])]}}],null,!1,2814795006)}),a("el-table-column",{attrs:{align:"center",label:"子网地址",width:"165"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(" "+e._s(void 0==r.route?"":r.route[e.deviceInfo.devaddr])+" ")])]}}],null,!1,22614245)}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.product"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{attrs:{type:"success"}},[e._v(e._s(r.productName))])]}}],null,!1,2863909087)}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.prohibit")+"/"+e.$translateTitle("developer.enable"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;t.$index;return[a("el-switch",{attrs:{"active-color":"#5eb058","inactive-color":"#cccccc"},on:{change:function(t){return e.handelUpdate(t,r.$index)}},model:{value:r.isEnable,callback:function(t){e.$set(r,"isEnable",t)},expression:"row.isEnable"}})]}}],null,!1,1514546268)}),a("el-table-column",{attrs:{label:e.$translateTitle("equipment.lastonlinetime"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.lastOnlineTime?a("span",[e._v(" "+e._s(e.timestampToTime(r.lastOnlineTime))+" ")]):a("span",[e._v("—")])]}}],null,!1,1578731938)}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,l=t.$index;return[a("el-link",{attrs:{underline:!1,icon:"el-icon-view",type:"primary"},on:{click:function(t){return e.deviceToDetail(r)}}},[e._v(" "+e._s(e.$translateTitle("equipment.see"))+" ")]),a("el-popover",{ref:"popover-"+l,attrs:{placement:"top",width:"300"}},[a("p",[e._v("确定解除这个"+e._s(r.name)+"设备关联吗？")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){r._self.$refs["popover-"+l].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.makeSure(r,l)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-link",{attrs:{slot:"reference",underline:!1,icon:"el-icon-delete",type:"danger"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("equipment.RelievingAssociation"))+" ")])],1)]}}],null,!1,252348488)})],1)],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-size":e.childrenDeviceLength,"page-sizes":[10,20,30,50],total:e.childrenDeviceTotal,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.childrenDeviceCurrentChange,"size-change":e.childrenDeviceSizeChange}})],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("equipment.addchilddevice"),visible:e.childDialog,width:"30%"},on:{"update:visible":function(t){e.childDialog=t}}},[a("div",{staticClass:"childdialog"},[a("el-form",{ref:"childrenForm",staticClass:"demo-form-inline",attrs:{model:e.childrenForm}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.products"),rules:[{required:!0,message:"选择产品",trigger:"change"}],prop:"product"}},[a("el-select",{attrs:{placeholder:e.$t("equipment.products")},on:{change:e.checkProduct},model:{value:e.childrenForm.product,callback:function(t){e.$set(e.childrenForm,"product",t)},expression:"childrenForm.product"}},e._l(e.allProudct,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.equipment"),rules:[{required:!0,message:"选择设备",trigger:"change"}],prop:"device"}},[a("el-select",{directives:[{name:"el-select-loadmore",rawName:"v-el-select-loadmore",value:e.loadmore,expression:"loadmore"}],attrs:{disabled:!e.ischange,placeholder:e.$t("product.equipment")},model:{value:e.childrenForm.device,callback:function(t){e.$set(e.childrenForm,"device",t)},expression:"childrenForm.device"}},e._l(e.productDevices,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"请输入子网地址",trigger:"blur"}],label:"子网地址",prop:"route"}},[a("el-input",{attrs:{placeholder:"子网地址"},model:{value:e.childrenForm.route,callback:function(t){e.$set(e.childrenForm,"route",t)},expression:"childrenForm.route"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.childDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitDevice("childrenForm")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1):e._e(),e.isshowchild?a("el-tab-pane",{attrs:{label:e.$translateTitle("device.instruct"),name:"instruct"}},[a("Instruct",{attrs:{"devices-id":e.deviceid,"product-id":e.productid}})],1):e._e(),a("el-tab-pane",{directives:[{name:"show",rawName:"v-show",value:"task"==e.activeName,expression:"activeName == 'task'"}],attrs:{label:e.$translateTitle("device.trace"),name:"task"}},[a("scene-log",{ref:"SceneLog",attrs:{"device-info":e.deviceInfo,name:e.activeName}})],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("device.log"),name:"trace"}},[a("device-log",{directives:[{name:"show",rawName:"v-show",value:"trace"==e.activeName,expression:"activeName == 'trace'"}],attrs:{devaddr:e.devicedevaddr,deviceid:e.deviceid,"is-device-info":!0,productid:e.productId}})],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("device.alert"),name:"alert"}},[a("vab-empty")],1)],1)],1)])},l=[],o=a("68d7"),i=(a("bbce"),a("e346"),a("bdd7")),n=Object(i["a"])(o["a"],r,l,!1,null,"d178ff76",null);t["default"]=n.exports},"6bff":function(e,t,a){"use strict";a("fefe")},"6e60":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tab-pane",{attrs:{label:"物解析",name:"fourth"}},[a("div",{staticClass:"protolheader"},[a("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,rules:e.addRules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.protocolname"),prop:"name"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.protocolname")},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("plugins.version")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("plugins.version")},model:{value:e.formInline.version,callback:function(t){e.$set(e.formInline,"version",t)},expression:"formInline.version"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("developer.describe")},model:{value:e.formInline.desc,callback:function(t){e.$set(e.formInline,"desc",t)},expression:"formInline.desc"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.subAce("formInline",!0)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.subAce1("formInline")}}},[e._v(" 设为公共 ")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.chaxun}},[e._v(" "+e._s(e.$translateTitle("product.publicagreementlibrary"))+" ")])],1),a("el-form-item",{staticStyle:{display:"block"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.protol}},[e._v(" "+e._s(e.$translateTitle("product.compile"))+" ")]),a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.updatesubdialog}},[e._v(" 热加载 ")])],1)],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:"通道热加载",visible:e.protoldialog,width:"50%"},on:{"update:visible":function(t){e.protoldialog=t}}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.protolchannel,"row-class-name":e.getChannelEnable},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s("channel/"+r.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1==r.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.cType))])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updateAllChannel.apply(null,arguments)}}},[e._v(" 确定 ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.publicagreementlibrary"),visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.gridData}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.protocolname")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.data.name))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.data.version))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.data.desc))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(e.utc2beijing(r.createdAt)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editordata(r)}}},[e._v(" "+e._s(e.$translateTitle("product.clone"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deletedata(r.objectId)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("div",{staticClass:"elpagination",staticStyle:{padding:"20px 0"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.decoderlength,"page-sizes":[10,20,30,50],total:e.decodertotal},on:{"current-change":e.devicerCurrentChange,"size-change":e.decoderSizeChange}})],1)],1),a("div",[a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"600px","margin-bottom":"0"},attrs:{id:"editor"}},[a("textarea",{staticClass:"ace_text-input"})]),a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("div",{staticStyle:{padding:"5px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[a("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[a("textarea",{staticClass:"ace_text-input"})])])],1)],1)},l=[],o={components:{},data:function(){return{formInline:{name:"",version:"",desc:"",resource:!1}}},computed:{},methods:{}},i=o,n=(a("5f5d"),a("bdd7")),s=Object(n["a"])(i,r,l,!1,null,"ed9dc2b2",null);t["default"]=s.exports},"7062a":function(e,t,a){"use strict";a("8607")},"72ce":function(e,t,a){"use strict";a("291e")},"77f9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},l=[],o=(a("1c6f"),a("b037"),a("3dec"),a("4656"),a("ed08")),i={props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0}},data:function(){return{chart:null,sidebarElm:null}},mounted:function(){var e=this;this.initChart(),this.autoResize&&(this.__resizeHandler=Object(o["debounce"])((function(){e.chart&&e.chart.resize()}),100),window.addEventListener("resize",this.__resizeHandler)),this.sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.sidebarElm&&this.sidebarElm.addEventListener("transitionend",this.sidebarResizeHandler)},beforeDestroy:function(){this.chart&&(this.autoResize&&window.removeEventListener("resize",this.__resizeHandler),this.sidebarElm&&this.sidebarElm.removeEventListener("transitionend",this.sidebarResizeHandler),this.chart.dispose(),this.chart=null)},methods:{sidebarResizeHandler:function(e){"width"===e.propertyName&&this.__resizeHandler()},setOptions:function(){var e=[100,80,60,40],t=["拱墅区","余杭区","西湖区","江干区"],a=[683,523,240,234];this.chart.setOption({xAxis:{show:!1},yAxis:[{show:!0,data:t,inverse:!0,axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"black",formatter:function(e,t){return[e].join("\n")},show:!0,margin:-10,align:"left",verticalAlign:"bottom",padding:[0,0,15,0],fontSize:16,rich:{lg:{backgroundColor:"#339911",color:"green",borderRadius:10,align:"center",width:15,height:15}}}},{show:!0,inverse:!0,data:a,axisLabel:{textStyle:{fontSize:20,color:"#339911"}},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}}],series:[{name:"条",type:"bar",yAxisIndex:0,data:e,barWidth:30,itemStyle:{normal:{barBorderRadius:30,color:function(e){return"#"+("00000"+(16777215*Math.random()+.5>>0).toString(16)).slice(-6)}}},label:{normal:{show:!1,position:"inside",formatter:"{c}%"}}},{name:"框",type:"bar",yAxisIndex:1,barGap:"-100%",data:[100,100,100,100],barWidth:30,itemStyle:{normal:{color:"none",borderColor:"#cccccc",margin:[10,0],borderWidth:2,barBorderRadius:15}}}]})},initChart:function(){this.chart=echarts.init(this.$el,"macarons"),this.setOptions()}}},n=i,s=a("bdd7"),c=Object(s["a"])(n,r,l,!1,null,null,null);t["default"]=c.exports},"7dd9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"instruct"},[a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",[a("el-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入指令名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.Instruct(0)}}},[e._v("查询")])],1)],1)],1),a("div",{staticClass:"instruct_button"},[a("div",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.dialogBtn_em("form","3",e.form)}}},[e._v(" 新增指令 ")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.deleteAll}},[e._v(" 删 除 ")])],1),a("div",[a("el-button",{attrs:{size:"small",type:"success"}},[e._v("启 用")]),a("el-button",{attrs:{size:"small",type:"warning"}},[e._v("禁 用")])],1)]),a("div",{staticClass:"instruct_table"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.instructData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:"指令名称",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.name)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"指令类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return["Read"==r.op?a("el-tag",{attrs:{type:"primary"}},[e._v("读")]):a("el-tag",{attrs:{type:"success"}},[e._v("写")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"指令标识"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.di)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"指令序号",prop:"order"}}),a("el-table-column",{attrs:{align:"center",label:"超时时长"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.duration+"秒")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"子网编号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.pn)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"生效轮次"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.rotation)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"是否启用",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.enable?a("el-tag",{attrs:{type:"success"}},[e._v("是")]):a("el-tag",{attrs:{type:"danger"}},[e._v("否")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.dialogBtn_em("","2",r)}}},[e._v(" 编 辑 ")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.deleteInstruct(r.objectId)}}},[e._v(" 删 除 ")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.pagesize,"page-sizes":[10,20,30,40],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.dialogTitle+"指令",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},open:e.openDialog}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formrule,size:"small"}},[a("h4",[e._v("  指令信息")]),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"指令名称","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入指令名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"操作类型","label-width":e.formLabelWidth,prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择操作类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{attrs:{label:"读",value:"r"}}),a("el-option",{attrs:{label:"写",value:"w"}})],1)],1),a("el-form-item",{attrs:{label:"是否启用","label-width":e.formLabelWidth,prop:"enable"}},[a("el-radio-group",{model:{value:e.form.enable,callback:function(t){e.$set(e.form,"enable",t)},expression:"form.enable"}},[a("el-radio",{attrs:{label:!0}},[e._v("是")]),a("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"指令指标","label-width":e.formLabelWidth,prop:"pointer"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入指令指标"},model:{value:e.form.pointer,callback:function(t){e.$set(e.form,"pointer",t)},expression:"form.pointer"}})],1),a("el-form-item",{attrs:{label:"指令序号","label-width":e.formLabelWidth,prop:"order"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入指令序号"},model:{value:e.form.order,callback:function(t){e.$set(e.form,"order",t)},expression:"form.order"}})],1),a("p",{staticStyle:{"padding-left":"125px","font-size":"12px","line-height":"20px"}},[e._v(" 1. 指令序号相同,会作为同一组消息发送 "),a("br"),e._v(" 2. 消息的发送顺序按照指令序号排序 ")])],1)],1),a("h4",[e._v("  指令下发策略")]),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"超时时长","label-width":e.formLabelWidth,prop:"duration"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入超时时长"},model:{value:e.form.duration,callback:function(t){e.$set(e.form,"duration",e._n(t))},expression:"form.duration"}},[a("template",{slot:"append"},[e._v("秒")])],2)],1),a("el-form-item",{attrs:{label:"生效轮次","label-width":e.formLabelWidth,prop:"rotation"}},[a("el-select",{attrs:{"allow-create":"",clearable:"","default-first-option":"",filterable:"",placeholder:"请选择生效轮次"},model:{value:e.form.rotation,callback:function(t){e.$set(e.form,"rotation",t)},expression:"form.rotation"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("p",{staticStyle:{position:"absolute",top:"40px",margin:"0","font-size":"12px",color:"black"}},[e._v(" 例如:1,3,5,8;(可选可自主填写)(注意:逗号为英文逗号) ")])],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"子网编号","label-width":e.formLabelWidth,prop:"subnet"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入子网编号"},model:{value:e.form.subnet,callback:function(t){e.$set(e.form,"subnet",t)},expression:"form.subnet"}})],1),a("el-form-item",{attrs:{label:"发送间隔","label-width":e.formLabelWidth,prop:"interval"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入发送间隔"},model:{value:e.form.interval,callback:function(t){e.$set(e.form,"interval",e._n(t))},expression:"form.interval"}},[a("template",{slot:"append"},[e._v("秒")])],2)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.check("form")}}},[e._v(" 确 定 ")])],1)],1)],1)},l=[],o=a("fb07"),i=a("d0d7"),n=a.n(i),s=(a("16b8"),a("c4bc"),a("e0e9")),c={name:"Instruct",props:{productId:{type:String,default:""},devicesId:{type:String,default:""}},data:function(){return{formInline:{name:""},options:[{value:"first",label:"第一轮"},{value:"last",label:"最后一轮"},{value:"all",label:"全部"}],instructData:[],multipleTable:[],pagesize:10,start:0,total:0,dialogFormVisible:!1,formLabelWidth:"120px",form:{name:"",pointer:"",type:"",enable:"",duration:"",order:"",interval:"",rotation:"",subnet:""},formrule:{duration:[{required:!0,message:"请输入",trigger:"blur"}],interval:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"指标名称不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择操作类型",trigger:"blur"}],enable:[{required:!0,message:"指标是否启用不能为空",trigger:"change"}],order:[{required:!0,message:"指标序号不能为空",trigger:"blur"}],rotation:[{required:!0,message:"生效轮次不能为空",trigger:"change"}],subnet:[{required:!0,message:"子网编号不能为空",trigger:"blur"}],pointer:[{required:!0,message:"指令指标不能为空",trigger:"blur"}]},instructid:"",dialogTitle:"新增"}},watch:{dialogFormVisible:{handler:function(e){e||(this.$refs.form.resetFields(),dgiotlog.log(e))},deep:!0},devicesId:{handler:function(e){dgiotlog.log(e)},deep:!0}},mounted:function(){this.Instruct()},updated:function(){},methods:{dialogClosed:function(){this.dialogFormVisible=!1},openDialog:function(e,t,a){var r=this;this.$nextTick((function(){switch(r.$refs[e]&&r.$refs[e].resetFields(),t){case"2":r.dialogTitle="编辑",r.form=a;break;case"3":r.dialogTitle="添加";break;default:break}}))},Instruct:function(){var e=arguments,t=this;return Object(o["a"])(n.a.mark((function a(){var r,l,o,i,c,d,u;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:9,0==r&&(t.start=0),l={where:{device:t.devicesId},skip:t.start,limit:t.pagesize,order:"-createdAt",count:"objectId"},t.formInline.name&&(l.where.name=t.formInline.name),a.next=6,Object(s["queryIndustry"])(l);case 6:o=a.sent,i=o.count,c=void 0===i?0:i,d=o.results,u=void 0===d?[]:d,t.total=c,t.instructData=u;case 13:case"end":return a.stop()}}),a)})))()},addInstruct:function(){this.dialogFormVisible=!0,this.$refs.form.resetFields()},check:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(o["a"])(n.a.mark((function e(a){var r,l,o,i;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r={className:"Product",objectId:t.productId,__type:"Pointer"},l={className:"Device",objectId:t.devicesId,__type:"Pointer"},!a){e.next=17;break}if(o={device:l,product:r,name:t.form.name,enable:t.form.enable,op:t.form.type,rotation:t.form.rotation,duration:t.form.duration,order:t.form.order,interval:t.form.interval,di:t.form.pointer,pn:t.form.subnet,devaddr:t.form.lowerhair},""==t.instructid){e.next=10;break}return e.next=7,Object(s["updateIndustry"])(t.instructid,o);case 7:i=e.sent,e.next=14;break;case 10:return o.ACL=t.$aclObj,e.next=13,Object(s["postIndustry"])(o);case 13:i=e.sent;case 14:i.objectId&&(t.$message({type:"success",message:"".concat(t.dialogTitle,"成功")}),t.$refs.form.resetFields(),t.dialogClosed(),t.instructid="",t.Instruct()),e.next=19;break;case 17:return t.$message("有必填项未填写"),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleSizeChange:function(e){this.pagesize=e,this.Instruct()},handleCurrentChange:function(e){this.start=(e-1)*this.pagesize,this.Instruct()},dialogBtn_em:function(e,t,a){this.dialogFormVisible=!0;var r,l={};2==t?(r={name:a.name,pointer:a.di,type:a.op,enable:a.enable,duration:a.duration,order:a.order,interval:a.interval,lowerhair:a.devaddr,rotation:a.rotation,subnet:a.pn},l=Object.assign({},r),this.instructid=a.objectId):(dgiotlog.log(a),l=Object.assign({},a)),this.openDialog(e,t,l)},deleteInstruct:function(e){var t=this;this.$confirm("此操作将永久删除该指令, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(n.a.mark((function a(){var r;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["delIndustry"])(e);case 2:r=a.sent,r&&(t.$message({type:"success",message:"删除成功!"}),t.Instruct());case 4:case"end":return a.stop()}}),a)})))).catch((function(){}))},handleSelectionChange:function(e){this.multipleTable=e},deleteAll:function(e){var t=this;return Object(o["a"])(n.a.mark((function e(){var a,r,l;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=t.multipleTable.length){e.next=5;break}return t.$message({message:"请挑选要删除的指令",type:"warning"}),e.abrupt("return");case 5:return a=[],t.multipleTable.map(function(){var e=Object(o["a"])(n.a.mark((function e(t){return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.push({body:{},method:"DELETE",path:"/classes/Instruct/".concat(t.objectId)});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r={requests:a},e.next=10,t.$shuwa_batch(r);case 10:l=e.sent,l.error?t.$message({message:"删除失败".concat(l.error),type:"error"}):(t.$message({message:"删除成功",type:"success"}),t.Instruct());case 12:case"end":return e.stop()}}),e)})))()}}},d=c,u=(a("5dbb"),a("bdd7")),p=Object(u["a"])(d,r,l,!1,null,"07663408",null);t["default"]=p.exports},8607:function(e,t,a){},"8b057":function(e,t,a){},"911a":function(e,t,a){"use strict";a("fc731")},"963b":function(e,t,a){"use strict";a("38b0")},"96e1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group"},[a("el-container",[a("el-container",[a("el-main",[a("div",{staticClass:"main"},[a("el-drawer",{attrs:{direction:"ltr",visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[e.showTree?a("div",{staticClass:"tree"},[e._v(" 搜索 : "),a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),a("el-tree",{ref:"tree",staticClass:"treeitems",attrs:{"allow-drag":e.allowDrag,"allow-drop":e.allowDrop,data:e.treeData,"default-expand-all":"",draggable:"","filter-node-method":e.filterNode,"node-key":"id",props:e.defaultProps},on:{"node-drop":e.handleDrop},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,l=t.data;return a("span",{staticClass:"custom-tree-node"},[1==l.roles.seen?a("span",[a("el-input",{staticStyle:{width:"80%"},model:{value:e.editLabel,callback:function(t){e.editLabel=t},expression:"editLabel"}})],1):a("span",{staticStyle:{color:"#409eff"}},[e._v(e._s(r.label))]),0==l.roles.seen?a("span",{staticStyle:{"margin-left":"5px"}},[a("i",{staticClass:"el-icon-plus",staticStyle:{color:"#67c23a"},attrs:{title:"新增"},on:{click:function(t){return t.stopPropagation(),e.append(l)}}}),a("i",{staticClass:"el-icon-delete",staticStyle:{color:"red"},attrs:{title:"删除"},on:{click:function(t){return t.stopPropagation(),e.deletes(l)}}}),a("i",{staticClass:"el-icon-edit",staticStyle:{color:"#909399"},attrs:{title:"编辑"},on:{click:function(t){return t.stopPropagation(),e.rename(l)}}})]):a("span",[a("i",{staticClass:"el-icon-check",attrs:{slot:"suffix",title:"保存"},on:{click:function(t){return t.stopPropagation(),e.savename(l)}},slot:"suffix"})])])}}],null,!1,3055715610)})],1):e._e()]),a("el-tabs",{staticStyle:{display:"none"},on:{"tab-click":e.goTo},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabsNav,(function(e){return a("el-tab-pane",{key:e.url,attrs:{label:e.label,name:e.url}})})),1),a("router-view")],1),a("div",{staticClass:"setting"},[a("i",{class:[e.drawer?"el-icon-s-fold":"el-icon-s-unfold"],on:{click:function(t){return e.toggleTree()}}})])])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,center:"",title:"添加角色",visible:e.centerDialogRole,width:"35%"},on:{close:e.closeDialogRole}},[a("addroles",{ref:"addRoleRef"})],1)],1)},l=[],o=a("71bc"),i=(a("1d17"),a("98da"),a("a0e0"),a("3dec"),a("16b8"),a("5da9")),n=a("5638"),s=a("d10c"),c={name:"Group",components:{addroles:s["default"]},data:function(){return{drawer:!1,tabsNav:[{label:"统计预览",url:"platform"},{label:"虚拟分组",url:"devproduct"},{label:"通道列表",url:"resourcechannel"},{label:"设备列表",url:"devicelist"},{label:"产品列表",url:"productlist"},{label:"规则列表",url:"engine"}],numberValidateForm:{name:""},centerDialogRole:!1,editLabel:"",filterText:"",addForm:{seen:!1,date:"",name:"",address:""},treeData:[],defaultProps:{children:"children",label:"alias",isLeaf:"leaf"},showTree:!0}},computed:{activeName:{get:function(){return""!=this.$route.path.replace("/dashboard/","")?this.$route.path.replace("/dashboard/",""):"platform"},set:function(){}}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){var e=this;this.$dgiotBus.$on("dialogHide",(function(){e.centerDialogRole=!1,e.getTree()})),this.getTree()},methods:{goTo:function(e){this.$router.push({path:"/dashboard/"+e.name})},toggleTree:function(){this.drawer=!this.drawer},getTree:function(){var e=this;function t(e){var a=Array.isArray(e)?[]:{};if(e&&"object"===Object(o["a"])(e))for(var r in e)e.roles&&(e.roles.seen=!1),e.hasOwnProperty(r)&&(e[r]&&"object"===Object(o["a"])(e[r])?a[r]=t(e[r]):a[r]=e[r]);return a}Object(i["roletree"])().then((function(a){e.treeData=t(a.results),dgiotlog.log(e.treeData)})).catch((function(t){dgiotlog.log(t),e.treeData=[]}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;Object(n["addGroup"])(t.numberValidateForm.name).then((function(e){t.$message({message:"新建设备分组成功",type:"success"})})).catch((function(e){t.$message({message:"新建设备分组失败"+e.computed,type:"error"})}))}))},resetForm:function(e){this.$refs[e].resetFields()},append:function(e){var t=this;this.centerDialogRole=!0,this.$nextTick((function(){t.$refs["addRoleRef"].getData(e)}))},closeDialogRole:function(){this.centerDialogRole=!1,this.getTree()},deletes:function(e){var t=this;this.$confirm("此操作将永久删除该节点,包括其子节点","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["delRole"])(e.objectId).then((function(e){t.getTree(),t.$message({type:"success",message:"删除成功!"})})).catch((function(e){t.$message({type:"error",message:"删除失败"+e.error})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},rename:function(e){this.editLabel=e.alias,e.roles.seen=!0},savename:function(e){var t=this;e.alias!=this.editLabel&&Object(i["putRole"])(e.objectId,this.editLabel).then((function(a){t.$message({type:"success",message:"编辑成功"}),e.alias=t.editLabel})).catch((function(e){dgiotlog.log(e)})),e.roles.seen=!1},allowDrop:function(e,t,a){return e.level===t.level&&(e.data.parentId===t.data.parentId?"prev"===a||"next"===a:void 0)},allowDrag:function(e){return 1!==e.level},handleDrop:function(e,t,a,r){var l=[],o=t.parent.childNodes;for(var i in o)l.push({id:o[i].data.id})},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)}}},d=c,u=(a("e629"),a("bdd7")),p=Object(u["a"])(d,r,l,!1,null,"fbe7890a",null);t["default"]=p.exports},9705:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":!0,title:e.title,visible:e.dialogFormVisible,width:"300px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:e.close}},[e._v(" "+e._s(e.$translateTitle("category.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.save(e.form.mark)}}},[e._v(" "+e._s(e.$translateTitle("category.submit"))+" ")])]},proxy:!0}])},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("category.name"),prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"child"==e.flagType,expression:"flagType == 'child'"}],attrs:{label:e.$translateTitle("category.sort"),prop:"order"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.form.order,callback:function(t){e.$set(e.form,"order",t)},expression:"form.order"}})],1)],1)],1)},l=[],o=a("fb07"),i=a("e97b"),n=a("d0d7"),s=a.n(n),c=(a("c4bc"),a("16b8"),a("d6a4"),a("03b1")),d=a("5880"),u={name:"TableEdit",data:function(){return{flagType:"father",form:{data:{},name:"",order:0,level:0},rules:{},title:"",dialogFormVisible:!1}},computed:Object(i["a"])(Object(i["a"])({},Object(d["mapGetters"])({role:"acl/role",username:"user/username"})),{},{aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),created:function(){},mounted:function(){this.rules={name:[{required:!0,trigger:"blur",message:this.$translateTitle("category.Please enter the category name")}],order:[{required:!0,trigger:"blur",message:this.$translateTitle("category.Please enter the sort")}]}},methods:{showEdit:function(e,t){dgiotlog.log("row",e),dgiotlog.log("type",t),this.flagType=t,this.title="top"==this.flagType?this.$translateTitle("category.New top category"):"child"==t?this.$translateTitle("category.Add subcategory"):this.$translateTitle("category.Modify category"),this.form="child"!=this.flagType?_.merge({mark:t},e):"top"==this.flagType?_.merge(this.$options.data().form,{mark:t,objectId:e.objectId,level:e.level,order:Number(moment(new Date).valueOf())}):{objectId:e.objectId,mark:t,data:{},name:"",order:0,level:0},dgiotlog.log("this.form",this.form),this.dialogFormVisible=!0},close:function(){this.$refs["form"].resetFields(),this.form=this.$options.data().form,this.dialogFormVisible=!1},save:function(e){var t=this;dgiotlog.log(e);var a={"*":{read:!0}},r={name:this.form.name,data:this.form.data,order:this.form.order},l="top"==e?_.merge(r,{ACL:_.merge(a,this.aclObj),parent:{objectId:"a60a85475a",__type:"Pointer",className:"Category"},level:1}):"child"==e?_.merge(r,{ACL:_.merge(a,this.aclObj),parent:{objectId:this.form.objectId,__type:"Pointer",className:"Category"},level:2}):r;this.$refs["form"].validate(function(){var a=Object(o["a"])(s.a.mark((function a(r){var o,i;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(dgiotlog.log("setparams",l),!r){a.next=16;break}if("edit"!=e){a.next=8;break}return a.next=5,Object(c["putCategory"])(t.form.objectId,l);case 5:a.t0=a.sent,a.next=11;break;case 8:return a.next=10,Object(c["postCategory"])(l);case 10:a.t0=a.sent;case 11:o=a.t0,i=o.msg,t.$baseMessage(i,"success","vab-hey-message-success"),t.$emit("fetch-data"),t.close();case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}}},p=u,m=a("bdd7"),f=Object(m["a"])(p,r,l,!1,null,null,null);t["default"]=f.exports},"9e8e":function(e,t,a){"use strict";a("d2d4")},a8a7:function(e,t,a){},aed5:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wmxheader"},[a("el-form",{ref:"sizeForm",attrs:{"label-position":"left","label-width":"150px",model:e.sizeForm,rules:e.sizerule,size:"mini"}},[a("div",[a("el-collapse",{model:{value:e.collapseName,callback:function(t){e.collapseName=t},expression:"collapseName"}},[a("el-collapse-item",{attrs:{name:"1"}},[a("template",{slot:"title"},[e._v(" "+e._s(e.$translateTitle("task.datastorage"))+" ")]),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.devicetype"),prop:"devicetype"}},[a("el-input",{model:{value:e.sizeForm.devicetype,callback:function(t){e.$set(e.sizeForm,"devicetype",t)},expression:"sizeForm.devicetype"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.functionname"),prop:"name"}},[e.sizeForm.nobound&&e.sizeForm.nobound.length>0?a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择","value-key":"name"},on:{change:e.changeThing},model:{value:e.sizeForm.name,callback:function(t){e.$set(e.sizeForm,"name",t)},expression:"sizeForm.name"}},e._l(e.sizeForm.nobound,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e}})})),1):a("el-input",{model:{value:e.sizeForm.name,callback:function(t){e.$set(e.sizeForm,"name",t)},expression:"sizeForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[a("el-input",{attrs:{disabled:e.sizeForm.editdatatype},model:{value:e.sizeForm.identifier,callback:function(t){e.$set(e.sizeForm,"identifier",t)},expression:"sizeForm.identifier"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.datatype"),prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.sizeForm.editdatatype},on:{change:e.changeGroup},model:{value:e.sizeForm.type,callback:function(t){e.$set(e.sizeForm,"type",t)},expression:"sizeForm.type"}},e._l(e.dataType,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.value,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(" "+e._s(t.value)+" ")])])})),1)})),1)],1)],1),"float"==e.sizeForm.type||"double"==e.sizeForm.type?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"小数位数",prop:"precision"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.sizeForm.precision,callback:function(t){e.$set(e.sizeForm,"precision",t)},expression:"sizeForm.precision"}},[a("el-option",{attrs:{label:1,value:"1"}}),a("el-option",{attrs:{label:2,value:"2"}}),a("el-option",{attrs:{label:3,value:"3"}}),a("el-option",{attrs:{label:4,value:"4"}}),a("el-option",{attrs:{label:5,value:"5"}}),a("el-option",{attrs:{label:6,value:"6"}})],1)],1)],1):e._e(),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"图标",prop:"precision"}},[a("el-avatar",{attrs:{size:100,src:e.$FileServe+e.sizeForm.ico},nativeOn:{click:function(t){return e.uploadCkick("userinfo.avatar")}}}),a("vab-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.readandwritetype"),prop:"isread"}},[a("el-radio-group",{staticStyle:{width:"100%"},attrs:{size:"medium"},model:{value:e.sizeForm.isread,callback:function(t){e.$set(e.sizeForm,"isread",t)},expression:"sizeForm.isread"}},[a("el-radio",{attrs:{label:"rw"}},[e._v(" "+e._s(e.$translateTitle("product.write"))+" ")]),a("el-radio",{attrs:{label:"r"}},[e._v(" "+e._s(e.$translateTitle("product.read"))+" ")])],1)],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.isstorage"),prop:"isshow"}},[a("el-radio-group",{staticStyle:{width:"100%"},attrs:{size:"medium"},model:{value:e.sizeForm.isshow,callback:function(t){e.$set(e.sizeForm,"isshow",t)},expression:"sizeForm.isshow"}},[a("el-radio",{attrs:{label:!0}},[e._v(" "+e._s(e.$translateTitle("product.storage"))+" ")]),a("el-radio",{attrs:{label:!1}},[e._v(" "+e._s(e.$translateTitle("product.notstorage"))+" ")])],1)],1)],1)],1),"int"==e.sizeForm.type||"long"==e.sizeForm.type||"float"==e.sizeForm.type||"double"==e.sizeForm.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.valuerangemin"),prop:"startnumber"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.minimumvalue"),type:"number"},model:{value:e.sizeForm.startnumber,callback:function(t){e.$set(e.sizeForm,"startnumber",e._n(t))},expression:"sizeForm.startnumber"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.valuerangemax"),prop:"endnumber"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.maximumvalue"),type:"number"},on:{input:function(t){return e.changeValue("sizeForm")}},model:{value:e.sizeForm.endnumber,callback:function(t){e.$set(e.sizeForm,"endnumber",e._n(t))},expression:"sizeForm.endnumber"}})],1)],1)],1):e._e(),"int"==e.sizeForm.type||"long"==e.sizeForm.type||"float"==e.sizeForm.type||"double"==e.sizeForm.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"步长",prop:"step"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,precision:2,step:.01},model:{value:e.sizeForm.step,callback:function(t){e.$set(e.sizeForm,"step",t)},expression:"sizeForm.step"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.unit")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$translateTitle("product.unit")},model:{value:e.sizeForm.unit,callback:function(t){e.$set(e.sizeForm,"unit",t)},expression:"sizeForm.unit"}},e._l(e.allunit,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(t){return a("el-option",{key:t.id,attrs:{label:t.symbol,value:t.symbol}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(" "+e._s(t.symbol)+" ")])])})),1)})),1)],1)],1)],1):e._e(),"bool"==e.sizeForm.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.attribute"),prop:"truevalue",required:""}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.attribute"),readonly:"",type:"number"},model:{value:e.sizeForm.truevalue,callback:function(t){e.$set(e.sizeForm,"truevalue",t)},expression:"sizeForm.truevalue"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"-"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.egopen")},model:{value:e.sizeForm.true,callback:function(t){e.$set(e.sizeForm,"true",t)},expression:"sizeForm.true"}})],1)],1)],1):e._e(),"bool"==e.sizeForm.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("product.attribute"),readonly:"",type:"number"},model:{value:e.sizeForm.falsevalue,callback:function(t){e.$set(e.sizeForm,"falsevalue",t)},expression:"sizeForm.falsevalue"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"-"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.egclose")},model:{value:e.sizeForm.false,callback:function(t){e.$set(e.sizeForm,"false",t)},expression:"sizeForm.false"}})],1)],1)],1):e._e(),"enum"==e.sizeForm.type?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"枚举项"}},[a("el-link",{attrs:{icon:"el-icon-plus",type:"primary",underline:!1},on:{click:e.addDomain}},[e._v(" "+e._s(e.$translateTitle("product.add"))+" ")]),a("el-alert",{attrs:{closable:!1,description:"存库值必须是int类型，界面值是字符串类型,设备值与存库值转化请使用采集公式",title:"参数提示",type:"success"}}),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.sizeForm.struct}},[a("el-table-column",{attrs:{align:"center",label:"存库值"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:r.attribute,callback:function(t){e.$set(r,"attribute",t)},expression:"row.attribute"}})]}}],null,!1,145805847)}),a("el-table-column",{attrs:{align:"center",label:"界面值"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:r.attributevalue,callback:function(t){e.$set(r,"attributevalue",t)},expression:"row.attributevalue"}})]}}],null,!1,2139517436)}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.removeDomain(r)}}},[e._v(" 删除 ")])]}}],null,!1,1667144408)})],1)],1)],1)],1):e._e(),"struct"==e.sizeForm.type?a("div",[a("el-form-item",{attrs:{label:"JSON对象",required:""}},[a("ul",{staticStyle:{"padding-left":"20px",margin:"0"}},e._l(e.sizeForm.struct,(function(t,r){return a("li",{key:r,staticStyle:{display:"flex","list-style":"none"},attrs:{value:"item"}},[a("div",[a("span",[e._v(" "+e._s(e.$translateTitle("product.parametername")+":")+"} ")]),a("span",[e._v(e._s(t.name))])]),a("div",[a("el-link",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",underline:!1},on:{click:function(a){return e.editStruct(t,r)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.deleteStruct(r)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1)])})),0),a("el-link",{attrs:{icon:"el-icon-plus",type:"primary",underline:!1},on:{click:function(t){return e.addStruct("structform")}}},[e._v(" "+e._s(e.$translateTitle("product.addparameter"))+" ")])],1)],1):e._e(),"text"==e.sizeForm.type?a("div",[a("el-form-item",{attrs:{label:e.$translateTitle("product.datalength"),prop:"string"}},[a("el-input",{attrs:{type:"number"},model:{value:e.sizeForm.string,callback:function(t){e.$set(e.sizeForm,"string",e._n(t))},expression:"sizeForm.string"}},[a("template",{slot:"append"},[e._v(" "+e._s(e.$translateTitle("product.byte"))+" ")])],2)],1)],1):e._e(),"date"==e.sizeForm.type?a("div",[a("el-form-item",{attrs:{label:e.$translateTitle("product.timeformat")}},[a("el-input",{attrs:{readonly:""},model:{value:e.sizeForm.date,callback:function(t){e.$set(e.sizeForm,"date",t)},expression:"sizeForm.date"}})],1)],1):e._e(),"geopoint"==e.sizeForm.type?a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"is-required",attrs:{label:e.$translateTitle("product.gps type")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:e.sizeForm.gpstype,callback:function(t){e.$set(e.sizeForm,"gpstype",t)},expression:"sizeForm.gpstype"}},e._l(["NMEA0183"],(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1)],1)],1)],1):e._e(),"file"==e.sizeForm.type?a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"is-required",attrs:{label:e.$translateTitle("product.image type")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:e.options.value,callback:function(t){e.$set(e.options,"value",t)},expression:"options.value"}},e._l(["二进制","Base64"],(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.File parameters")}},[a("el-input",{model:{value:e.sizeForm.file,callback:function(t){e.$set(e.sizeForm,"file",t)},expression:"sizeForm.file"}})],1)],1)],1)],1):e._e(),"image"==e.sizeForm.type?a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"is-required",attrs:{label:e.$translateTitle("product.image type")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:e.sizeForm.imagevalue,callback:function(t){e.$set(e.sizeForm,"imagevalue",t)},expression:"sizeForm.imagevalue"}},e._l(["jpg","png","ico"],(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1)],1):e._e()],2),a("el-collapse-item",{attrs:{name:"2"}},[a("template",{slot:"title"},[e._v(" "+e._s(e.$translateTitle("task.dataacquisition"))+" "),a("el-row",{staticStyle:{margin:"0 auto"}},[a("el-col",{attrs:{span:2}},[a("el-popover",{attrs:{placement:"right",trigger:"click",width:"400"}},[a("el-table",{attrs:{data:e.wmxData.slice((e.wmxstart-1)*e.wmxPageSize,e.wmxstart*e.wmxPageSize)}},[a("el-table-column",{attrs:{label:e.$translateTitle("product.identifier")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(" "+e._s(r.identifier)+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.functionname")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(" "+e._s(r.name)+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.datatype")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(" "+e._s(r.dataType.type)+" ")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.wmxPageSize,"page-sizes":[10,20,30,50],total:e.wmxData.length},on:{"current-change":e.wmxCurrentChange,"size-change":e.wmxSizeChange}})],1)],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 采集策略表达式 。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 5分钟 = 5 * 60 "),a("br"),e._v(" 1小时 = 60 * 60 "),a("br"),e._v(" 5小时 = 5 * 60 * 60 "),a("br"),e._v(" 1天 = 24 * 60 * 60 "),a("br")]),a("i",{staticClass:"el-icon-question"})]),a("el-form-item",{attrs:{label:"采集策略(单位：秒)"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{"allow-create":"","default-first-option":"",filterable:"",placeholder:"请选择",size:"mini"},model:{value:e.sizeForm.strategy,callback:function(t){e.$set(e.sizeForm,"strategy",t)},expression:"sizeForm.strategy"}},e._l(e.sizeOption,(function(e){return a("el-option",{key:e.val,attrs:{label:e.label,size:"mini",value:e.val}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"采集轮次"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"","default-first-option":"",filterable:"",placeholder:"请选择生效轮次",size:"mini"},model:{value:e.sizeForm.round,callback:function(t){e.$set(e.sizeForm,"round",t)},expression:"sizeForm.round"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("p",{staticStyle:{position:"absolute",top:"26px",margin:"0","font-size":"12px",color:"black"}},[e._v(" 例如:1,3,5,8;(可选可自主填写)(注意:逗号为英文逗号) ")])],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 采集值 设备上行数据经采集公式计算后显示 。 "),a("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 加：%s+10 "),a("br"),e._v(" 减：%s-10 "),a("br"),e._v(" 乘：%s*10 "),a("br"),e._v(" 除：%s/10 "),a("br"),e._v(" 余数：%s%10 "),a("br"),e._v(" 2. 计算值 添加变量按钮, "),a("br"),e._v(" 复制对应的标识符 "),a("br"),e._v(" 例：pressure_out "),a("br"),e._v(" 加：pressure_out+10 "),a("br"),e._v(" 减：pressure_out-10 "),a("br"),e._v(" 乘：pressure_out*10 "),a("br"),e._v(" 除：pressure_out/10 "),a("br"),e._v(" 余数：pressure_out%10 "),a("br"),e._v(" 3. 复杂值 ：关闭本弹窗后使用物解析处理 "),a("br")]),a("i",{staticClass:"el-icon-question"})]),a("el-form-item",{attrs:{label:"采集公式"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{placeholder:"%s",rows:1,type:"textarea"},model:{value:e.sizeForm.collection,callback:function(t){e.$set(e.sizeForm,"collection",t)},expression:"sizeForm.collection"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"采集顺序"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{label:"采集顺序",min:0},model:{value:e.sizeForm.order,callback:function(t){e.$set(e.sizeForm,"order",t)},expression:"sizeForm.order"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-tooltip",{attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 采集值: 主动向设备写数据经控制公式计算后下发 。 "),a("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 加：%s+10 "),a("br"),e._v(" 减：%s-10 "),a("br"),e._v(" 乘：%s*10 "),a("br"),e._v(" 除：%s/10 "),a("br"),e._v(" 余数：%s%10 "),a("br"),e._v(" 2. 计算值: 点击添加变量按钮, "),a("br"),e._v(" 复制对应的标识符 "),a("br"),e._v(" 例：pressure_out "),a("br"),e._v(" 加：pressure_out+10 "),a("br"),e._v(" 减：pressure_out-10 "),a("br"),e._v(" 乘：pressure_out*10 "),a("br"),e._v(" 除：pressure_out/10 "),a("br"),e._v(" 余数：pressure_out%10 "),a("br"),e._v(" 3. 复杂值 ：关闭本弹窗后使用物解析处理 "),a("br")]),a("i",{staticClass:"el-icon-question",staticStyle:{float:"left"}})]),a("el-form-item",{attrs:{label:"控制公式"}},[a("el-input",{staticStyle:{width:"98%"},attrs:{placeholder:"%s",rows:1,type:"textarea"},model:{value:e.sizeForm.control,callback:function(t){e.$set(e.sizeForm,"control",t)},expression:"sizeForm.control"}})],1)],1)],1)],2),a("el-collapse-item",{attrs:{name:"4"}},[a("template",{slot:"title"},[e._v("数据来源")]),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"协议类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.sizeForm.protocol,callback:function(t){e.$set(e.sizeForm,"protocol",t)},expression:"sizeForm.protocol"}},e._l(["normal","opc","modbus","DLT645","xinchuangwei","mingcheng"],(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.sizeForm.protocol,expression:"sizeForm.protocol == 'modbus'"}],attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据格式"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.sizeForm.originaltype,callback:function(t){e.$set(e.sizeForm,"originaltype",t)},expression:"sizeForm.originaltype"}},e._l([{value:"bit",label:"位"},{value:"short16_AB",label:"16位 有符号(AB)"},{value:"short16_BA",label:"16位 有符号(BA)"},{value:"ushort16_AB",label:"16位 无符号(AB)"},{value:"ushort16_BA",label:"16位 无符号(BA)"},{value:"long32_ABCD",label:"32位 有符号(ABCD)"},{value:"long32_CDAB",label:"32位 有符号(CDAB)"},{value:"ulong32_ABCD",label:"32位 无符号(ABCD)"},{value:"ulong32_CDAB",label:"32位 无符号(CDAB)"},{value:"float32_ABCD",label:"32位 浮点数(ABCD)"},{value:"float32_CDAB",label:"32位 浮点数(CDAB)"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"opc"==e.sizeForm.protocol,expression:"sizeForm.protocol == 'opc'"}],attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"数据地址集"}},[a("el-link",{attrs:{icon:"el-icon-plus",type:"primary",underline:!1},on:{click:e.addDas}},[e._v(" "+e._s(e.$translateTitle("product.add"))+" ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.sizeForm.daslist}},[a("el-table-column",{attrs:{align:"center",label:"数据地址"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:r.addr,callback:function(t){e.$set(r,"addr",t)},expression:"row.addr"}})]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.removeDas(r)}}},[e._v(" 删除 ")])]}}])})],1)],1)],1)],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.sizeForm.protocol,expression:"sizeForm.protocol == 'modbus'"}],staticStyle:{width:"100%"},attrs:{border:"",data:e.dataList,size:"small"}},[a("el-table-column",{attrs:{align:"center",label:"从机地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:e.sizeForm.slaveid,callback:function(t){e.$set(e.sizeForm,"slaveid",t)},expression:"sizeForm.slaveid"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"寄存器状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.sizeForm.operatetype,callback:function(t){e.$set(e.sizeForm,"operatetype",t)},expression:"sizeForm.operatetype"}},e._l([{value:"readCoils",label:"0X01:读线圈寄存器"},{value:"readInputs",label:"0X02:读离散输入寄存器"},{value:"readHregs",label:"0X03:读保持寄存器"},{value:"readIregs",label:"0X04:读输入寄存器"},{value:"writeCoil",label:"0X05:写单个线圈寄存器"},{value:"writeHreg",label:"0X06:写单个保持寄存器"},{value:"writeCoils",label:"0X0f:写多个线圈寄存器"},{value:"writeHregs",label:"0X10:写多个保持寄存器"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"数据地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:e.sizeForm.dis,callback:function(t){e.$set(e.sizeForm,"dis",t)},expression:"sizeForm.dis"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"数据长度(字节)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:e.sizeForm.dinumber,callback:function(t){e.$set(e.sizeForm,"dinumber",t)},expression:"sizeForm.dinumber"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r.slaveid))])]}}])})],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"!=e.sizeForm.protocol&&"opc"!=e.sizeForm.protocol,expression:"\n              sizeForm.protocol != 'modbus' && sizeForm.protocol != 'opc'\n            "}],attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据地址"}},[a("el-input",{attrs:{placeholder:"数据地址"},model:{value:e.sizeForm.dis,callback:function(t){e.$set(e.sizeForm,"dis",t)},expression:"sizeForm.dis"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据长度"}},[a("el-input",{attrs:{placeholder:"数据长度（字节）"},model:{value:e.sizeForm.dinumber,callback:function(t){e.$set(e.sizeForm,"dinumber",e._n(t))},expression:"sizeForm.dinumber"}})],1)],1)],1)],2)],1)],1)]),a("div",{staticStyle:{"margin-top":"26px","text-align":"center"}},[a("el-button",{on:{click:e.wmxhandleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("sizeForm")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)},l=[],o=a("fb07"),i=a("e97b"),n=a("d0d7"),s=a.n(n),c=(a("1d17"),a("37c6"),a("f1e1"),a("16b8"),a("3dec"),a("9c6a"),a("c4bc"),a("e09d")),d=a("e0e9"),u=a("5880"),p={name:"Wmxdetail",components:{},data:function(){var e=this,t=/^[a-z][a-z0-9_]*$/,a=function(e,a,r){if(!t.test(a))return r(new Error("请以小写字母开头，只能输入小写字母,数字,_"));r()},r=function(t,a,r){""===a?r(new Error("最小值不能为空")):""!==e.sizeForm.endnumber&&(a>=e.sizeForm.endnumber?r(new Error("最小值小于最大值")):r())},l=function(t,a,r){""===a?r(new Error("最大值不能为空")):""!==e.sizeForm.startnumber&&(a<=e.sizeForm.startnumber?r(new Error("最大值必须大于最小值")):r())},o=function(t,a,r){a<0?r(new Error("步长大于0")):a>=e.sizeForm.endnumber-e.sizeForm.startnumber?r(new Error("步长必须小于最大值和最小值的差值")):r()};return{inputParams:{},dataList:[{}],dataType:c["default"].mockModules.dataType,options:[{value:"all",label:"全部"},{value:"first",label:"第一轮"},{value:"last",label:"最后一轮"}],wmxData:[],allunit:c["default"].mockModules.dataNnit,sizerule:{step:[{required:!0,trigger:"blur",validator:o}],string:[{required:!0,trigger:"blur",message:"请输入数据长度"},{type:"number",message:"数据长度必须为数字"}],startnumber:[{validator:r,required:!0,trigger:"blur"}],endnumber:[{validator:l,required:!0,trigger:"blur"}],resource:[{required:!0,message:"请选择功能类型",trigger:"change"}],true:[{required:!0,message:"请输入属性值",trigger:"blur"}],false:[{required:!0,message:"请输入属性值",trigger:"blur"}],name:[{required:!0,message:"请输入属性名称",trigger:"blur"}],identifier:[{required:!0,message:"请输入标识符",trigger:"blur"},{validator:a}],dis:[{required:!0,message:"请输入数据标识",trigger:"blur"}],type:[{required:!0,message:"请选择数据类型",trigger:"change"}],attribute:[{required:!0,message:"请输入属性",trigger:"blur"}],attributevalue:[{required:!0,message:"请输入属性值",trigger:"blur"}],isread:[{required:!0,message:"请选择读写类型",trigger:"change"}],isshow:[{required:!0,message:"请选择是否存储",trigger:"change"}]},collapseName:["1","2","3","4"],wmxstart:1,wmxPageSize:10,sizeOption:[{label:"20",val:"20"},{label:"不采集(计算值)",val:"计算值"},{label:"不采集(主动上报)",val:"主动上报"}],countsizeOption:[{label:"10",val:"10"},{label:"20",val:"20"},{label:"30",val:"30"}]}},computed:Object(i["a"])(Object(i["a"])({},Object(u["mapGetters"])({sizeForm:"konva/sizeForm"})),{},{showNewItem:function(){return!(!this.sizeForm||"modbus"!=this.sizeForm.protocol)}}),watch:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},activated:function(){},methods:Object(i["a"])(Object(i["a"])({changeGroup:function(e){dgiotlog.log(e)},fileInfo:function(e){dgiotlog.error("========================",e),this.sizeForm.ico=e.path},uploadCkick:function(e){this.upNodeType=e,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:"app",path:"devicething/ico/",filename:""}},files:function(e,t){this.inputParams.filename="".concat(this.$route.query.id,".").concat(this.sizeForm.identifier?this.sizeForm.identifier:moment().format("x"),".").concat(t),this.inputParams.file=e}},Object(u["mapMutations"])({setSizeForm:"konva/setSizeForm"})),{},{changeThing:function(e){var t=this;dgiotlog.log("this.sizeFormaaa",t.$refs.sizeForm.model.name),dgiotlog.log("item",e);var a={},r=[];if(e.dataType.das.forEach((function(e){r.push({addr:e})})),-1!=["float","double","int","long"].indexOf(e.dataType.type))a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,endnumber:t.$objGet(e,"dataType.specs.max"),startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),precision:this.$objGet(e,"dataType.specs.precision"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),collection:"",control:"",strategy:"",required:!0,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier},e.dataForm&&(a.collection=e.dataForm.collection,a.control=e.dataForm.control,a.strategy=e.dataForm.strategy);else if("image"==e.dataType.type)a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,imagevalue:e.dataType.imagevalue,true:e.dataType.specs[1],false:e.dataType.specs[0],startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!1,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy};else if("bool"==e.dataType.type)a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,true:e.dataType.specs[1],false:e.dataType.specs[0],startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!1,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy};else if("enum"==e.dataType.type){var l=[];for(var o in e.dataType.specs)l.push({attribute:o,attributevalue:e.dataType.specs[o]});a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,specs:e.dataType.specs,struct:l,startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:this.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy}}else"struct"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,struct:e.dataType.specs,startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,isread:e.accessMode,isshow:e.isshow,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,identifier:void 0==e.dataForm?"":e.identifier,strategy:void 0==e.dataForm?"":e.dataForm.strategy}:"text"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,string:e.dataType.size,startnumber:this.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier,strategy:void 0==e.dataForm?"":e.dataForm.strategy}:"date"==e.dataType.type||"file"==e.dataType.type||"url"==e.dataType.type?a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier}:"geopoint"==e.dataType.type&&(a={name:e.name,devicetype:e.devicetype,ico:e.ico,type:e.dataType.type,daslist:r,gpstype:e.dataType.gpstype,collection:void 0==e.dataForm?"":e.dataForm.collection,control:void 0==e.dataForm?"":e.dataForm.control,strategy:void 0==e.dataForm?"":e.dataForm.strategy,startnumber:t.$objGet(e,"dataType.specs.min"),step:t.$objGet(e,"dataType.specs.step"),unit:t.$objGet(e,"dataType.specs.unit"),round:t.$objGet(e,"dataForm.round"),dinumber:t.$objGet(e,"dataForm.data"),rate:t.$objGet(e,"dataForm.rate"),offset:t.$objGet(e,"dataForm.offset"),order:t.$objGet(e,"dataForm.order"),protocol:t.$objGet(e,"dataForm.protocol"),operatetype:t.$objGet(e,"dataForm.operatetype"),originaltype:t.$objGet(e,"dataForm.originaltype"),slaveid:t.$objGet(e,"dataForm.slaveid"),iscount:this.$objGet(e,"dataForm.iscount"),countstrategy:this.$objGet(e,"dataForm.countstrategy"),countround:this.$objGet(e,"dataForm.countround"),countcollection:this.$objGet(e,"dataForm.countcollection"),required:!0,isread:e.accessMode,isshow:e.isshow,identifier:e.identifier});a.nobound=this.sizeForm.nobound,a.dis=e.dataForm.address,a.isdis=this.sizeForm.isdis,dgiotlog.log("obj",a),t.setSizeForm(a)},wmxCurrentChange:function(e){this.wmxstart=e},wmxSizeChange:function(e){this.wmxstart=1,this.wmxPageSize=e},getAllunit:function(){var e=this;return Object(o["a"])(s.a.mark((function t(){var a,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allunit=[],t.next=3,Object(d["getAllunit"])("unit",200);case 3:a=t.sent,r=a.results,e.allunit=r.concat([]),e.allunit.unshift({data:{Name:"无",Symbol:""}});case 7:case"end":return t.stop()}}),t)})))()},removeDomain:function(e){this.$emit("removeDomain",e)},addDomain:function(){this.$emit("addDomain")},addDas:function(){this.$emit("addDas")},removeDas:function(e){this.$emit("removeDas",e)},wmxhandleClose:function(){this.$emit("wmxhandleClose")},changeValue:function(e){this.$refs[e].validateField("startnumber",(function(e){if(e)return!1}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return dgiotlog.log(e),dgiotlog.log("error submit!!"),!1;var a=t.sizeForm,r=[];a.daslist.map((function(e){var t=e["addr"];r.push(t)}));var l={name:a.name,devicetype:a.devicetype,dataForm:{round:a.round,data:a.dinumber,address:a.dis,rate:a.rate,offset:a.offset,order:a.order,protocol:a.protocol,operatetype:a.operatetype,originaltype:a.originaltype,slaveid:a.slaveid,collection:a.collection,control:a.control,strategy:a.strategy,iscount:a.iscount,countstrategy:a.countstrategy,countround:a.countround,countcollection:a.countcollection},ico:a.ico,required:!0,accessMode:a.isread,isshow:a.isshow,identifier:a.identifier};if("float"==a.type||"double"==a.type||"int"==a.type||"long"==a.type){var o={dataType:{type:a.type.toLowerCase(),specs:{max:a.endnumber,min:a.startnumber,step:a.step,unit:""==a.unit?"":a.unit},das:r}};Object.assign(l,o)}else if("image"==a.type){o={dataType:{type:a.type.toLowerCase(),imagevalue:a.imagevalue,specs:{},das:r}};Object.assign(l,o)}else if("bool"==a.type){o={dataType:{type:a.type.toLowerCase(),specs:{0:a.false,1:a.true},das:r}};Object.assign(l,o)}else if("enum"==a.type){var i={};a.struct.map((function(e){var t=e["attribute"];i[t]=e["attributevalue"]}));o={dataType:{type:a.type.toLowerCase(),specs:i,das:r}};Object.assign(l,o)}else if("struct"==a.type){o={dataType:{type:a.type.toLowerCase(),specs:a.struct,das:r}};Object.assign(l,o)}else if("string"==a.type){o={dataType:{type:a.type.toLowerCase(),size:a.string,das:r}};Object.assign(l,o)}else if("text"==a.type){o={dataType:{type:a.type.toLowerCase(),size:a.string,specs:{},das:r}};Object.assign(l,o)}else if("date"==a.type){o={dataType:{type:a.type.toLowerCase(),das:r}};Object.assign(l,o)}else if("geopoint"==a.type){o={dataType:{type:a.type.toLowerCase(),gpstype:a.gpstype,specs:{},das:r}};Object.assign(l,o)}delete l.index,t.$emit("submitForm",l)}))}})},m=p,f=a("bdd7"),b=Object(f["a"])(m,r,l,!1,null,null,null);t["default"]=b.exports},af11:function(e,t,a){},b810:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"application dgiot-container"},[a("div",{staticClass:"addApplication"}),a("div",{staticClass:"appcontent",staticStyle:{position:"relative",display:"flex","flex-direction":"column","align-items":"center"}},[e._l(e.appdata,(function(t,r){return a("el-card",{key:r,staticClass:"box-card",staticStyle:{width:"80%","margin-bottom":"10px",border:"1px solid #cccccc"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("i",{staticClass:"iconfont icon-yingyong",staticStyle:{color:"#666666"}}),a("p",[e._v(e._s(t.name))])])]),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content bg-purple"},[a("dl",[a("dt",[e._v(" "+e._s(e.$translateTitle("product.appid"))+" "),a("el-tooltip",{attrs:{content:e.$translateTitle("product.TheonlyapplicationIDintheSDKcallingprocess"),placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),a("dd",[e._v(e._s(t.objectId))]),a("dt",[e._v(" "+e._s(e.$translateTitle("product.appsecret"))+" "),a("el-tooltip",{attrs:{content:e.$translateTitle("product.aaab"),placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t.isshow?a("dd",[e._v(" "+e._s(t.tag.appconfig.secret)+" ")]):e._e(),t.isshow?e._e():a("dd",[t.tag.appconfig.secret?a("i",[e._v(" "+e._s(t.tag.appconfig.secret.substr(0,4)+"********************"+t.tag.appconfig.secret.substr(24))+" "),a("el-button",{staticStyle:{position:"absolute",top:"30px","margin-left":"10px"},attrs:{round:"",size:"samll"},on:{click:function(a){return e.xianshi(t.objectId)}}},[e._v(" "+e._s(e.$translateTitle("product.fullkey"))+" ")])],1):e._e()]),a("dt",[e._v(" "+e._s(e.$translateTitle("task.Applicationname"))+" "),a("i",{staticClass:"el-icon-s-promotion"})]),t.name?a("dd",[e._v(" "+e._s(t.name)+" ")]):a("dd",[e._v("-")])])])]),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("p",{staticClass:"editor"},[a("strong",[e._v(" "+e._s(e.$translateTitle("task.Operation")+":")+" ")])]),a("p",{staticClass:"editor"},[a("el-link",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.updateapp(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.Modifyapplication"))+" ")])],1),a("p",{staticClass:"editor"},[a("el-link",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.nodeDeployment(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.Nodedeployment"))+" ")])],1),a("p",{staticClass:"editor"},[a("el-link",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.applicationDeployment(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.Applicationdeployment"))+" ")])],1)])])],1)],1)})),a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.pagesize,"page-sizes":[1,5,10],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],2),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("developer.addapp"),visible:e.dialogVisible,width:"55%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"block",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn")}},[a("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.form,rules:e.Rule}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationname"),prop:"desc"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("application.applicationname")},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.tokeneffectivetime")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enterapptime"),type:"number"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}}),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(" "+e._s(e.$translateTitle("application.seconds"))+" ")])],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordpreviewserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordpreviewserver")},model:{value:e.form.wordpreview,callback:function(t){e.$set(e.form,"wordpreview",t)},expression:"form.wordpreview"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordproductionserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordproductionserver")},model:{value:e.form.wordproduct,callback:function(t){e.$set(e.form,"wordproduct",t)},expression:"form.wordproduct"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.fileresources"),prop:"file"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.url},model:{value:e.form.file,callback:function(t){e.$set(e.form,"file",t)},expression:"form.file"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.Configurationresources"),prop:"topo"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form.topo,callback:function(t){e.$set(e.form,"topo",t)},expression:"form.topo"}})],1),a("el-form-item",{attrs:{label:"Graphql API",prop:"graphql"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form.graphql,callback:function(t){e.$set(e.form,"graphql",t)},expression:"form.graphql"}})],1),a("el-form-item",{attrs:{label:"Restful API",prop:"rest"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form.rest,callback:function(t){e.$set(e.form,"rest",t)},expression:"form.rest"}})],1),a("el-form-item",{attrs:{label:"home"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("developer.path")},model:{value:e.form.home,callback:function(t){e.$set(e.form,"home",t)},expression:"form.home"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.Define("form")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("product.modify")+e.$translateTitle("product.Applicationinformation"),visible:e.update,width:"55%"},on:{"update:visible":function(t){e.update=t}}},[a("div",{staticClass:"block"},[a("el-form",{ref:"form1",attrs:{"label-width":"170px",model:e.form1,rules:e.Rule}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.Accesskey")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{readonly:""},model:{value:e.form1.secret,callback:function(t){e.$set(e.form1,"secret",t)},expression:"form1.secret"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh-right"},on:{click:e.handleClickRefresh},slot:"append"})],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.tokeneffectivetime")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enterapptime"),type:"number"},model:{value:e.form1.time,callback:function(t){e.$set(e.form1,"time",t)},expression:"form1.time"}}),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(" "+e._s(e.$translateTitle("task.Seconds"))+" ")])],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordpreviewserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordpreviewserver")},model:{value:e.form1.wordpreview,callback:function(t){e.$set(e.form1,"wordpreview",t)},expression:"form1.wordpreview"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordproductionserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordproductionserver")},model:{value:e.form1.wordproduct,callback:function(t){e.$set(e.form1,"wordproduct",t)},expression:"form1.wordproduct"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.fileresources"),prop:"file"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.file,callback:function(t){e.$set(e.form1,"file",t)},expression:"form1.file"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.Configurationresources"),prop:"topo"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.topo,callback:function(t){e.$set(e.form1,"topo",t)},expression:"form1.topo"}})],1),a("el-form-item",{attrs:{label:"Graphql API",prop:"graphql"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.graphql,callback:function(t){e.$set(e.form1,"graphql",t)},expression:"form1.graphql"}})],1),a("el-form-item",{attrs:{label:"Restful API",prop:"rest"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.rest,callback:function(t){e.$set(e.form1,"rest",t)},expression:"form1.rest"}})],1),a("el-form-item",{attrs:{label:"home"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("developer.path")},model:{value:e.form1.home,callback:function(t){e.$set(e.form1,"home",t)},expression:"form1.home"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.update=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updatedDefine("form1")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1)},l=[],o=a("fb07"),i=a("d0d7"),n=a.n(i),s=(a("1d17"),a("37c6"),a("d6a4"),a("c4bc"),a("16b8"),a("5da9")),c=a("f43e").Base64,d={data:function(){var e=function(e,t,a){var r=/^(((ht|f)tps?):\/\/)?[\w-]+(\.[\w-]+)+([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?$/;""===t||null===t?a(new Error("请输入url地址")):r.test(t)?a():a(new Error("请输入正确的url地址"))};return{url:"",total:0,pagesize:10,start:0,update:!1,form1:{name:"",product:"",time:"",file:"",graphql:"",rest:"",topo:"",secret:"",desc:"",home:"",wordpreview:"http://pump.iotn2n.com:8012",wordproduct:"http://pump.iotn2n.com"},dialogVisible:!1,form:{name:"",product:"",time:"18000",file:"http://file.iotn2n.com/shapes/upload",graphql:"http://cad.iotn2n.com:5080/graphql",rest:"http://cad.iotn2n.com:5080/iotapi",topo:"http://shapes.iotn2n.com/",secret:"",home:"D:/shuwa/shuwa_data_center",wordpreview:"http://pump.iotn2n.com:8012",wordproduct:"http://pump.iotn2n.com/"},Rule:{desc:[{required:!0,message:"请输入应用名称",trigger:"blur"},{validator:function(e,t,a){0===t.length?a(new Error("应用名称不能为空")):a()}}],file:[{trigger:"blur",validator:e}],topo:[{trigger:"blur",validator:e}],graphql:[{trigger:"blur",validator:e}],rest:[{trigger:"blur",validator:e}]},appdata:[],objectid:"",selectapp:[],arr:[],loading:!1}},created:function(){},mounted:function(){this.getAppdetail(this.pagesize,this.start),dgiotlog.log("this.$route.query",this.$route.query),this.$route.query&&this.$route.query.projectName&&(this.dialogVisible=!0,this.form.desc=this.$route.query.projectName)},methods:{Define:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return dgiotlog.log("error submit!!"),!1;t.submit()}))},submit:function(){this.loading=!0;var e=Math.ceil(25*Math.random());c.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date)),this.form.file,this.form.graphql,this.form.rest,this.form.topo,this.form.home},getAppdetail:function(e,t){var a=this;return Object(o["a"])(n.a.mark((function r(){var l;return n.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:dgiotlog.log(e,t),l={skip:t,limit:e,keys:"tag,name,desc,count(*)",order:"updatedAt"},Object(s["queryRole"])(l).then((function(e){a.appdata=e.results,a.appdata.map((function(e){e.tag.appconfig.secret&&(e.isshow=!1)})),a.total=e.count})).catch((function(e){dgiotlog.log(e)}));case 3:case"end":return r.stop()}}),r)})))()},handleClickRefresh:function(){this.randomSecret()},randomSecret:function(){var e=Math.ceil(25*Math.random());this.form1.secret=c.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date))},handleSizeChange:function(e){this.pagesize=e,this.getAppdetail(this.pagesize,this.start)},handleCurrentChange:function(e){this.start=Number(e-1)*Number(this.pagesize),this.getAppdetail(this.pagesize,this.start)},updateapp:function(e){this.update=!0,this.form1.objectId=e.objectId,this.form1.time=e.tag.appconfig.expires,this.form1.file=e.tag.appconfig.file,this.form1.rest=e.tag.appconfig.rest,this.form1.topo=e.tag.appconfig.topo,this.form1.graphql=e.tag.appconfig.graphql,this.form1.home=e.tag.appconfig.home,this.form1.secret=e.tag.appconfig.secret,this.form1.desc=e.tag.appconfig.desc},updatedDefine:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return dgiotlog.log("error submit!!"),!1;t.updateObj(t.form1.objectId)}))},updateObj:function(e){var t=this;return Object(o["a"])(n.a.mark((function a(){var r,l;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={expires:t.form1.time,file:t.form1.file,graphql:t.form1.graphql,rest:t.form1.rest,topo:t.form1.topo,home:t.form1.home,secret:t.form1.secret,wordpreview:t.form1.home,wordproduct:t.form1.secret},l={appconfig:{}},l.appconfig=r,a.next=5,Object(s["putRole"])(e,l).then((function(e){t.$message({type:"success",message:"应用修改成功"}),t.getAppdetail(10,0),t.update=!1})).catch((function(e){t.$message({type:"error",message:"应用修改失败"+e.error}),dgiotlog.log(e)}));case 5:case"end":return a.stop()}}),a)})))()},nodeDeployment:function(e){this.$router.push({path:"/roles/server_control",query:{appid:e.objectId,appsecret:e.tag.appconfig.secret}})},applicationDeployment:function(e){this.$router.push({path:"/applicationManagement/addApp",query:{actionType:"add",title:"新增应用",appObjectId:e.objectId,desc:e.desc,name:e.name}})},xianshi:function(e){for(var t,a=0;a<this.appdata.length;a++)this.appdata[a].objectId==e&&(t=this.appdata[a],this.appdata[a].isshow=!0,this.$set(this.appdata,a,t))}}},u=d,p=(a("e385"),a("ca4f"),a("bdd7")),m=Object(p["a"])(u,r,l,!1,null,"b20d71c0",null);t["default"]=m.exports},bbce:function(e,t,a){"use strict";a("4a99")},c937:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container"},[a("div",{staticClass:"main"},[a("a-tabs",{staticClass:"tabs",attrs:{"default-active-key":"iframe"}},[a("a-tab-pane",{key:"iframe",attrs:{tab:e.$translateTitle("leftbar.monitor")}},[a("iframe",{directives:[{name:"show",rawName:"v-show",value:""!=e.dashboardrul&&e.dashboardrul,expression:"dashboardrul != '' && dashboardrul"}],staticClass:"iframe",attrs:{id:"iframe",frameborder:"0",height:"700",width:"100%"}})]),a("a-tab-pane",{key:"chart",attrs:{"force-render":"",tab:e.$translateTitle("equipment.chart")}},[a("empty")],1)],1)],1)])},l=[],o=(a("1d17"),a("98da"),a("43b8")),i={name:"Dashboard",components:{empty:o["default"]},data:function(){return{currentRole:"admindashboard",isshow:0,childshow:0,form:{date1:"",date2:""},refresh:"",dashboardrul:"http://47.105.106.54:3000/",timerefesh:{val1:"15s",val2:"30s",val3:"60s"},categoryIndex:0}},computed:{},mounted:function(){this.getdashboard()},methods:{getdashboard:function(){this.dashboardrul=location.protocol+"//"+location.hostname+":3000";var e=document.getElementById("iframe");e.setAttribute("src",this.dashboardrul)},selectval:function(e,t){var a=/(refresh=[^&]+)/;this.dashboardrul=this.dashboardrul.replace(a,"refresh="+e),this.categoryIndex=t}}},n=i,s=(a("6bff"),a("bdd7")),c=Object(s["a"])(n,r,l,!1,null,null,null);t["default"]=c.exports},ca4f:function(e,t,a){"use strict";a("391ce")},cd14:function(e,t,a){"use strict";a("39b8")},d2d4:function(e,t,a){},d815:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ProfileDict"},[e.dictVisible?a("a-drawer",{staticStyle:{"z-index":"999"},attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.titleTempDialog,visible:e.dictVisible,width:"60%"},on:{close:function(t){e.$parent.dictVisible=!e.dictVisible}}},[a("el-form",{ref:"dictTempForm",attrs:{model:e.dictTempForm,rules:e.rules,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"字典模板名称","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.name,callback:function(t){e.$set(e.dictTempForm,"name",t)},expression:"dictTempForm.name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"字典模板类型","label-width":e.formLabelWidth,prop:"cType"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.cType,callback:function(t){e.$set(e.dictTempForm,"cType",t)},expression:"dictTempForm.cType"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"字典模板状态","label-width":e.formLabelWidth,prop:"enable"}},[a("el-radio",{attrs:{border:"",label:"1"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" 启用 ")]),a("el-radio",{attrs:{border:"",label:"0"},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" 禁用 ")])],1)],1)],1),a("el-form-item",{attrs:{label:"字典模板数据","label-width":e.formLabelWidth}},[a("el-tabs",{model:{value:e.elactiveName,callback:function(t){e.elactiveName=t},expression:"elactiveName"}},[a("el-tab-pane",{attrs:{label:"Table",name:"Table"}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"small",type:"primary"},nativeOn:{click:function(t){return e.$parent.addRow(e.dictTempForm.params)}}},[e._v(" 新 增 ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.dictTempForm.params,height:"300"}},[a("el-table-column",{attrs:{label:"序号",prop:"order"}}),a("el-table-column",{attrs:{label:"标识符",prop:"identifier"}}),a("el-table-column",{attrs:{label:"功能名称",prop:"name"}}),a("el-table-column",{attrs:{label:"数据类型",prop:"type"}}),a("el-table-column",{attrs:{label:"数据地址",prop:"address"}}),a("el-table-column",{attrs:{label:"数据长度",prop:"bytes"}}),a("el-table-column",{attrs:{label:"是否必填",prop:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.required?a("span",[e._v("是")]):a("span",[e._v("否")])]}}],null,!1,2053984958)}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;var r=t.$index;return[a("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.$parent.delRow(r,e.dictTempForm.params)}}},[e._v(" 删除 ")]),a("el-button",{attrs:{plain:"",size:"mini",title:"编辑",type:"info"},nativeOn:{click:function(t){return e.$parent.editRow(r,e.dictTempForm.params)}}},[e._v(" 编辑 ")])]}}],null,!1,3276126272)})],1)],1),a("el-tab-pane",{attrs:{label:"Json",name:"Json"}},[a("vab-json-editor",{attrs:{lang:"zh",mode:"code"},on:{"has-error":e.$parent.onError},model:{value:e.dictTempForm.params,callback:function(t){e.$set(e.dictTempForm,"params",t)},expression:"dictTempForm.params"}})],1)],1)],1),a("el-form-item",{attrs:{label:"描述","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},placeholder:"请输入描述",type:"textarea"},model:{value:e.dictTempForm.description,callback:function(t){e.$set(e.dictTempForm,"description",t)},expression:"dictTempForm.description"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$parent.onJsonSave("dictTempForm",e.dictTempForm)}}},[e._v(" 提交 ")]),a("el-button",{on:{click:function(t){e.$parent.dictVisible=!1}}},[e._v("取消")])],1)],1)],1):e._e(),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.$parent.closeDict,"close-on-click-modal":!1,title:e.titleDict,top:"5vh",visible:e.editFlag,width:"60%"},on:{"update:visible":function(t){e.editFlag=t},open:function(t){return e.$parent.opendialog("tempparams")}}},[a("el-form",{ref:"tempparams",attrs:{"label-position":"left","label-width":"100px",model:e.tempparams,size:"mini"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"序号",prop:"order"}},[a("el-input",{model:{value:e.tempparams.order,callback:function(t){e.$set(e.tempparams,"order",e._n(t))},expression:"tempparams.order"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.identifier"),prop:"identifier"}},[a("el-input",{model:{value:e.tempparams.identifier,callback:function(t){e.$set(e.tempparams,"identifier",t)},expression:"tempparams.identifier"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.functionname"),prop:"name"}},[a("el-input",{model:{value:e.tempparams.name,callback:function(t){e.$set(e.tempparams,"name",t)},expression:"tempparams.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.datatype"),prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.$parent.tempTypeChange},model:{value:e.tempparams.type,callback:function(t){e.$set(e.tempparams,"type",t)},expression:"tempparams.type"}},[a("el-option",{attrs:{label:e.$translateTitle("product.init"),value:"int"}}),a("el-option",{attrs:{label:e.$translateTitle("product.float"),value:"float"}}),a("el-option",{attrs:{label:e.$translateTitle("product.double"),value:"double"}}),a("el-option",{attrs:{label:e.$translateTitle("product.bool"),value:"bool"}}),a("el-option",{attrs:{label:e.$translateTitle("product.enum"),value:"enum"}}),a("el-option",{attrs:{label:e.$translateTitle("product.string"),value:"string"}}),a("el-option",{attrs:{label:"switch",value:"switch"}})],1)],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.unit")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$translateTitle("product.unit")},model:{value:e.tempparams.unit,callback:function(t){e.$set(e.tempparams,"unit",t)},expression:"tempparams.unit"}},e._l(e.allunit,(function(e,t){return a("el-option",{key:t,attrs:{label:e.data.Name+"/"+e.data.Symbol,value:e.data.Symbol}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"协议类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.protocol,callback:function(t){e.$set(e.tempparams,"protocol",t)},expression:"tempparams.protocol"}},e._l(["normal","modbus","mingcheng","xinchuangwei","hex"],(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.tempparams.protocol,expression:"tempparams.protocol == 'modbus'"}],attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据格式"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.originaltype,callback:function(t){e.$set(e.tempparams,"originaltype",t)},expression:"tempparams.originaltype"}},e._l([{value:"bit",label:"位"},{value:"short16_AB",label:"16位 有符号(AB)"},{value:"short16_BA",label:"16位 有符号(BA)"},{value:"ushort16_AB",label:"16位 无符号(AB)"},{value:"ushort16_BA",label:"16位 无符号(BA)"},{value:"long32_ABCD",label:"32位 有符号(ABCD)"},{value:"long32_CDAB",label:"32位 有符号(CDAB)"},{value:"ulong32_ABCD",label:"32位 无符号(ABCD)"},{value:"ulong32_CDAB",label:"32位 无符号(CDAB)"},{value:"float32_ABCD",label:"32位 浮点数(ABCD)"},{value:"float32_CDAB",label:"32位 浮点数(CDAB)"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:"modbus"==e.tempparams.protocol,expression:"tempparams.protocol == 'modbus'"}],staticStyle:{width:"100%"},attrs:{border:"",data:e.dataList,size:"small"}},[a("el-table-column",{attrs:{align:"center",label:"从机地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:e.tempparams.slaveid,callback:function(t){e.$set(e.tempparams,"slaveid",t)},expression:"tempparams.slaveid"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"寄存器状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tempparams.operatetype,callback:function(t){e.$set(e.tempparams,"operatetype",t)},expression:"tempparams.operatetype"}},e._l([{value:"readCoils",label:"0X01:读线圈寄存器"},{value:"readInputs",label:"0X02:读离散输入寄存器"},{value:"readHregs",label:"0X03:读保持寄存器"},{value:"readIregs",label:"0X04:读输入寄存器"},{value:"writeCoil",label:"0X05:写单个线圈寄存器"},{value:"writeHreg",label:"0X06:写单个保持寄存器"},{value:"writeCoils",label:"0X0f:写多个线圈寄存器"},{value:"writeHregs",label:"0X10:写多个保持寄存器"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"数据地址(16进制加0X,例:0X10,否则是十进制)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:e.tempparams.address,callback:function(t){e.$set(e.tempparams,"address",t)},expression:"tempparams.address"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r.slaveid))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"数据长度(字节)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",t)},expression:"tempparams.bytes"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(r.slaveid))])]}}])})],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"modbus"!=e.tempparams.protocol,expression:"tempparams.protocol != 'modbus'"}],attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据地址"}},[a("el-input",{attrs:{placeholder:"数据地址"},model:{value:e.tempparams.address,callback:function(t){e.$set(e.tempparams,"address",t)},expression:"tempparams.address"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据长度"}},[a("el-input",{attrs:{placeholder:"数据长度（字节）"},model:{value:e.tempparams.bytes,callback:function(t){e.$set(e.tempparams,"bytes",e._n(t))},expression:"tempparams.bytes"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 采集值 设备上行数据经采集公式计算后显示 。 "),a("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 加：%s+10 "),a("br"),e._v(" 减：%s-10 "),a("br"),e._v(" 乘：%s*10 "),a("br"),e._v(" 除：%s/10 "),a("br"),e._v(" 余数：%s%10 "),a("br")]),a("i",{staticClass:"el-icon-question"})]),a("el-form-item",{attrs:{label:"采集公式"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{rows:1,type:"textarea"},model:{value:e.tempparams.collection,callback:function(t){e.$set(e.tempparams,"collection",t)},expression:"tempparams.collection"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticStyle:{float:"left"},attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 设置值 平台下行数据经设置公式计算后设置 。 "),a("br"),e._v(" 公式中的%s为占位符，是固定字段。 "),a("br"),e._v(" 如： "),a("br"),e._v(" 加：%s+10 "),a("br"),e._v(" 减：%s-10 "),a("br"),e._v(" 乘：%s*10 "),a("br"),e._v(" 除：%s/10 "),a("br"),e._v(" 余数：%s%10 "),a("br")]),a("i",{staticClass:"el-icon-question"})]),a("el-form-item",{attrs:{label:"设置公式"}},[a("el-input",{attrs:{rows:1,type:"textarea"},model:{value:e.tempparams.setting,callback:function(t){e.$set(e.tempparams,"setting",t)},expression:"tempparams.setting"}})],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"必填"}},[a("el-radio",{attrs:{border:"",label:!0},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" 是 ")]),a("el-radio",{attrs:{border:"",label:!1},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" 否 ")])],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"只读"}},[a("el-radio",{attrs:{border:"",label:!0},model:{value:e.tempparams.readonly,callback:function(t){e.$set(e.tempparams,"readonly",t)},expression:"tempparams.readonly"}},[e._v(" 是 ")]),a("el-radio",{attrs:{border:"",label:!1},model:{value:e.tempparams.readonly,callback:function(t){e.$set(e.tempparams,"readonly",t)},expression:"tempparams.readonly"}},[e._v(" 否 ")])],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"列表显示"}},[a("el-radio",{attrs:{border:"",label:!0},model:{value:e.tempparams.isshow,callback:function(t){e.$set(e.tempparams,"isshow",t)},expression:"tempparams.isshow"}},[e._v(" 是 ")]),a("el-radio",{attrs:{border:"",label:!1},model:{value:e.tempparams.isshow,callback:function(t){e.$set(e.tempparams,"isshow",t)},expression:"tempparams.isshow"}},[e._v(" 否 ")])],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},["switch"==e.tempparams.type?a("el-form-item",{attrs:{label:"开"}},[a("el-input",{model:{value:e.tempparams.activevalue,callback:function(t){e.$set(e.tempparams,"activevalue",t)},expression:"tempparams.activevalue"}})],1):e._e()],1),a("el-col",{attrs:{span:12}},["switch"==e.tempparams.type?a("el-form-item",{attrs:{label:"关"}},[a("el-input",{model:{value:e.tempparams.inactivevalue,callback:function(t){e.$set(e.tempparams,"inactivevalue",t)},expression:"tempparams.inactivevalue"}})],1):e._e()],1)],1),"enum"!=e.tempparams.type&&"switch"!=e.tempparams.type?a("el-form-item",{attrs:{label:"默认值",prop:"default"}},["bool"==e.tempparams.type?a("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1):"int"==e.tempparams.type?a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",e._n(t))},expression:"tempparams.default"}}):a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}})],1):e._e(),"enum"==e.tempparams.type?a("el-form-item",{attrs:{label:"Enum数据"}},[a("el-tabs",{model:{value:e.elactiveName1,callback:function(t){e.elactiveName1=t},expression:"elactiveName1"}},[a("el-tab-pane",{attrs:{label:"Table",name:"Table1"}},[a("el-button",{staticClass:"mt-3",attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},nativeOn:{click:function(t){return e.$parent.addDomain.apply(null,arguments)}}},[e._v(" 新 增 ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tempparams.specs}},[a("el-table-column",{attrs:{align:"center",label:"属性"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:r.attribute,callback:function(t){e.$set(r,"attribute",t)},expression:"row.attribute"}})]}}],null,!1,145805847)}),a("el-table-column",{attrs:{align:"center",label:"属性值"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{model:{value:r.attributevalue,callback:function(t){e.$set(r,"attributevalue",t)},expression:"row.attributevalue"}})]}}],null,!1,2139517436)}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{plain:"",size:"mini",title:"删除",type:"danger"},nativeOn:{click:function(t){return e.$parent.removeDomain(r)}}},[e._v(" 删除 ")])]}}],null,!1,3615450766)})],1)],1)],1)],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.$parent.submitFormTempDict()}}},[e._v(" 提交 ")])],1)],1)],1)],1)},l=[],o={name:"ProfileDict",props:{titleDict:{required:!1,type:String,default:""},formLabelWidth:{required:!1,type:String,default:"120px"},rules:{required:!1,type:Object,default:function(){}},editFlag:{required:!1,type:Boolean,default:!1},dictVisible:{required:!1,type:Boolean,default:!1},titleTempDialog:{required:!1,type:String,default:""},parserTables:{required:!1,type:Array,default:function(){return[]}},tempparam:{required:!1,type:Object,default:function(){}},allunit:{required:!1,type:Array,default:function(){return[]}},dataList:{required:!1,type:Array,default:function(){return[{}]}}},data:function(){return{elactiveName:"Table",elactiveName1:"Table1",tempparams:{}}},created:function(){this.tempparams=this.tempparam},mounted:function(){},methods:{addParse:function(e){this.$parent.addParse(e)}}},i=o,n=a("bdd7"),s=Object(n["a"])(i,r,l,!1,null,null,null);t["default"]=s.exports},daad:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"addApp"}},[a("div",{staticClass:"head"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/roles/applicationManagement"}}},[e._v(" "+e._s(e.$translateTitle("application.applicationmanagement"))+" ")]),a("el-breadcrumb-item",[e._v(" "+e._s("update"==e.actionType?"编辑应用":"新增应用")+" ")])],1),a("el-button",{attrs:{plain:"",size:"small",type:"primary"},on:{click:e.handleClickBack}},[e._v(" "+e._s(e.$translateTitle("application.return"))+" ")])],1),a("div",{staticClass:"form"},[a("div",{staticClass:"title"},[a("p",{staticStyle:{color:"#f00"}},[e._v(" "+e._s("*"+e.$translateTitle("application.mustfillin"))+" ")])]),a("el-form",{ref:"form",attrs:{"label-width":"180px",model:e.form}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:"工程单位",prop:"department",rules:[{required:!0,message:"工程单位不能为空"}]}},[a("el-input",{attrs:{placeholder:"工程单位"},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationname"),prop:"name",rules:[{required:!0,message:"工程名称不能为空"}]}},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.applicationname"),readonly:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationlink"),prop:"productIdentifier",rules:[{required:!0,message:"工程链接不能为空"}]}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},model:{value:e.form.productIdentifier,callback:function(t){e.$set(e.form,"productIdentifier",t)},expression:"form.productIdentifier"}},e._l(e.applicationList,(function(t){return a("el-option",{key:t.id,attrs:{label:e.host+t.desc,value:t.desc}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.industrytype"),prop:"category",rules:[{required:!0,message:"请选择所属行业",trigger:"blur"}]}},[a("el-cascader",{ref:"category",attrs:{clearable:"",options:e.treeData,placeholder:e.$translateTitle("application.industrytype")},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),a("el-form-item",{attrs:{label:"所属应用",rules:[{required:!0,message:"请选择所属应用",trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"请选择所属应用"},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}},[a("template",{slot:"append"},[a("i",{class:[e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{cursor:"pointer"},on:{click:function(t){e.showTree=!e.showTree}}})])],2),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationdescription")}},[a("el-input",{attrs:{maxlength:"300",placeholder:e.$translateTitle("application.applicationdescription"),rows:4,"show-word-limit":"",type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationpictures")}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/upload","auto-upload":!1,"file-list":e.form.fileList,limit:1,"list-type":"picture","on-success":e.handleSuccess}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v(" "+e._s(e.$translateTitle("application.uploadtoserver"))+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.img,expression:"form.img != ''"}]},[e._v(" "+e._s(e.$translateTitle("developer.path"))+":"+e._s(e.form.img)+" ")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" "+e._s(e.$translateTitle("application.onlyJPG/PNGfilescanbeuploadedandnomorethan500kb"))+" ")])],1)],1),a("el-form-item",{attrs:{label:"背景图片"}},[a("el-upload",{ref:"upload1",staticClass:"upload-demo",attrs:{action:"/upload","auto-upload":!1,"file-list":e.form.fileList1,limit:1,"list-type":"picture","on-success":e.handleSuccess1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload1}},[e._v(" "+e._s(e.$translateTitle("application.uploadtoserver"))+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.img1,expression:"form.img1 != ''"}]},[e._v(" "+e._s(e.$translateTitle("developer.path"))+":"+e._s(e.form.img1)+" ")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" "+e._s(e.$translateTitle("application.onlyJPG/PNGfilescanbeuploadedandnomorethan500kb"))+" ")])],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.copyrightinformation")}},[a("el-input",{attrs:{maxlength:"300",placeholder:e.$translateTitle("application.copyrightinformation"),rows:3,"show-word-limit":"",type:"textarea"},model:{value:e.form.copyright,callback:function(t){e.$set(e.form,"copyright",t)},expression:"form.copyright"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.monitoringpanel")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.monitoringpanel")},model:{value:e.form.dashboard,callback:function(t){e.$set(e.form,"dashboard",t)},expression:"form.dashboard"}},[a("template",{slot:"prepend"},[e._v("http://")]),a("el-button",{staticStyle:{color:"#ffffff",background:"#409eff","border-radius":"1px 1px 1px 0"},attrs:{slot:"append",type:"primary"},on:{click:e.open12},slot:"append"},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")])],2)],1)],1)])],1),a("el-divider",[a("b",[e._v(e._s(e.$translateTitle("application.applicationconfiguration")))])]),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationaccessscale"),prop:"scale",rules:[{required:!0,message:"请选择工程接入规模",trigger:"change"}]}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.scale,callback:function(t){e.$set(e.form,"scale",e._n(t))},expression:"form.scale"}},e._l(e.form.scaleDate,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),1)],1)],1)])],1)],1),a("div",{staticClass:"btns"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"add"==e.actionType,expression:"actionType == 'add'"}],attrs:{type:"primary"},on:{click:e.handleClickSubmit}},[e._v(" "+e._s(e.$translateTitle("application.submission"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"update"==e.actionType,expression:"actionType == 'update'"}],attrs:{type:"primary"},on:{click:e.handleClickUpdate}},[e._v(" 更新 ")])],1)],1)])},l=[],o=a("fb07"),i=a("e97b"),n=a("d0d7"),s=a.n(n),c=(a("04d6"),a("a0e0"),a("3dec"),a("d6a4"),a("16b8"),a("1d17"),a("4c87"),a("1c6f"),a("c4bc"),a("5880")),d=a("e0e9"),u=a("ed08"),p=a("58dd"),m=a("7212"),f=a("5dca"),b={data:function(){return{imageUrl:!1,host:window.location.origin+"/lot/",applicationList:[],form:{name:"",options:[],category:[],relationApp:"",number:"",code:"",scale:"",dashboard:"",product:[],department:"",scaleDate:[{id:0,value:100,label:"100"},{id:1,value:1e3,label:"1000"},{id:2,value:1e4,label:"1万"},{id:3,value:1e5,label:"10万"},{id:4,value:1e6,label:"100万"},{id:5,value:1e7,label:"1000万"},{id:6,value:1e8,label:"1亿"}],productIdentifier:"",fileList:[],fileList1:[],img:"",img1:"",copyright:"",desc:"",time:7200,secret:""},sessionToken:"",file:"",actionType:"",relationAppObjectId:"",content:{title:"",objectId:""},argu:{},Notification:"",showTree:!1,allApps:[],defaultProps:{children:"children",label:"label"},productlist:[]}},computed:Object(i["a"])(Object(i["a"])({},Object(c["mapGetters"])({roleTree:"user/roleTree"})),{},{treeData:function(){var e=JSON.parse(JSON.stringify(this.form.options));return e.filter((function(t){var a=e.filter((function(e){return t.id==e.parentid}));return a.length>0&&(t.children=a),0==t.parentid}))},applicationData:function(){return[]}}),created:function(){this.Industry(),this.randomSecret(),this.getProductList()},mounted:function(){this.initData()},beforeDestroy:function(){this.Notification&&this.Notification.close()},methods:{handleClickRefresh:function(){this.randomSecret()},onApplicationchange:function(e){},getProductList:function(e){var t=this;this.$query_object("Product",{}).then((function(e){e.results&&(t.productlist=e.results)}))},randomSecret:function(){var e=Math.ceil(25*Math.random());this.form.secret=Base64.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date))},initData:function(){var e=this;return Object(o["a"])(s.a.mark((function t(){var a,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.argu=e.$route.query,e.content.title=e.argu.title,e.actionType=e.argu.actionType,t.next=5,Object(p["app_count"])({limit:100,where:{}});case 5:a=t.sent,r=a.results,r&&(e.applicationList=r,"update"==e.actionType?(e.form.name=e.argu.name,e.form.scale=Number(Object(u["handleZero"])(e.argu.scale)),e.form.secret=e.argu.secret,e.form.productIdentifier=e.argu.productIdentifier,e.content.objectId=e.argu.objectId,e.form.department=e.argu.userUnit,e.form.desc=e.argu.desc,e.form.copyright=e.argu.copyright,e.argu.category&&(e.form.category=e.argu.category.split("/")),e.argu.dashboard?e.form.dashboard=e.argu.dashboard.substr(7):e.form.dashboard="",""!=e.argu.logo&&(e.form.img=e.argu.logo,e.form.fileList.push({name:"logo.png",url:e.argu.logo})),""!=e.argu.background&&(e.form.img1=e.argu.background,e.form.fileList1.push({name:"background.png",url:e.argu.background})),e.form.relationApp=e.argu.name):(e.relationAppObjectId=e.$route.query.appObjectId,e.form.relationApp=e.$route.query.name,e.form.productIdentifier=e.$route.query.desc,e.form.name=e.$route.query.desc));case 8:case"end":return t.stop()}}),t)})))()},handleClickBack:function(){this.$router.push({path:"/roles/applicationManagement"})},submitUpload:function(){this.$refs.upload.submit()},handleChangeFile:function(e){var t=e.target.files[0],a=t.name.substr(-3);t.size/1024>500?this.$message("上传图片大小不能超过500KB!"):"png"!=a&&"jpg"!=a?this.$message("上传图片格式不正确，必须是png或jpg格式！"):this.file=t},handleSuccess:function(e,t,a){this.form.img=e.path,this.$message({message:"上传成功！",type:"success"}),document.getElementsByClassName("el-icon-close")[0].setAttribute("display","none")},handleError:function(e,t,a){this.$message({message:"上传失败！",type:"error"})},isSubmit:function(){return""!=this.form.name&&""!=this.form.scale&&""!=this.form.productIdentifier||(this.$message("有必填项没有填写，无法提交！"),!1)},handleSuccess1:function(e,t,a){this.form.img1=e.path,this.$message({message:"上传成功！",type:"success"}),document.getElementsByClassName("el-icon-close")[0].setAttribute("display","none")},submitUpload1:function(){this.$refs.upload1.submit()},handleClickSubmit:function(){var e=this;return Object(o["a"])(s.a.mark((function t(){var a,r,l,o,i;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isSubmit()){t.next=2;break}return t.abrupt("return");case 2:return a="role:"+e.form.relationApp,r={},r[a]={read:!0,write:!0},l={ACL:r,title:e.form.name,category:e.form.category.join("/"),scale:e.form.scale,productIdentifier:e.form.productIdentifier,copyright:e.form.copyright,desc:e.form.desc,logo:e.form.img,background:e.form.img1,userUnit:e.form.department,dashboard:""},""!=e.form.dashboard?l.dashboard="http://"+e.form.dashboard:l.dashboard="",t.next=9,Object(m["postProduct"])(l);case 9:o=t.sent,i=o.objectId,i&&e.addRelation(res.objectId,e.relationAppObjectId);case 12:case"end":return t.stop()}}),t)})))()},addRelation:function(e,t){var a=this;return Object(o["a"])(s.a.mark((function r(){var l;return s.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(f["postRelation"])({destClass:"Project",destId:e,destField:"app",srcClass:"App",srcId:t});case 2:l=r.sent,l?(a.$message({message:"添加部署成功！",type:"success"}),a.$router.push({path:"/roles/projectManagement"})):a.$message("部署失敗");case 4:case"end":return r.stop()}}),r)})))()},handleClickUpdate:function(){var e=this;return Object(o["a"])(s.a.mark((function t(){var a,r,l,o;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isSubmit()){t.next=2;break}return t.abrupt("return");case 2:return a="role:"+e.form.relationApp,r={},r[a]={read:!0,write:!0},l={ACL:r,title:e.form.name,category:e.form.category.join("/"),scale:e.form.scale,productIdentifier:e.form.productIdentifier,copyright:e.form.copyright,desc:e.form.desc,logo:e.form.img,background:e.form.img1,userUnit:e.form.department,dashboard:""},""!=e.form.dashboard?l.dashboard="http://"+e.form.dashboard:l.dashboard="",t.next=9,Object(m["putProduct"])(e.argu.objectId,l);case 9:o=t.sent,o&&(e.$message({message:"修改成功！",type:"success"}),e.$router.push({path:"/roles/projectManagement"}));case 11:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.addchannel.applicationtText=e.name},Industry:function(){var e=this;return Object(o["a"])(s.a.mark((function t(){var a,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,e.form.options=[],t.next=4,Object(d["queryDict"])({limit:1e3,where:{"data.key":"category"}});case 4:a=t.sent,a&&(r=a.results,r.map((function(t){var a={};a.value=t.data.CategoryName,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.form.options.push(a)})));case 6:case"end":return t.stop()}}),t)})))()},open12:function(){this.Notification=this.$notify({title:"面板预览",dangerouslyUseHTMLString:!0,duration:0,type:"success",message:'<div><iframe\n              src="http://'.concat(this.form.dashboard,'"\n              width="1000"\n              height="400"\n              frameborder="0"\n    ></iframe></div>')})}}},h=b,g=(a("963b"),a("2fbe"),a("bdd7")),v=Object(g["a"])(h,r,l,!1,null,"2e582bdf",null);t["default"]=v.exports},df9c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"parserTable",attrs:{"append-to-body":!0,direction:"rtl",visible:e.parserTable,width:"60%"},on:{"update:visible":function(t){e.parserTable=t},close:function(t){e.$parent.parserTable=!e.parserTable}}},[a("div",{staticClass:"header-title",attrs:{slot:"title"},slot:"title"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.addParse(e.parserTables)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return t.preventDefault(),e.saveParse(e.parserTables)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1),a("el-table",{attrs:{data:e.parserTables,size:"mini"}},[a("el-table-column",{attrs:{align:"center",label:"uid",prop:"uid","show-overflow-tooltip":"",sortable:"",width:"100"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.chinesetitle"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-popover",{attrs:{placement:"top",trigger:"hover"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.englishtitle"))+": "+e._s(r.enname)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("developer.describe"))+": "+e._s(r.description)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("product.identifier"))+": "+e._s(r.identifier)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("developer.describe"))+": "+e._s(r.description)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("product.Table Name"))+": "+e._s(r.table)+" ")]),a("p",[e._v(" "+e._s(e.$translateTitle("product.class"))+": "+e._s(r.field)+" ")]),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v(" "+e._s(r.name)+" ")])],1)])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.functionaltypes"),prop:"type","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.visible"),prop:"visible",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-switch",{attrs:{disabled:""},model:{value:r.visible,callback:function(t){e.$set(r,"visible",t)},expression:"row.visible"}})]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,l=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.editParse(l,r)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")]),a("el-button",{attrs:{disabled:!r.config.order,type:"text"},on:{click:function(t){return e.previewParse(r.config)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),a("el-button",{attrs:{size:"small",type:"text"},nativeOn:{click:function(t){return t.preventDefault(),e.lockingParse(r.uid,l,e.parserTables)}}},[e._v(" "+e._s(e.$translateTitle("application.locking"))+" ")]),a("el-button",{attrs:{disabled:r.disable,size:"small",type:"text"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteParse(r.uid,l,e.parserTables)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1)],1)},l=[],o={name:"ProfileDrawer",props:{parserTable:{required:!0,type:Boolean,default:!1},parserTables:{required:!1,type:Array,default:function(){return[]}}},data:function(){return{}},created:function(){},mounted:function(){},methods:{addParse:function(e){this.$parent.addParse(e)},saveParse:function(e){dgiotlog.log("Preservation",e),this.$parent.saveParse(e)},editParse:function(e,t){this.$parent.editParse(e,t)},previewParse:function(e){this.$parent.previewParse(e)},lockingParse:function(e,t,a){this.$parent.lockingParse(e,t,a)},deleteParse:function(e,t,a){this.$parent.deleteParse(e,t,a)}}},i=o,n=a("bdd7"),s=Object(n["a"])(i,r,l,!1,null,null,null);t["default"]=s.exports},e094:function(e,t,a){},e2e4:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"custom-table",staticClass:"custom-table-container",class:{"vab-fullscreen":e.isFullscreen}},[r("vab-query-form",[r("vab-query-form-left-panel",[r("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",[r("el-input",{attrs:{clearable:""},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),r("el-form-item",[r("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:e.handleQuery}},[e._v(" "+e._s(e.$translateTitle("button.search"))+" ")]),r("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},nativeOn:{click:function(t){return e.handleAdd.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("button.add"))+" ")])],1)],1)],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.categoryList,"default-sort":{prop:"order",order:"ascending"},height:e.height,"row-key":"objectId",size:e.lineHeight,stripe:e.stripe,"tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"selection-change":e.setSelectRows},scopedSlots:e._u([{key:"empty",fn:function(){return[r("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[r("el-table-column",{attrs:{align:"center",prop:"name","show-overflow-tooltip":"",sortable:"",type:"index",width:"50"}}),r("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.name"),prop:"name","show-overflow-tooltip":"",sortable:""}}),r("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleAddChild(a)}}},[e._v(" "+e._s(e.$translateTitle("category.Add subcategory"))+" ")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(a.objectId)}}},[e._v(" "+e._s(e.$translateTitle("button.delete"))+" ")])]}}])})],1),r("categoryEdit",{ref:"edit",on:{"fetch-data":e.fetchData}})],1)},l=[],o=a("fb07"),i=(a("16b8"),a("d0d7")),n=a.n(i),s=a("9705"),c=a("03b1"),d=a("d292"),u={name:"Empty",components:{categoryEdit:s["default"]},data:function(){return{infoData:"Category",isFullscreen:!1,border:!0,height:this.$baseTableHeight(0)+40,stripe:!1,lineHeight:"medium",categoryList:[],listLoading:!0,total:0,selectRows:"",queryForm:{pageNo:1,pageSize:20,name:"",limt:10,skip:0,order:"createdAt",keys:"count(*)"}}},computed:{dragOptions:function(){return{animation:600,group:"description"}}},mounted:function(){},created:function(){this.fetchData()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{clickFullScreen:function(){this.isFullscreen=!this.isFullscreen,this.handleHeight()},handleHeight:function(){this.isFullscreen?this.height=this.$baseTableHeight(1)+210:this.height=this.$baseTableHeight(1)},setSelectRows:function(e){this.selectRows=e},handleAdd:function(){this.$refs["edit"].showEdit({order:0},"top")},handleAddChild:function(e){this.$refs["edit"].showEdit(e,"child")},handleEdit:function(e){this.$refs["edit"].showEdit(e,"edit")},handleDelete:function(e){var t=this;this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),this.$translateTitle("Maintenance.Delete reminder"),Object(o["a"])(n.a.mark((function a(){var r;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["delCategory"])(e);case 2:if(r=a.sent,dgiotlog.log(r,"res"),!_.isEmpty(r)){a.next=10;break}return t.$baseMessage(t.$translateTitle("user.successfully deleted"),"success","vab-hey-message-success"),a.next=8,t.fetchData();case 8:a.next=11;break;case 10:t.$baseMessage(t.$translateTitle("user.error deleted")+r,"error","vab-hey-message-error");case 11:case"end":return a.stop()}}),a)}))))},handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageNo=e,this.fetchData()},handleQuery:function(){this.queryForm.pageNo=1,this.fetchData()},fetchData:function(){var e=this;return Object(o["a"])(n.a.mark((function t(){var a,r,l,o,i;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.queryForm.name.length?'{ "$regex": "'+e.queryForm.name+'"}':'{ "$ne": "null" }',e.listLoading=!0,r={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level","createdAt"],"where":{"level": {"$gte": 1}, "name":'+a+"}}",parent:"parent"},dgiotlog.log(r),t.next=6,Object(d["post_tree"])(r);case 6:l=t.sent,o=l.results,i=void 0===o?[]:o,e.categoryList=i,e.listLoading=!1;case 11:case"end":return t.stop()}}),t)})))()}}},p=u,m=(a("72ce"),a("bdd7")),f=Object(m["a"])(p,r,l,!1,null,"2bcb32d8",null);t["default"]=f.exports},e346:function(e,t,a){"use strict";a("1331")},e385:function(e,t,a){"use strict";a("291d")},e629:function(e,t,a){"use strict";a("a8a7")},edb3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devproduct"},[a("h3",[e._v(" "+e._s(e.$translateTitle("route.产品管理"))+" "),e.projectName?a("span",[e._v(e._s("(所属应用:"+e.projectName+")"))]):e._e()]),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("product.myproduct")+"("+e.total+")",name:"first"}},[a("div",{staticClass:"prosecond"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("product.searchproductname")},model:{value:e.formInline.productname,callback:function(t){e.$set(e.formInline,"productname",t)},expression:"formInline.productname"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.searchProduct(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",{staticStyle:{float:"right","text-align":"right"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=e.projectid,expression:"projectid != ''"}],attrs:{type:"primary"},on:{click:e.addproduct}},[e._v(" "+e._s(e.$translateTitle("product.createproduct"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.goTopoview.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.topoview"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.exportpro.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.exportpro"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.importDialogShow=!0}}},[e._v(" "+e._s(e.$translateTitle("product.importpro"))+" ")])],1)],1),a("div",{staticClass:"protable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.proTableData}},[a("el-table-column",{attrs:{label:"ProductID",prop:"objectId"}}),a("el-table-column",{attrs:{label:e.$translateTitle("product.productname")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.productgrouping")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.devType))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.nodetype")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[0==r.nodeType?a("span",[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")]):a("span",[e._v(e._s(e.$translateTitle("product.gateway")))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.classification")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.CategoryKey))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.addingtime")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(e.utc2beijing(r.createdAt)))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,l=t.$index;return[a("el-link",{attrs:{icon:"el-icon-view",type:"primary",underline:!1},on:{click:function(t){return e.deviceToDetail(r)}}},[e._v(" "+e._s(e.$translateTitle("product.config"))+" ")]),a("el-popover",{ref:"popover-"+l,attrs:{placement:"top",width:"300"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.qdsczg"))+e._s(r.name)+e._s(e.$translateTitle("equipment.cpm"))+" ")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){r._self.$refs["popover-"+l].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.makeSure(e.scope,l)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-link",{attrs:{slot:"reference",icon:"el-icon-delete",type:"danger",underline:!1},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1),a("el-link",{attrs:{icon:"el-icon-attract",type:"primary",underline:!1},on:{click:function(t){return e.GoTodevices(r)}}},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")]),a("el-link",{attrs:{icon:"el-icon-edit",type:"success",underline:!1},on:{click:function(t){return e.editorProduct(r)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.edit"))+" ")]),a("el-link",{attrs:{icon:"el-icon-s-promotion",type:"primary",underline:!1},on:{click:function(t){return e.proudctView(r)}}},[e._v(" "+e._s(e.$translateTitle("product.monitorconfiguration"))+" ")])]}}])})],1)],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,20,30,50],total:e.total},on:{"current-change":e.productCurrentChange,"size-change":e.productSizeChange}})],1)],1)])],1),a("div",{staticClass:"prodialog"},[a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,"close-on-click-modal":!1,title:e.$translateTitle("product.createproduct"),top:"5vh",visible:e.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"content"},[a("div",{staticClass:"contentone"},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(e._s(e.$translateTitle("product.productinformation")))]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.productname"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.productgrouping"),prop:"devType"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.devType,callback:function(t){e.$set(e.form,"devType",t)},expression:"form.devType"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.classification")}},[a("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationtype"),rules:[{required:!0,message:e.$translateTitle("product.pleaseselectyourapp"),trigger:"blur"}]}},[a("el-select",{attrs:{disabled:""},on:{change:e.selectApp},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}},e._l(e.allApps,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title,value:e.title}})})),1)],1)],1)],1),a("div",{staticClass:"contenttwo",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(e._s(e.$translateTitle("product.nodetype")))]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.nodetype"),prop:"nodeType"}},[a("el-radio-group",{on:{change:e.changeNode},model:{value:e.form.nodeType,callback:function(t){e.$set(e.form,"nodeType",t)},expression:"form.nodeType"}},[a("el-radio",{attrs:{label:0}},[e._v(" "+e._s(e.$translateTitle("product.equipment"))+" ")]),a("el-radio",{attrs:{label:1}},[e._v(" "+e._s(e.$translateTitle("product.gateway"))+" ")])],1)],1)],1)],1),a("div",{staticClass:"contentthird",staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{display:"flex"}},[a("span",[e._v(" "+e._s(e.$translateTitle("product.networkinganddescription"))+" ")]),a("p",{staticStyle:{"flex-grow":"2",width:"auto",height:"1px",margin:"10px","border-top":"1px dashed #dddddd"}})]),a("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.networking")+"(共"+e.channel.length+"项)",prop:"netType"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("product.selectgateway")},model:{value:e.form.netType,callback:function(t){e.$set(e.form,"netType",t)},expression:"form.netType"}},e._l(e.channel,(function(e,t){return a("el-option",{key:t,attrs:{label:t+1+":"+e.label,title:"当前第"+(t+1)+"项",value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.productmodel")}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"el-icon-plus avatar-uploader-icon"}),a("form",{ref:"uploadform",staticStyle:{position:"absolute"},attrs:{enctype:"multipart/form-data",method:"POST"}},[a("input",{staticStyle:{position:"relative",top:"-100px","z-index":"5",width:"100px",height:"100px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})]),e.imageUrl?a("el-button",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"mini",type:"danger"},on:{click:e.deleteImgsrc}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")]):e._e()],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),prop:"desc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)])],1),a("div",{staticClass:"import-dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.importpro"),visible:e.importDialogShow,width:"25%"},on:{"update:visible":function(t){e.importDialogShow=t}}},[a("el-form",{ref:"uploadProForm",attrs:{model:e.formPro}},[a("el-upload",{ref:"fileUpload",staticClass:"upload-demo",attrs:{accept:".xls, .xlsx, .zip",action:e.uploadAction,"auto-upload":!1,data:e.uploadData,"file-list":e.fileList,headers:e.uploadHeaders,"on-change":e.handleChange,"on-error":e.handleUploadError,"on-success":e.handleUploadSuccess,"with-credentials":!0}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfiles"))+" ")])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-left",attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v(" "+e._s(e.$translateTitle("application.upload"))+" ")]),a("el-button",{staticClass:"btn-right",attrs:{size:"small"},on:{click:function(t){e.importDialogShow=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1)],1)],1)},l=[],o=a("fb07"),i=(a("04d6"),a("a0e0"),a("3dec"),a("16b8"),a("1d17"),a("4c87"),a("b463"),a("a44e"),a("4ccb"),a("3559"),a("d06e"),a("b340"),a("6924"),a("472c"),a("256c"),a("de71"),a("7876"),a("37a7"),a("d2d8"),a("e2e1"),a("2c1e"),a("26c7"),a("ee7e"),a("f05b"),a("6a4d"),a("11de"),a("172c"),a("0c75"),a("69a3"),a("d30f"),a("3b7f"),a("aadd"),a("98da"),a("c4bc"),a("d6a4"),a("f1e1"),a("d0d7")),n=a.n(i),s=a("e0e9"),c=a("58dd"),d=a("1285"),u=a("7212"),p=a("926a"),m=a("d0fd"),f=a("be65"),b=a.n(f),h=a("5da9"),g=a("f43e").Base64,v={data:function(){return{length:10,total:0,start:0,activeName:"first",formInline:{productname:""},uploadHeaders:{sessionToken:b.a.get("access_token")},uploadAction:"",uploadData:{},fileList:[],productIdentifier:"",proTableData:[],formLabelWidth:"80px",dialogFormVisible:!1,importDialogShow:!1,form:{name:"",category:[],nodeType:0,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},formPro:{name:"",url:""},rules:{roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入产品",trigger:"blur"}],devType:[{required:!0,message:"请输入产品标识，用于区分不同设备",trigger:"blur"}],category:[{required:!0,message:"请选择所属分类",trigger:"change"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],netType:[{required:!0,message:"请选择联网方式",trigger:"change"}],relationApp:[{required:!0,message:"请选择产品可见角色",trigger:"change"}]},option:[],ruleoptions:[],channel:[{label:"蜂窝(2G/3G/4G)(直连)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道(直连)",value:"5G"},{label:"WIFI通道(直连)",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"Modbus",value:"Modbus"},{label:"LoRa(WAN)(直连)",value:"LoRaWAN"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接(直连)",value:"网线连接"},{label:"自定义",value:"OTHER"}],imageUrl:"",productid:"",loading:!1,allApps:[],categoryList:[],categoryListOptions:[],fileServer:"",access_token:"",projectid:"",projectName:"",allTableDate:[]}},computed:{},mounted:function(){this.Industry(),this.searchProduct(0)},beforeDestroy:function(){this.projectName=""},methods:{changeNode:function(e,t){0!=t&&(this.form.netType=""),this.channel=0==e?[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"BLE(低功耗蓝牙)",value:"Bluetooth"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"ZigBee通道",value:"ZigBee"},{label:"LoRa(WAN)",value:"LoRaWAN"},{label:"Modbus",value:"Modbus"},{label:"OPC UA",value:" OPC UA"},{label:"ZETA通道",value:"ZETA"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]:[{label:"蜂窝(2G/3G/4G)",value:"CELLULAR"},{label:"5G通道",value:"5G"},{label:"WIFI通道",value:"WIFI"},{label:"NB-IOT通道",value:"NB-IOT"},{label:"LoRaWAN",value:"LoRaWAN"},{label:"网线连接",value:"网线连接"},{label:"自定义",value:"OTHER"}]},getRoles:function(){return Object(o["a"])(n.a.mark((function e(){return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["app_count"])({where:{}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},selectApp:function(e){var t=this;e&&Object(h["getServer"])(e).then((function(e){e&&(t.fileServer=e.file,t.access_token=e.access_token)}))},treeData:function(e){var t=JSON.parse(JSON.stringify(e));return t.filter((function(e){var a=t.filter((function(t){return e.id==t.parentid}));return a.length>0&&(e.children=a),0==e.parentid}))},deleteImgsrc:function(){event.stopPropagation(),this.imageUrl=""},upload:function(e){if(this.loading=!0,e){var t=e.target.files[0],a=t.name,r=e.target.files[0].type,l=(t.type.split("/")[0],"image/jpeg"===r||"image/JPEG"===r||"image/png"===r||"image/PNG"===r||"image/bpm"===r||"image/BPM"===r);if(!l)return this.$message({message:"请上传图片",type:"error"}),!1;var o=new FileReader;o.readAsDataURL(t);var i=this;o.onloadend=function(){var e=o.result,t=i.dataURItoBlob(e);i.uploadFile(t,a)}}},dataURItoBlob:function(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),l=new Uint8Array(r),o=0;o<t.length;o++)l[o]=t.charCodeAt(o);return new Blob([r],{type:a})},uploadFile:function(e,t){var a=this,r=new FormData;r.append("file",e,t),r.append("output","json"),r.append("path",this.form.relationApp),r.append("auth_token",this.access_token);this.$http.post(this.fileServer,r).then((function(e){e&&(a.imageUrl=e.body.url,a.loading=!1)})).catch((function(e){a.loading=!1,a.$message(e.bodyText)}))},submitUpload:function(){var e=this;this.uploadAction="/product",this.$nextTick((function(){e.uploadData.appid=b.a.get("appids"),e.$refs.fileUpload.submit()}))},handleUploadSuccess:function(e,t,a){dgiotlog.log("### Success response",e),this.$message({type:"success",message:"产品导入成功"}),this.importDialogShow=!1,this.$refs["uploadProForm"].resetFields(),this.searchProduct()},handleUploadError:function(e,t,a){this.$message({showClose:!0,message:e})},handleChange:function(e,t){t.length>0&&(this.fileList=[t[t.length-1]])},utc2beijing:function(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getDict:function(e,t){var a=this;return Object(o["a"])(n.a.mark((function r(){var l,o;return n.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.$query_object("Dict",{limit:1e3,where:{type:{$in:t}}});case 2:l=r.sent,o=l.results,dgiotlog.log(o,"resresres"),a.allTableDate=o,e.map((function(e){o.map((function(t){e.category==t.type&&(e.CategoryKey=t.data.CategoryName)}))})),a.proTableData=e;case 8:case"end":return r.stop()}}),r)})))()},searchProduct:function(e){var t=this;return Object(o["a"])(n.a.mark((function a(){var r,l,o,i,s;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return 0==e&&(t.start=0),r=[],l={order:"-updatedAt",skip:t.start,limit:t.length,count:1,where:{devType:{$ne:"report"}}},""!=t.formInline.productname&&(l.where.name=t.formInline.productname),a.next=6,Object(u["queryProduct"])(l);case 6:o=a.sent,i=o.results,s=o.count,i.map((function(e,t){""!=e.category&&e.category&&r.push(e.category)})),t.getDict(i,r),t.total=s,t.getRoles().then((function(e){t.allApps=e.results})).catch((function(e){Object(p["returnLogin"])(e)}));case 13:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.dialogFormVisible=!1},addproduct:function(){dgiotlog.log(new Date),this.dialogFormVisible=!0},getParent:function(e,t,a){var r=this;return t.map((function(l){e==l.id?(a.unshift(l.value),r.getParent(l.parentid,t,a)):0==l.parentid&&l.id==e&&a.unshift(l.value)})),this.form.category=a,a},getIndustryParent:function(e,t){var a=this;t.map((function(r){r.value==e&&a.getParent(r.id,t,[])}))},editorProduct:function(e){for(var t in dgiotlog.log("row",e),this.form.relationApp="",this.dialogFormVisible=!0,this.productid=e.objectId,this.getIndustryParent(e.category,this.categoryList),this.form.desc=e.desc,this.form.name=e.name,this.form.nodeType=e.nodeType,this.form.netType=e.netType,this.form.devType=e.devType,this.form.productSecret=e.productSecret,this.changeNode(e.nodeType,0),e.icon&&(this.imageUrl=e.icon),e.ACL)dgiotlog.log(t),this.form.relationApp=t?t.substr(5):"";this.selectApp(this.form.relationApp)},Industry:function(){var e=this;return Object(o["a"])(n.a.mark((function t(){var a,r,l;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.categoryList=[],a={limit:1e3,where:{"data.key":"category"}},t.next=4,Object(s["queryDict"])(a);case 4:r=t.sent,l=r.results,l.map((function(t){var a={};a.value=t.type,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.categoryList.push(a)})),e.categoryListOptions=e.treeData(e.categoryList);case 8:case"end":return t.stop()}}),t)})))()},addProduct:function(){this.$message("新增产品")},editProduct:function(e){var t=this;return Object(o["a"])(n.a.mark((function a(){var r,l;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={productSecret:t.form.productSecret,nodeType:t.form.nodeType,netType:t.form.netType,dynamicReg:!1,category:t.form.category[t.form.category.length-1],icon:t.imageUrl,name:t.form.name,devType:t.form.devType,desc:t.form.desc,topics:[]},a.next=3,Object(u["putProduct"])(e,r);case 3:l=a.sent,l&&(t.$message({type:"success",message:"编辑成功"}),t.dialogFormVisible=!1,t.$refs["ruleForm"].resetFields(),t.searchProduct(),t.productid="");case 5:case"end":return a.stop()}}),a)})))()},submitForm:function(e){var t=this;this.$Cookies.get("userId");this.$refs[e].validate((function(e){if(!e)return dgiotlog.log("error submit!!"),!1;var a=Math.ceil(25*Math.random());g.encode(String.fromCharCode(65+a)+Math.ceil(1e7*Math.random())+Number(new Date));""==t.productid?t.addProduct():t.editProduct(t.productid)}))},resetProductForm:function(){this.form={name:"",category:[],nodeType:0,desc:"",netType:"",devType:"",productSecret:"",roles:[],relationApp:""},this.imageUrl=""},deviceToDetail:function(e){this.$router.push({path:"/roles/detailproduct",query:{id:e.objectId}})},GoTodevices:function(e){this.$router.push({path:"/roles/thing",query:{productid:e.objectId}})},makeSure:function(e,t){var a=this,r={count:"objectId",skip:0,limit:1,where:{product:row.objectId}};Object(d["queryDevice"])(r,t).then((function(r){r.count>0?a.$message("请先删除该产品下设备"):Object(u["getProduct"])(row.objectId).then((function(r){dgiotlog.log(r),Object(u["delProduct"])(row.objectId).then((function(r){r&&(a.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(t)].doClose(),a.searchProduct())})).catch((function(e){dgiotlog.log("delProduct ",e.error)}))})).catch((function(e){dgiotlog.log("getProduct ",e.error)}))})).catch((function(e){dgiotlog.log("queryDevice ",e.error)}))},productSizeChange:function(e){this.length=e,this.searchProduct()},productCurrentChange:function(e){this.start=(e-1)*this.length,this.searchProduct()},proudctView:function(e){var t=window.location.origin+"/spa",a="production";t="development"==a?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var r="".concat(t,"/#/views/").concat(e.objectId);window.open(r,"__blank")},goTopoview:function(){var e=window.location.origin+"/spa",t="production";e="development"==t?this.$globalConfig.localTopoUrl:window.location.origin+"/spa";var a="".concat(e,"/#/view");window.open(a,"__blank")},exportpro:function(){this.allTableDate?Object(m["export_txt_to_zip"])(JSON.stringify(this.allTableDate),"Dict","Dict"):this.$message({type:"warning",message:"数据为空,无法导出"})}}},y=v,w=(a("7062a"),a("30d9"),a("bdd7")),$=Object(w["a"])(y,r,l,!1,null,"0678695a",null);t["default"]=$.exports},ee0c:function(e,t,a){"use strict";a.r(t);var r,l,o=a("bdd7"),i={},n=Object(o["a"])(i,r,l,!1,null,null,null);t["default"]=n.exports},ef3f4:function(e,t,a){},fc731:function(e,t,a){},fefe:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}}}]);